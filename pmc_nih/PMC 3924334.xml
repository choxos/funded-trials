<?xml version="1.0" encoding="UTF-8"?>
<OAI-PMH xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.openarchives.org/OAI/2.0/ http://www.openarchives.org/OAI/2.0/OAI-PMH.xsd">
  <responseDate>2024-05-03T05:07:26Z</responseDate>
  <request verb="GetRecord" identifier="oai:pubmedcentral.nih.gov:3924334" metadataPrefix="pmc">https:/www.ncbi.nlm.nih.gov/pmc/oai/oai.cgi</request>
  <GetRecord>
    <record>
      <header>
        <identifier>oai:pubmedcentral.nih.gov:3924334</identifier>
        <datestamp>2014-03-03</datestamp>
        <setSpec>bmcbioi</setSpec>
        <setSpec>pmc-open</setSpec>
      </header>
      <metadata>
        <article xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xsi:schemaLocation="https://jats.nlm.nih.gov/ns/archiving/1.3/ https://jats.nlm.nih.gov/archiving/1.3/xsd/JATS-archivearticle1-3.xsd" article-type="research-article" xml:lang="en">
          <front>
            <journal-meta>
              <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
              <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
              <journal-title-group>
                <journal-title>BMC Bioinformatics</journal-title>
              </journal-title-group>
              <issn pub-type="epub">1471-2105</issn>
              <publisher>
                <publisher-name>BioMed Central</publisher-name>
              </publisher>
            </journal-meta>
            <article-meta>
              <article-id pub-id-type="accession">PMC3924334</article-id>
              <article-id pub-id-type="pmcid">PMC3924334</article-id>
              <article-id pub-id-type="pmc-uid">3924334</article-id>
              <article-id pub-id-type="pmid">24261665</article-id>
              <article-id pub-id-type="publisher-id">1471-2105-14-337</article-id>
              <article-id pub-id-type="pmid">24261665</article-id>
              <article-id pub-id-type="doi">10.1186/1471-2105-14-337</article-id>
              <article-categories>
                <subj-group subj-group-type="heading">
                  <subject>Methodology Article</subject>
                </subj-group>
              </article-categories>
              <title-group>
                <article-title>Probabilistic alignment leads to improved accuracy and read coverage for bisulfite sequencing data</article-title>
              </title-group>
              <contrib-group>
                <contrib contrib-type="author" id="A1">
                  <name>
                    <surname>Hong</surname>
                    <given-names>Changjin</given-names>
                  </name>
                  <xref ref-type="aff" rid="I1">1</xref>
                  <email>cjhong@bu.edu</email>
                </contrib>
                <contrib contrib-type="author" id="A2">
                  <name>
                    <surname>Clement</surname>
                    <given-names>Nathan L</given-names>
                  </name>
                  <xref ref-type="aff" rid="I2">2</xref>
                  <email>nathanlclement@gmail.com</email>
                </contrib>
                <contrib contrib-type="author" id="A3">
                  <name>
                    <surname>Clement</surname>
                    <given-names>Spencer</given-names>
                  </name>
                  <xref ref-type="aff" rid="I3">3</xref>
                  <email>spencercclement@gmail.com</email>
                </contrib>
                <contrib contrib-type="author" id="A4">
                  <name>
                    <surname>Hammoud</surname>
                    <given-names>Saher Sue</given-names>
                  </name>
                  <xref ref-type="aff" rid="I4">4</xref>
                  <xref ref-type="aff" rid="I5">5</xref>
                  <email>sue.hammoud@utah.edu</email>
                </contrib>
                <contrib contrib-type="author" id="A5">
                  <name>
                    <surname>Carrell</surname>
                    <given-names>Douglas T</given-names>
                  </name>
                  <xref ref-type="aff" rid="I4">4</xref>
                  <email>douglas.carrell@hsc.utah.edu</email>
                </contrib>
                <contrib contrib-type="author" id="A6">
                  <name>
                    <surname>Cairns</surname>
                    <given-names>Bradley R</given-names>
                  </name>
                  <xref ref-type="aff" rid="I5">5</xref>
                  <email>Brad.Cairns@hci.utah.edu</email>
                </contrib>
                <contrib contrib-type="author" id="A7">
                  <name>
                    <surname>Snell</surname>
                    <given-names>Quinn</given-names>
                  </name>
                  <xref ref-type="aff" rid="I3">3</xref>
                  <email>snell@cs.byu.edu</email>
                </contrib>
                <contrib contrib-type="author" id="A8">
                  <name>
                    <surname>Clement</surname>
                    <given-names>Mark J</given-names>
                  </name>
                  <xref ref-type="aff" rid="I3">3</xref>
                  <email>clement@cs.byu.edu</email>
                </contrib>
                <contrib contrib-type="author" corresp="yes" id="A9">
                  <name>
                    <surname>Johnson</surname>
                    <given-names>William Evan</given-names>
                  </name>
                  <xref ref-type="aff" rid="I1">1</xref>
                  <email>wej@bu.edu</email>
                </contrib>
              </contrib-group>
              <aff id="I1"><label>1</label>Division of Computational Biomedicine, Boston University School of Medicine, Boston, MA, USA</aff>
              <aff id="I2"><label>2</label>Department of Computer Science, University of Texas, Austin, TX, USA</aff>
              <aff id="I3"><label>3</label>Department of Computer Science, Brigham Young University, Provo, UT, USA</aff>
              <aff id="I4"><label>4</label>IVF and Andrology Laboratories, Departments of Surgery, Obstetrics and Gynecology, and Physiology, University of Utah School of Medicine, Salt Lake City, UT, USA</aff>
              <aff id="I5"><label>5</label>Department of Oncological Sciences, Huntsman Cancer Institute, Salt Lake City, UT, USA</aff>
              <pub-date pub-type="collection">
                <year>2013</year>
              </pub-date>
              <pub-date pub-type="epub">
                <day>21</day>
                <month>11</month>
                <year>2013</year>
              </pub-date>
              <volume>14</volume>
              <fpage>337</fpage>
              <lpage>337</lpage>
              <history>
                <date date-type="received">
                  <day>7</day>
                  <month>6</month>
                  <year>2013</year>
                </date>
                <date date-type="accepted">
                  <day>19</day>
                  <month>11</month>
                  <year>2013</year>
                </date>
              </history>
              <permissions>
                <copyright-statement>Copyright © 2013 Hong et al.; licensee BioMed Central Ltd.</copyright-statement>
                <copyright-year>2013</copyright-year>
                <copyright-holder>Hong et al.; licensee BioMed Central Ltd.</copyright-holder>
                <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
                  <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (
<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
                </license>
              </permissions>
              <self-uri xlink:href="http://www.biomedcentral.com/1471-2105/14/337"/>
              <abstract>
                <sec>
                  <title>Background</title>
                  <p>DNA methylation has been linked to many important biological phenomena. Researchers have recently begun to sequence bisulfite treated DNA to determine its pattern of methylation. However, sequencing reads from bisulfite-converted DNA can vary significantly from the reference genome because of incomplete bisulfite conversion, genome variation, sequencing errors, and poor quality bases. Therefore, it is often difficult to align reads to the correct locations in the reference genome. Furthermore, bisulfite sequencing experiments have the additional complexity of having to estimate the DNA methylation levels within the sample.</p>
                </sec>
                <sec>
                  <title>Results</title>
                  <p>Here, we present a highly accurate probabilistic algorithm, which is an extension of the Genomic Next-generation Universal MAPper to accommodate bisulfite sequencing data (<italic>GNUMAP-bs</italic>), that addresses the computational problems associated with aligning bisulfite sequencing data to a reference genome. <italic>GNUMAP-bs</italic> integrates uncertainty from read and mapping qualities to help resolve the difference between poor quality bases and the ambiguity inherent in bisulfite conversion. We tested <italic>GNUMAP-bs</italic> and other commonly-used bisulfite alignment methods using both simulated and real bisulfite reads and found that <italic>GNUMAP-bs</italic> and other dynamic programming methods were more accurate than the more heuristic methods.</p>
                </sec>
                <sec>
                  <title>Conclusions</title>
                  <p>The <italic>GNUMAP-bs</italic> aligner is a highly accurate alignment approach for processing the data from bisulfite sequencing experiments. The <italic>GNUMAP-bs</italic> algorithm is freely available for download at:
<ext-link ext-link-type="uri" xlink:href="http://dna.cs.byu.edu/gnumap">http://dna.cs.byu.edu/gnumap</ext-link>. The software runs on multiple threads and multiple processors to increase the alignment speed.</p>
                </sec>
              </abstract>
              <kwd-group>
                <kwd>DNA methylation</kwd>
                <kwd>Bisulfite sequencing</kwd>
                <kwd>Probabilistic alignment</kwd>
                <kwd>Parallel processing</kwd>
              </kwd-group>
            </article-meta>
          </front>
          <body>
            <sec>
              <title>Background</title>
              <p>DNA methylation is a chemical process in which a methyl group is added to the carbon-5 position of a DNA cytosine. In most vertebrates, DNA methylation typically occurs on the cytosine of a CpG dinucleotide
[<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>], although some specific examples of other types of methylation have been shown to play roles in specific tissues
[<xref ref-type="bibr" rid="B3">3</xref>-<xref ref-type="bibr" rid="B6">6</xref>]. Since its discovery over 60 years ago, DNA methylation has been linked to many important biological phenomena such as the suppression of gene expression
[<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B8">8</xref>], imprinting
[<xref ref-type="bibr" rid="B9">9</xref>], X chromosome inactivation
[<xref ref-type="bibr" rid="B10">10</xref>], epigenetic reprogramming during mammalian development
[<xref ref-type="bibr" rid="B11">11</xref>], and cancer development
[<xref ref-type="bibr" rid="B12">12</xref>]. Therefore, the study of genome-wide methylation patterns is currently of great interest to researchers, particularly in areas related to the molecular mechanisms of development, cancer, and chromatin dynamics.</p>
              <p>When DNA is treated with sodium bisulfite, unmethylated cytosine residues are converted to uracil, while 5-methylcytosine residues are unaffected. Later in bisulfite sequencing (BS-seq) experimental protocols, PCR amplification or sequencing converts the uracil residues to thymines. The next step of finding the correct genomic location for a bisulfite-treated read (BSR) is a complicated and difficult process. Although cytosine to thymine changes are allowed for when mapping the BSRs to the genomic sequence, methylated and unmethylated CpG locations are often identified and, in some cases, it is impossible to distinguish between a bisulfite (BS)-treated thymine that originated from an unmethylated cytosine, and a true thymine from a different genomic location or an individual genomic variation at that location
[<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B14">14</xref>]. This ambiguity is often magnified by the presence of sequencing errors or low-quality bases. As a result, sophisticated computational strategies are required for aligning reads from BS-seq experiments.</p>
              <p>The first whole-genome methylation profiles were performed on <italic>Arabidopsis thaliana</italic>. To map the resultant BSRs, alignment algorithms based on a probabilistic formulation and a suffix tree
[<xref ref-type="bibr" rid="B15">15</xref>] as well as reference genome conversion
[<xref ref-type="bibr" rid="B16">16</xref>] were used. However, it is not computationally feasible to apply this approach to larger genomes such as the human genome, or to experiments with the current deeper sequencing depths. Later algorithms, such as <italic>BSMAP</italic>[<xref ref-type="bibr" rid="B14">14</xref>], constructed seed tables of locations from both the original reference sequence and the BS variants, and then extends the seeds to form a possible mapping location. This seed extension process can be somewhat unreliable because the seeds must be exact and do not take into account BS-treated variations. BS alignment methods such as <italic>BS Seeker</italic>[<xref ref-type="bibr" rid="B17">17</xref>], <italic>Bismark</italic>[<xref ref-type="bibr" rid="B18">18</xref>], and <italic>BRAT-BW</italic>[<xref ref-type="bibr" rid="B19">19</xref>] have been used to map BSRs. These methods employ a Burrows-Wheeler transformation
[<xref ref-type="bibr" rid="B20">20</xref>] for fast (in)exact string matching and then combine the results with either a pre-processing or post-processing script to handle BSRs with three letters after converting all Cs to T. The strength of these methods lie with reads with fewer mismatches, but they offer very limited support for aligning reads with insertions or deletions (indels). These methods also have difficulty in aligning Ts in the reads to Cs in the genome without also (incorrectly) aligning for cysteines in the reads to thymidines in the genome. More recently, the <italic>LAST</italic> alignment program has been adapted to align BSRs
[<xref ref-type="bibr" rid="B21">21</xref>]. <italic>LAST</italic> uses a seed extension approach similar to the one used by NCBI BLAST
[<xref ref-type="bibr" rid="B22">22</xref>], but the speed and mapping accuracy are increased by using variable-length seeds and base quality information
[<xref ref-type="bibr" rid="B23">23</xref>].</p>
              <p>In this study, we present a highly accurate probabilistic mapping algorithm, Genomic Next-generation Universal MAPper for Bisulfite Sequencing (<italic>GNUMAP-bs</italic>), for BSR alignment. <italic>GNUMAP-bs</italic> is an extension of the Genomic Next-Generation Universal MAPper (<italic>GNUMAP</italic>)
[<xref ref-type="bibr" rid="B24">24</xref>] that can accommodate the alignment of BSRs to a reference genome. <italic>GNUMAP-bs</italic> was developed to achieve higher accuracy than other BS-seq approaches by including base quality scores in the alignment process. In addition, the <italic>GNUMAP-bs</italic> probabilistic mapping approach allows for the unbiased estimation of DNA methylation, especially when reads are aligned to multiple genomic locations.</p>
            </sec>
            <sec>
              <title>Results and discussion</title>
              <p>We compared <italic>GNUMAP-bs</italic> with several commonly-used BS alignment methods, namely <italic>BSMAP</italic> (v2.3)
[<xref ref-type="bibr" rid="B14">14</xref>], <italic>Bismark</italic>(v0.7.9)
[<xref ref-type="bibr" rid="B18">18</xref>], <italic>LAST</italic>[<xref ref-type="bibr" rid="B21">21</xref>], and <italic>BRAT-BW</italic>[<xref ref-type="bibr" rid="B19">19</xref>]. We also compared <italic>GNUMAP-bs</italic> with the unpublished proprietary probabilistic aligner <italic>Novoalign</italic> (v2.07.09,
<ext-link ext-link-type="uri" xlink:href="http://www.novocraft.com">http://www.novocraft.com</ext-link>) because it uses a probabilistic approach that is similar to the approach used in <italic>GNUMAP-bs</italic>. For a fair comparison, we considered only common options that were shared by all the alignment methods; otherwise, we used the default values or slight modifications of the defaults to achieve the best performance for each method. For each aligner, we allowed up to three or four base pair differences within 100-bp BSRs. For <italic>GNUMAP-bs</italic> and <italic>Novoalign</italic>, this resulted in cutoff values of -a 0.90 and -t 75, respectively. Considering that repeated genomic sequences often appear in mammalian genomes, we allowed up to 20 multiple mapping locations for each read. This approach to handling multiple alignments has only a small impact on the sensitivity of the more heuristic algorithms, but has moderate sensitivity gains in more traditional approaches like <italic>GNUMAP-bs</italic>. The <italic>Bismark</italic> software only reports up to two valid alignments. The parameter values that were used for each alignment method are given in Table
<xref ref-type="table" rid="T1">1</xref>.</p>
              <table-wrap position="float" id="T1">
                <label>Table 1</label>
                <caption>
                  <p>Parameters used in the two experiments for each of the aligners tested</p>
                </caption>
                <table frame="hsides" rules="groups" border="1">
                  <colgroup>
                    <col align="left"/>
                    <col align="center"/>
                  </colgroup>
                  <thead valign="top">
                    <tr>
                      <th align="center">
                        <bold>Mapper</bold>
                      </th>
                      <th align="center">
                        <bold>Parameters</bold>
                      </th>
                    </tr>
                  </thead>
                  <tbody valign="top">
                    <tr>
                      <td align="center" valign="bottom">
                        <italic>GNUMAP-bs</italic>
                        <hr/>
                      </td>
                      <td align="center" valign="bottom">-m 17 -s 1 -T 20 -a 0.90 (-a 0.92) -b<hr/></td>
                    </tr>
                    <tr>
                      <td align="center" valign="bottom">
                        <italic>Novoalign</italic>
                        <hr/>
                      </td>
                      <td align="center" valign="bottom">-k 17 -s 2 -r -A 20 -t 75 (-t 90) -b2<hr/></td>
                    </tr>
                    <tr>
                      <td align="center" valign="bottom">
                        <italic>BSMAP</italic>
                        <hr/>
                      </td>
                      <td align="center" valign="bottom">-n 0 -w 100 -v 3<hr/></td>
                    </tr>
                    <tr>
                      <td align="center" valign="bottom">
                        <italic>Bismark</italic>
                        <hr/>
                      </td>
                      <td align="center" valign="bottom">-n 2 -l 50<hr/></td>
                    </tr>
                    <tr>
                      <td align="center" valign="bottom">
                        <italic>Bismark-bt2</italic>
                        <hr/>
                      </td>
                      <td align="center" valign="bottom">-N 1 -L 20 –bowtie2 –min-score L,0,-0.6<hr/></td>
                    </tr>
                    <tr>
                      <td align="center" valign="bottom">
                        <italic>LAST</italic>
                        <hr/>
                      </td>
                      <td align="center" valign="bottom">-Q1 -j1 -d120 -n20 -f1 | last-map-probs.py -s150 -m0.95<hr/></td>
                    </tr>
                    <tr>
                      <td align="center">
                        <italic>BRAT-BW</italic>
                      </td>
                      <td align="center">default settings for single-end reads</td>
                    </tr>
                  </tbody>
                </table>
                <table-wrap-foot>
                  <p>Parameters in parentheses were used for the human BSR dataset. Up to 3 to 4 sequencing errors or mutations were allowed in a 100-bp long BSR. Because the human genome contains many repeated genomic regions, 20 valid mapping locations were allowed for a given read when the alignment method supported this feature.</p>
                </table-wrap-foot>
              </table-wrap>
              <p>We used two datasets to evaluate the performance of each of the alignment methods. The first was a simulated BSR dataset, which was carefully designed to mimic a typical human methylation experiment. The second was a real human BS-seq dataset, which was compared with an experimentally-derived human methylome profile.</p>
              <sec>
                <title>Simulated bisulfite sequencing experiment</title>
                <p>For the simulation study, we randomly assigned 20% of the CGs in the whole human genome (NCBI build37/HG19) to represent unmethylated cytosines (Cs) by changing them to thymidines (Ts), thereby simulating complete BS conversion. For the remaining 80% of the CGs, 75% was randomly assigned to be fully methylated and, therefore the Cs remained as Cs. The remaining 5% was assigned to be methylated in proportions between 0.1 and 0.9. In this dataset, we assumed that all non-CG sites remained unmethylated, so these Cs were all changed to Ts for read generation. We used the <italic>dwgsim</italic> (
<ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/dnaa/files/dwgsim">http://sourceforge.net/projects/dnaa/files/dwgsim</ext-link>) simulation tool with parameters -e 0.001-0.008 -1 100 -y 0.05 -r 0.002 -R 0.2 -C 10, to generate 100-bp BSRs with a 10? read depth across the genome. This simulation produced a BS-seq dataset that contained approximately 180 million (M) reads with a sequencing error rate that ranged from 0.001 to 0.008 and increased from the 5’ to 3’ ends, plus 5% randomly generated sequence, and a mutation rate of 0.002 (in which 0.2% were indels).</p>
                <p>We found that the mapping sensitivities of the probabilistic aligners <italic>GNUMAP-bs</italic> (97.0%), <italic>Novoalign</italic> (96.3%), and <italic>LAST</italic> (96.9%), were higher than the sensitivities of <italic>BSMAP</italic> (93.9%) and <italic>Bismark</italic> (93.2%), as shown in Table
<xref ref-type="table" rid="T2">2</xref>. The <italic>Bismark-Bowtie2</italic> algorithm had the lowest false positive rate (0.1%), but at the cost of an approximately 7% decrease in its sensitivity. Overall, the <italic>Bismark-Bowtie2</italic> algorithm had 1.2 M fewer false positives than <italic>GNUMAP-bs</italic>, but approximately 10 M fewer BSRs were aligned correctly to the genome. The <italic>Bismark-Bowtie</italic> algorithm performed better than <italic>Bismark-Bowtie2</italic> in that it aligned 5 M more reads with only a slight increase in the number of incorrectly aligned reads. The <italic>LAST</italic> algorithm aligned nearly all the BSRs (99.2%) to the genome, but although the proportion of correctly mapped reads was similar to that of <italic>GNUMAP-bs</italic>, the error rate was much higher. <italic>BRAT-BW</italic> was not included in this comparison because the application software removed the original sequence header/name which contained information pointing to the correct alignment location of the BSRs.</p>
                <table-wrap position="float" id="T2">
                  <label>Table 2</label>
                  <caption>
                    <p>Simulated bisulfite read experiment</p>
                  </caption>
                  <table frame="hsides" rules="groups" border="1">
                    <colgroup>
                      <col align="left"/>
                      <col align="center"/>
                      <col align="center"/>
                      <col align="center"/>
                      <col align="center"/>
                      <col align="center"/>
                      <col align="center"/>
                    </colgroup>
                    <thead valign="top">
                      <tr>
                        <th align="left">
                          <bold>Evaluation metric</bold>
                        </th>
                        <th align="center">
                          <bold>
                            <italic>GNUMAP-bs</italic>
                          </bold>
                        </th>
                        <th align="center">
                          <bold>
                            <italic>Novoalign</italic>
                          </bold>
                        </th>
                        <th align="center">
                          <bold>
                            <italic>BSMAP</italic>
                          </bold>
                        </th>
                        <th align="center">
                          <bold>
                            <italic>Bismark</italic>
                          </bold>
                        </th>
                        <th align="center">
                          <bold>
                            <italic>Bismark-bt2</italic>
                          </bold>
                        </th>
                        <th align="center">
                          <bold>
                            <italic>LAST</italic>
                          </bold>
                        </th>
                      </tr>
                    </thead>
                    <tbody valign="top">
                      <tr>
                        <td align="left" valign="bottom">
                          <bold>Overall mapping results:</bold>
                          <hr/>
                        </td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                      </tr>
                      <tr>
                        <td align="left" valign="bottom">Total reads aligned (%)<hr/></td>
                        <td align="center" valign="bottom">156.6M(<bold>97.8</bold>)<hr/></td>
                        <td align="center" valign="bottom">155.8M(97.4)<hr/></td>
                        <td align="center" valign="bottom">153.4M(95.9)<hr/></td>
                        <td align="center" valign="bottom">149.5M(93.4)<hr/></td>
                        <td align="center" valign="bottom">145.4M(90.8)<hr/></td>
                        <td align="center" valign="bottom">158.7M(99.2)<hr/></td>
                      </tr>
                      <tr>
                        <td align="left" valign="bottom">Correctly aligned (%)<hr/></td>
                        <td align="center" valign="bottom">155.2M(<bold>97.0</bold>)<hr/></td>
                        <td align="center" valign="bottom">154.2M(96.3)<hr/></td>
                        <td align="center" valign="bottom">150.2M(93.9)<hr/></td>
                        <td align="center" valign="bottom">149.2M(93.2)<hr/></td>
                        <td align="center" valign="bottom">145.2M(90.7)<hr/></td>
                        <td align="center" valign="bottom">155.1M(96.9)<hr/></td>
                      </tr>
                      <tr>
                        <td align="left" valign="bottom">Incorrectly aligned (%)<hr/></td>
                        <td align="center" valign="bottom">1.4M(0.9)<hr/></td>
                        <td align="center" valign="bottom">1.7M(1.1)<hr/></td>
                        <td align="center" valign="bottom">1.5M(1.0)<hr/></td>
                        <td align="center" valign="bottom">0.3M(0.2)<hr/></td>
                        <td align="center" valign="bottom">0.2M(<bold>0.1</bold>)<hr/></td>
                        <td align="center" valign="bottom">3.6M(2.3)<hr/></td>
                      </tr>
                      <tr>
                        <td align="left" valign="bottom">
                          <bold>With ≥1 sequence variant:</bold>
                          <hr/>
                        </td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                      </tr>
                      <tr>
                        <td align="left" valign="bottom">Total reads aligned (%)<hr/></td>
                        <td align="center" valign="bottom">69.0M(97.8)<hr/></td>
                        <td align="center" valign="bottom">66.0M(93.6)<hr/></td>
                        <td align="center" valign="bottom">65.3M(92.6)<hr/></td>
                        <td align="center" valign="bottom">63.6M(90.2)<hr/></td>
                        <td align="center" valign="bottom">59.6M(84.4)<hr/></td>
                        <td align="center" valign="bottom">70.3M(<bold>(99.7</bold>)<hr/></td>
                      </tr>
                      <tr>
                        <td align="left" valign="bottom">Correctly aligned (%)<hr/></td>
                        <td align="center" valign="bottom">67.7M(<bold>96.0</bold>)<hr/></td>
                        <td align="center" valign="bottom">65.3M(92.6)<hr/></td>
                        <td align="center" valign="bottom">63.9M(90.1)<hr/></td>
                        <td align="center" valign="bottom">63.3M(89.8)<hr/></td>
                        <td align="center" valign="bottom">59.4M(84.1)<hr/></td>
                        <td align="center" valign="bottom">66.7M(94.6)<hr/></td>
                      </tr>
                      <tr>
                        <td align="left" valign="bottom">Incorrectly aligned (%)<hr/></td>
                        <td align="center" valign="bottom">1.3M(1.8)<hr/></td>
                        <td align="center" valign="bottom">0.7M(1.0)<hr/></td>
                        <td align="center" valign="bottom">1.4M(2.0)<hr/></td>
                        <td align="center" valign="bottom">0.3M(0.4)<hr/></td>
                        <td align="center" valign="bottom">0.2M(<bold>0.3</bold>)<hr/></td>
                        <td align="center" valign="bottom">3.5M(5.1)<hr/></td>
                      </tr>
                      <tr>
                        <td align="left" valign="bottom">
                          <bold>Predicted methylation:</bold>
                          <hr/>
                        </td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                      </tr>
                      <tr>
                        <td align="left" valign="bottom">Ave. absolute estimation err.<hr/></td>
                        <td align="center" valign="bottom">0.11<hr/></td>
                        <td align="center" valign="bottom">0.69<hr/></td>
                        <td align="center" valign="bottom">0.22<hr/></td>
                        <td align="center" valign="bottom">0.11<hr/></td>
                        <td align="center" valign="bottom">0.10<hr/></td>
                        <td align="center" valign="bottom">-<hr/></td>
                      </tr>
                      <tr>
                        <td align="left" valign="bottom">Standard err.<hr/></td>
                        <td align="center" valign="bottom">0.056<hr/></td>
                        <td align="center" valign="bottom">0.066<hr/></td>
                        <td align="center" valign="bottom">0.067<hr/></td>
                        <td align="center" valign="bottom">0.064<hr/></td>
                        <td align="center" valign="bottom">0.062<hr/></td>
                        <td align="center" valign="bottom">-<hr/></td>
                      </tr>
                      <tr>
                        <td align="left" valign="bottom">
                          <bold>Computational resource:</bold>
                          <hr/>
                        </td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                      </tr>
                      <tr>
                        <td align="left" valign="bottom">Total compute time (16 CPUs)<hr/></td>
                        <td align="center" valign="bottom">39 h 50 m<hr/></td>
                        <td align="center" valign="bottom">29 h 25 m<hr/></td>
                        <td align="center" valign="bottom">
                          <bold>4 h 28 m</bold>
                          <hr/>
                        </td>
                        <td align="center" valign="bottom">46 h 16 m<hr/></td>
                        <td align="center" valign="bottom">97 h 26 m<hr/></td>
                        <td align="center" valign="bottom">58 h 20 m<hr/></td>
                      </tr>
                      <tr>
                        <td align="left" valign="bottom">Peak memory usage (GB)<hr/></td>
                        <td align="center" valign="bottom">44.8<hr/></td>
                        <td align="center" valign="bottom">14.5<hr/></td>
                        <td align="center" valign="bottom">9.4<hr/></td>
                        <td align="center" valign="bottom">
                          <bold>5.9</bold>
                          <hr/>
                        </td>
                        <td align="center" valign="bottom">7.9<hr/></td>
                        <td align="center" valign="bottom">15.9<hr/></td>
                      </tr>
                      <tr>
                        <td align="left">Reads per second per CPU</td>
                        <td align="center">68</td>
                        <td align="center">92</td>
                        <td align="center">607</td>
                        <td align="center">448</td>
                        <td align="center">26</td>
                        <td align="center">
                          <bold>753</bold>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                  <table-wrap-foot>
                    <p>Simulation study of 160 million (M) simulated BSRs generated from the human genome reference sequence. The <italic>GNUMAP-bs</italic> algorithm was the most sensitive aligner, especially for reads with ≥1 sequence variant (sequencing errors or mutations). The <italic>Bismark</italic> algorithm had the smallest error rate with 1.2 M fewer erroneously assigned reads than <italic>GNUMAP-bs</italic>, however <italic>GNUMAP-bs</italic> correctly aligned 6 to 10 M more reads. The <italic>BSMAP</italic> algorithm had the fastest total run time, however its sensitivity was less than the sensitivity of the <italic>GNUMAP-bs</italic> algorithm. <italic>LAST</italic> mapped nearly all reads with a sensitivity that was comparable to that of <italic>GNUMAP-bs</italic>, but the mapping error rate for <italic>LAST</italic> was much higher than it was for <italic>GNUMAP-bs</italic>.</p>
                  </table-wrap-foot>
                </table-wrap>
                <p>Differences in sensitivities of these methods were much more pronounced for BSRs that contained at least one sequencing error or genome variant, and the <italic>GNUMAP-bs</italic> sensitivity was clearly better than the sensitivities of the other approaches (Table
<xref ref-type="table" rid="T2">2</xref>). We also evaluated how accurately each aligner predicted the CG methylation levels when the true methylation level ranged from 10% to 90%. All the alignment methods tested performed well with mean absolute errors less than 0.01 and with standard deviations less than 0.07.</p>
                <p>When the computational performances of each of the methods were compared (Table
<xref ref-type="table" rid="T2">2</xref>), we observed that <italic>GNUMAP-bs</italic> required the most RAM (44.8 GB) and <italic>Bismark</italic> required the least (5.9 GB). Because some of the software applications presented here support computation on multiple threads and some do not, we presented two different measures of computational speed: 1) the total run time on a 16 CPU linux server and 2) the number of reads processed per CPU per second. <italic>GNUMAP-bs</italic> required approximately 40 hours of total compute time to process the 180 M BSRs, while <italic>BSMAP</italic>, the fastest algorithm, was nearly nine times faster than <italic>GNUMAP-bs</italic>. The <italic>LAST</italic> application does not support parallel computing, so <italic>LAST</italic> had the longest total alignment time. However, the <italic>LAST</italic> algorithm aligned the most reads per second per CPU (753), while <italic>Bismark-Bowtie2</italic> aligned the least (26).</p>
              </sec>
              <sec>
                <title>Human BS-seq dataset</title>
                <p>We also evaluated the performances of the alignment methods using a BS-seq dataset generated from samples from a healthy human donor collected at the Andrology Laboratory at the University of Utah (Salt Lake City, UT, USA). The BS-seq data were generated by coupling BS conversion and the Illumina HiSeq2000 platform, which generated 101-bp BSRs for analysis. We aligned 283.6 M reads from three lanes of BS sequencing data containing 85 M to 100 M sequencing reads each, to the recent build of the human genome (NCBI build37/HG19). The human BSRs were processed for quality control as suggested previously
[<xref ref-type="bibr" rid="B25">25</xref>]. Briefly, the quality control involved masking low quality bases or trimming consecutive lowest quality bases at the 3’ ends of the reads.</p>
                <p>We used the same parameters on these data as were used for the simulation experiment (Table
<xref ref-type="table" rid="T1">1</xref>) with two exceptions: -a 0.92 for <italic>GNUMAP-bs</italic> and -t 90 for <italic>Novoalign</italic>. The <italic>LAST</italic> algorithm again aligned the highest proportion (93.7%) of BSRs to the genome, followed by 70.0% for <italic>GNUMAP-bs</italic>, 68.2% for <italic>Novoalign</italic>, 67.1% for <italic>BSMAP</italic>, 67.0% for <italic>Bismark</italic>, 62.9% for <italic>Bismark-Bowtie2</italic>, and only 50.3% for <italic>BRAT-BW</italic>.</p>
                <p>We compared these mapping results with the Sanger-based BS sequencing control data available from the Human Epigenome Project (HEP)
[<xref ref-type="bibr" rid="B26">26</xref>] by selecting the data that were obtained using the same type of tissue as was used in our BS-seq dataset. The HEP data provides a natural gold standard for algorithmic evaluation. For this comparison, we focused on the 13,563 HEP CG sites on chromosome 22 (chr22), because these data provide the most comprehensive chromosomal CG coverage that is available in the HEP database. The data for the other chromosomes in the HEP showed similar profiles as chr22, but the coverage was much sparser.</p>
                <p>Overall, the mapping results produced by the different alignment methods for the human BS-seq dataset were consistent with the results for the simulation dataset. Compared with <italic>GNUMAP-bs</italic>, <italic>LAST</italic> aligned almost twice as many reads to chr22 (3.02 M compare with 1.57 M); however, the CG read coverage for <italic>LAST</italic> (7.6 reads/CG) was only about 20% higher than for <italic>GNUMAP-bs</italic> (6.3 reads/CG) (Table
<xref ref-type="table" rid="T3">3</xref>). While <italic>Novoalign</italic> aligned more reads to and covered more CG sites on chr22 than <italic>GNUMAP-bs</italic>, <italic>GNUMAP-bs</italic> had better CG read coverage (6.3 reads/CG) than <italic>Novoalign</italic> (6.1 reads/CG) and the other aligners, <italic>BSMAP</italic> (5.8 reads/CG), <italic>Bismark</italic> (5.8 reads/CG), <italic>Bismark-Bowtie2</italic> (5.7 reads/CG), and <italic>BRAT-BW</italic> (5.0 reads/CG) (Table
<xref ref-type="table" rid="T3">3</xref>).</p>
                <table-wrap position="float" id="T3">
                  <label>Table 3</label>
                  <caption>
                    <p>Human bisulfite read experiment</p>
                  </caption>
                  <table frame="hsides" rules="groups" border="1">
                    <colgroup>
                      <col align="left"/>
                      <col align="center"/>
                      <col align="center"/>
                      <col align="center"/>
                      <col align="center"/>
                      <col align="center"/>
                      <col align="center"/>
                      <col align="center"/>
                    </colgroup>
                    <thead valign="top">
                      <tr>
                        <th align="left">
                          <bold>Evaluation metric</bold>
                        </th>
                        <th align="center">
                          <bold>
                            <italic>GNUMAP-bs</italic>
                          </bold>
                        </th>
                        <th align="center">
                          <bold>
                            <italic>Novoalign</italic>
                          </bold>
                        </th>
                        <th align="center">
                          <bold>
                            <italic>BSMAP</italic>
                          </bold>
                        </th>
                        <th align="center">
                          <bold>
                            <italic>Bismark</italic>
                          </bold>
                        </th>
                        <th align="center">
                          <bold>
                            <italic>Bismark-bt2</italic>
                          </bold>
                        </th>
                        <th align="center">
                          <bold>
                            <italic>LAST</italic>
                          </bold>
                        </th>
                        <th align="center">
                          <bold>
                            <italic>BRAT-BW</italic>
                          </bold>
                        </th>
                      </tr>
                    </thead>
                    <tbody valign="top">
                      <tr>
                        <td align="left" valign="bottom">
                          <bold>All chr22:</bold>
                          <hr/>
                        </td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                      </tr>
                      <tr>
                        <td align="left" valign="bottom">Reads Aligned<hr/></td>
                        <td align="center" valign="bottom">1.57M<hr/></td>
                        <td align="center" valign="bottom">1.65M<hr/></td>
                        <td align="center" valign="bottom">1.34M<hr/></td>
                        <td align="center" valign="bottom">1.31M<hr/></td>
                        <td align="center" valign="bottom">1.21M<hr/></td>
                        <td align="center" valign="bottom">3.02M<hr/></td>
                        <td align="center" valign="bottom">0.98M<hr/></td>
                      </tr>
                      <tr>
                        <td align="left" valign="bottom">CGs Covered<hr/></td>
                        <td align="center" valign="bottom">330K<hr/></td>
                        <td align="center" valign="bottom">336K<hr/></td>
                        <td align="center" valign="bottom">330K<hr/></td>
                        <td align="center" valign="bottom">310K<hr/></td>
                        <td align="center" valign="bottom">299K<hr/></td>
                        <td align="center" valign="bottom">373K<hr/></td>
                        <td align="center" valign="bottom">275K<hr/></td>
                      </tr>
                      <tr>
                        <td align="left" valign="bottom">CG read coverage<hr/></td>
                        <td align="center" valign="bottom">6.3<hr/></td>
                        <td align="center" valign="bottom">6.1<hr/></td>
                        <td align="center" valign="bottom">5.8<hr/></td>
                        <td align="center" valign="bottom">5.8<hr/></td>
                        <td align="center" valign="bottom">5.7<hr/></td>
                        <td align="center" valign="bottom">7.6<hr/></td>
                        <td align="center" valign="bottom">5.0<hr/></td>
                      </tr>
                      <tr>
                        <td align="left" valign="bottom">
                          <bold>HEP overlap:</bold>
                          <hr/>
                        </td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                        <td align="center" valign="bottom"> <hr/></td>
                      </tr>
                      <tr>
                        <td align="left" valign="bottom">CGs Covered<hr/></td>
                        <td align="center" valign="bottom">7,902<hr/></td>
                        <td align="center" valign="bottom">7,802<hr/></td>
                        <td align="center" valign="bottom">7,747<hr/></td>
                        <td align="center" valign="bottom">7,561<hr/></td>
                        <td align="center" valign="bottom">7,331<hr/></td>
                        <td align="center" valign="bottom">8,606<hr/></td>
                        <td align="center" valign="bottom">6,690<hr/></td>
                      </tr>
                      <tr>
                        <td align="left" valign="bottom">Correlation<hr/></td>
                        <td align="center" valign="bottom">0.887<hr/></td>
                        <td align="center" valign="bottom">0.889<hr/></td>
                        <td align="center" valign="bottom">0.887<hr/></td>
                        <td align="center" valign="bottom">0.888<hr/></td>
                        <td align="center" valign="bottom">0.895<hr/></td>
                        <td align="center" valign="bottom">0.882<hr/></td>
                        <td align="center" valign="bottom">0.894<hr/></td>
                      </tr>
                      <tr>
                        <td align="left" valign="bottom">Concordance<hr/></td>
                        <td align="center" valign="bottom">0.869<hr/></td>
                        <td align="center" valign="bottom">0.867<hr/></td>
                        <td align="center" valign="bottom">0.865<hr/></td>
                        <td align="center" valign="bottom">0.867<hr/></td>
                        <td align="center" valign="bottom">0.872<hr/></td>
                        <td align="center" valign="bottom">0.858<hr/></td>
                        <td align="center" valign="bottom">0.872<hr/></td>
                      </tr>
                      <tr>
                        <td align="left">CG Read coverage</td>
                        <td align="center">4.6</td>
                        <td align="center">4.5</td>
                        <td align="center">4.4</td>
                        <td align="center">4.3</td>
                        <td align="center">4.3</td>
                        <td align="center">4.9</td>
                        <td align="center">3.7</td>
                      </tr>
                    </tbody>
                  </table>
                  <table-wrap-foot>
                    <p>Study of 162.3 M Illumina BSRs on human chromosome 22 (chr22) from a human donor sample. The top rows show the overall mapping efficiency, including covered CGs sites and read coverage aligned to chr22. The bottom rows show the consistency of each mapping result with known methylation levels at 13,563 CGs sites on chr22 available from the HEP database. The concordance statistic is defined as the fraction of overlapped CGs covered by the aligner with HEP CGs for which the methylation prediction error was smaller than 0.25.</p>
                  </table-wrap-foot>
                </table-wrap>
                <p>The differences between <italic>GNUMAP-bs</italic> and <italic>LAST</italic> become even less pronounced when the overlap between the mapped BSRs and the 13,563 CGs with HEP coverage on chr22 was considered. <italic>Last</italic> aligned the BSRs to 63.5% (8,606) of the CGs HEP sites compared with 58.3% (7,902) for <italic>GNUMAP-bs</italic>, and 57.5% (7,802) for <italic>Novoalign</italic>, 57.1% (7,747) for <italic>BSMAP</italic>, 55.7% (7,561) for <italic>Bismark</italic>, 54.1% (7,331) for <italic>Bismark-Bowtie2</italic>, and 49.3% (6,690) for <italic>BRAT-BW</italic> (Table
<xref ref-type="table" rid="T3">3</xref>).</p>
                <p>To determine if increased coverage resulted in decreased alignment quality, we computed the correlation coefficient between the estimated HEP methylation levels and the methylation levels estimated from each alignment method. The correlation coefficients were 0.887 for <italic>GNUMAP-bs</italic> and ranged from 0.895 for <italic>Bismark-Bowtie2</italic> to 0.882 for <italic>LAST</italic> (Table
<xref ref-type="table" rid="T3">3</xref>). We also computed a concordance statistic for each of the methods as defined previously
[<xref ref-type="bibr" rid="B27">27</xref>]. Briefly, the concordance is the fraction of sites for which the methylation levels (aligner vs. HEP) differ by less than a predefined cutoff (we used 0.25). Based on this statistic, we found that the performances of most of the aligners were similar, with concordance values of 0.869 for <italic>GNUMAP-bs</italic> and ranged from 0.872 for <italic>Bismark-Bowtie2</italic> 0.872 and <italic>BRAT-BW</italic> to 0.858 for <italic>LAST</italic> (Table
<xref ref-type="table" rid="T3">3</xref>). These results showed that the increased coverage levels produced by <italic>LAST</italic> result in lower consistency with the HEP data in terms of both correlation and concordance. Pairwise comparisons of the concordance for the CGs covered/not covered between <italic>GNUMAP-bs</italic> and the other aligners are shown in Figure
<xref ref-type="fig" rid="F1">1</xref>. For example, Figure
<xref ref-type="fig" rid="F1">1</xref> shows 577 CGs that were covered by <italic>GNUMAP-bs</italic> but not covered by <italic>Bismark</italic>; the concordance of the <italic>GNUMAP-bs</italic> methylation estimates for these sites was 0.78. In contrast, only six CGs covered by <italic>Bismark</italic> were not covered by <italic>GNUMAP-bs</italic>, and the concordance for these sites was extremely low (0.33). These results clearly showed that the increased mapping coverage (for both numbers of CGs covered and reads per CG) obtained using <italic>GNUMAP-bs</italic> did not result in decreased alignment quality or methylation estimates.</p>
                <fig id="F1" position="float">
                  <label>Figure 1</label>
                  <caption>
                    <p><bold><italic>GNUMAP-bs</italic></bold><bold> workflow for mapping high-throughput bisulfite reads.</bold> A flow-chart of the <italic>GNUMAP-bs</italic> algorithm is shown. For the reference genome, all Cs are converted to Ts and then each <italic>k</italic>-mer in the genome is hashed, producing a list of positions in the genome to which the <italic>k</italic>-mer sequence is mapped. Given a completely BS-converted read (e.g. TGGTGTT) where the corresponding original bisulfite read (BSR) is known (e.g. CGGTGTC), a query <italic>k</italic>-mer (e.g. TGGTG) is searched against the BS-converted hash table. Locations with a <italic>k</italic>-mer match to both the genome and the read are aligned using the original read and original genome and the <italic>GNUMAP-bs</italic> probabilistic Needleman–Wunsch (N-W) algorithm. If the alignment score passes a quality threshold, the location is considered a match and recorded on the genome for future output. The posterior probability is computed for each mapped location using Equation (1). Finally, all the mapped BSRs are used to quantify the fraction of methylation at each CG location across the reference genome.</p>
                  </caption>
                  <graphic xlink:href="1471-2105-14-337-1"/>
                </fig>
              </sec>
            </sec>
            <sec sec-type="conclusions">
              <title>Conclusions</title>
              <p>BS sequencing presents difficult challenges to researchers attempting to process the sequencing reads from BS-seq experiments. In this work, we present <italic>GNUMAP-bs</italic>, a highly accurate and effective alignment algorithm that is specifically designed to estimate DNA methylation levels with base-level resolution in BS-seq data. <italic>GNUMAP-bs</italic> uses a probabilistic approach to align BSRs to a reference genome. <italic>GNUMAP-bs</italic> was developed to achieve higher coverage and accuracy than other published BS-seq approaches by integrating base quality and alignment quality information in the mapping process. We have shown that the <italic>GNUMAP-bs</italic> probabilistic mapping approach results in an improved unbiased estimation of DNA methylation across the human genome. In simulated and real datasets, we showed that <italic>GNUMAP-bs</italic> outperforms other BS-seq alignment methods when both coverage and consistency were balanced with Sanger based BS sequencing controls.</p>
              <p>In addition, <italic>GNUMAP-bs</italic> provides many high-demand features needed for constructing a high quality methylome from BS-seq data. First, <italic>GNUMAP-bs</italic> incorporates quality sequencing data into a dynamic programming framework. This feature gives <italic>GNUMAP-bs</italic> the best balance between sensitivity and specificity of the tested BSR aligners, especially for reads that contain short polymorphisms. Second, <italic>GNUMAP-bs</italic> adaptively assigns an optimal mapping stringency based on an effective read length after the original read is trimmed. Third, <italic>GNUMAP-bs</italic> not only relies on the maximal score alignment but also probabilistically considers suboptimal alignments; that is, the alignment score is converted to a posterior probability and the probabilistic scores quantify the likelihood of the true source location for each read across the reference genome. As a result, for both the simulated and real datasets, we showed that <italic>GNUMAP-bs</italic> was more effective that the other methods in detecting read locations in the presence of sequencing errors. <italic>GNUMAP-bs</italic> also displayed the highest consistency with a known HEP methylation database. Because <italic>GNUMAP-bs</italic> supports Message Passing Interface (MPI) processing, the computational burden of the dynamic programming can be alleviated. Moreover, with computer resources becoming cheaper, computing clusters with large numbers of nodes and cores, and more computing clouds are becoming available. Therefore, memory and CPU running times are less of a bottleneck, which is especially useful for <italic>GNUMAP-bs</italic> alignments. For this reason, accuracy should currently be a more important concern in BS-seq data analysis.</p>
            </sec>
            <sec sec-type="methods">
              <title>Methods</title>
              <p>The <italic>GNUMAP-bs</italic> alignment algorithm is a modification of the <italic>GNUMAP</italic> algorithm, which consists of three main steps, all of which needed to be modified to align BSRs to a reference genome. A flow chart of the <italic>GNUMAP-bs</italic> algorithm is displayed in Figure
<xref ref-type="fig" rid="F2">2</xref>. The first step is the construction of a hash table using all genomic subsequences, where the <italic>k</italic> nucleotide (nt) long (<italic>k</italic>-mers) are the keys and the hash table values store the genomic locations of the <italic>k</italic>-mer. In addition, <italic>k</italic>-mers from the BSRs are incrementally referenced in the reads in the genomic hash table. In <italic>GNUMAP-bs</italic>, the genome and the reads are artificially 'BS-converted’ by changing all Cs to Ts before the hashing step. This process ensures that all BSRs can be referenced into the hash table regardless of whether or not they contain methylated bases.</p>
              <fig id="F2" position="float">
                <label>Figure 2</label>
                <caption>
                  <p><bold>Relative complement mapping consistency of </bold><bold><italic>GNUMAP-bs </italic></bold><bold> with HEP methylation profiles of human chromosome 22.</bold> Venn diagrams between <italic>GNUMAP-bs</italic> and <bold>(a)</bold> <italic>Novoalign</italic>, <bold>(b)</bold> <italic>BSMAP</italic>, and <bold>(c)</bold> <italic>Bismark</italic> showing both the number of covered/uncovered CG sites and the concordance (in parenthesis) of these sites with the HEP methylation profiles. The estimated levels of methylation in the additional CG sites covered by the probabilistic aligners but not by the other aligners are highly concordant with the HEP results.</p>
                </caption>
                <graphic xlink:href="1471-2105-14-337-2"/>
              </fig>
              <p>In the second step of the <italic>GNUMAP</italic> algorithm, all the BSRs are aligned to the genome at the hashed locations. The alignment is performed using a novel probabilistic alignment algorithm that uses base quality information. All the regions that meet a predefined alignment score threshold are retained for the final step. In <italic>GNUMAP-bs</italic>, the probabilistic alignment algorithm matches the unconverted (original) reads to the unconverted genome while allowing matches between Ts in the reads and Cs in the genome. Using dynamic programming in probability space for mapping BSRs to a genome has several benefits: 1) the Needleman–Wunsch algorithm is guaranteed to find the optimal alignment for a BSR; 2) by incorporating base qualities into the probabilistic algorithm, true DNA methylation can be more accurately identified in the alignment, especially in areas where the reads have low base quality; and 3) by making only a small change in the alignment scoring matrix, namely by removing the T (read) to C (genome) 'mismatch’ penalty and scoring these alignments as a 'match’, the probabilistic Needleman–Wunsch algorithm can accurately account for the BS changes in BSRs without losing reads that are partially converted, or that have genome variations or sequencing errors.</p>
              <p>During PCR amplification after BS conversion, the C to T conversions in the BSRs lead to G to A conversions on the PCR-synthesized strand as described previously
[<xref ref-type="bibr" rid="B14">14</xref>]. These G to A changes provide evidence of non-methylation on the original strand. The phenomenon also occurs for C to T changes on the PCR-synthesized strand. Therefore, the <italic>GNUMAP-bs</italic> algorithm maps each BSR twice, once looking for only C to T changes and then looking for only G to A changes. When a G to A change is observed, the read is considered to be a PCR-synthesized strand, and the non-methylation event is attributed to the original strand.</p>
              <p>In the final step, the <italic>GNUMAP-bs</italic> algorithm quantifies the significance of an alignment (e.g. a posterior probability) by assigning a mapping score that is proportional to the relative quality of alignments and inversely proportional to the number of matching sites in the reference genome. Given a BSR, <italic>r</italic>, assume that there are <italic>J</italic> "best match" locations (potential mapping locations) for which the alignment score is <italic>q</italic>[ <italic>d</italic>] for alignment to genomic position <italic>d</italic>, which is also aligned to the first base pair location of <italic>r</italic>, matches some user-defined threshold. Then, the posterior probability at each location <italic>P</italic>(<italic>r</italic><sub><italic>d</italic></sub>) can be computed as:</p>
              <p>
                <disp-formula id="bmcM1">
                  <label>(1)</label>
                  <mml:math id="M1" name="1471-2105-14-337-i1" overflow="scroll">
                    <mml:mi>P</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>d</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>e</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>q</mml:mi>
                            <mml:mo stretchy="false">[</mml:mo>
                            <mml:mi>d</mml:mi>
                            <mml:mo stretchy="false">]</mml:mo>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mo>∑</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>J</mml:mi>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>e</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>q</mml:mi>
                            <mml:mo stretchy="false">[</mml:mo>
                            <mml:mi>j</mml:mi>
                            <mml:mo stretchy="false">]</mml:mo>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:math>
                </disp-formula>
              </p>
              <p>It is worth noting that the calibrated posterior probability is a special case of the <italic>LAST</italic>[<xref ref-type="bibr" rid="B21">21</xref>] mapping probabilities equation where a scaling factor for a bit score in the simple E-value statistics is not explicitly computed.</p>
              <p>This probability provides an intuitive value between 0 and 1 representing the methylation signal for each read at each CG site. Other BS mapping programs use
<inline-formula><mml:math id="M2" name="1471-2105-14-337-i2" overflow="scroll"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>#</mml:mi><mml:mtext mathvariant="italic">mappings</mml:mtext></mml:mrow></mml:mfrac></mml:math></inline-formula> instead of Equation (1), which may not accurately capture the true posterior probability. The posterior probability indicates the relative significance of mapping a read to a particular position. The probabilistic Needleman–Wunsch computes a log-likelihood score; therefore, if a particular BSR has multiple possible mapping locations in the reference genome, the significance of each mapping decreases. After <italic>GNUMAP-bs</italic> computes <italic>P</italic>(<italic>r</italic><sub><italic>d</italic></sub>) for each read, the algorithm combines the probabilities into one methylation profile vector and infers a true methylation ratio at each CG site.</p>
              <p>For example, consider a nucleotide, <italic>n</italic><sub><italic>i</italic></sub> at genomic location <italic>i</italic>, and assume that <italic>n</italic><sub><italic>i</italic></sub> is a C residue in a reference genome. Let <italic>C</italic><sup>(<italic>m</italic>)</sup> be a methylated C residue and <italic>L</italic>(<italic>r</italic>) be the read length. For a set of aligned reads covering <italic>i</italic>, the methylation ratio <italic>c</italic>[<italic>i</italic>] can be computed as:</p>
              <p>
                <disp-formula id="bmcM2">
                  <label>(2)</label>
                  <mml:math id="M3" name="1471-2105-14-337-i3" overflow="scroll">
                    <mml:mi>c</mml:mi>
                    <mml:mo stretchy="false">[</mml:mo>
                    <mml:mi>i</mml:mi>
                    <mml:mo stretchy="false">]</mml:mo>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mo>∑</mml:mo>
                        <mml:mi>P</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>d</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo stretchy="false">|</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>=</mml:mo>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>C</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>m</mml:mi>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>∑</mml:mo>
                        <mml:mi>P</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>d</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo>,</mml:mo>
                    <mml:mi>d</mml:mi>
                    <mml:mo>≤</mml:mo>
                    <mml:mi>i</mml:mi>
                    <mml:mo>≤</mml:mo>
                    <mml:mi>d</mml:mi>
                    <mml:mo>+</mml:mo>
                    <mml:mi>L</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>d</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mi>.</mml:mi>
                  </mml:math>
                </disp-formula>
              </p>
              <p>Intuitively, the reads that cover each C location across the reference genome provide evidence of true mapping so that a reliable methylation percentage can be obtained.</p>
            </sec>
            <sec>
              <title>Software implementation and availability</title>
              <p>The <italic>GNUMAP-bs</italic> algorithm is integrated into the is <italic>GNUMAP</italic> software suite, and is freely available for download at
<ext-link ext-link-type="uri" xlink:href="http://dna.cs.byu.edu/gnumap">http://dna.cs.byu.edu/gnumap</ext-link>. The <italic>GNUMAP-bs</italic> pipeline can accommodate single-end or pair-end reads in either FASTA or FASTQ file formats. A reference genome file (or multiple reference files) in FASTA format is also required. However, to increase the efficiency of the workflow, users can opt to write the reference genome hash table to a file, which can be used in future runs. <italic>GNUMAP</italic> outputs read alignments in standard SAM file format. The <italic>GNUMAP-bs</italic> software suite contains an addition application function (<italic>sam2gmp</italic>) that summarizes a SAM file and writes it into a text file that contains one line for each cytosine in the genome. Each line in this file contains the chromosome number, the location of the cytosine on the chromosome, the number of reads, and the numbers of As, Cs, Gs, Ts, and Ns covering the location. In addition, the text file gives a likelihood ratio p-value that indicates whether there is a significant number of Cs at the location (i.e. methylation significance).</p>
              <p>In addition to the adaptations for BSRs, the <italic>GNUMAP-bs</italic> software also contains several modifications to reduce the computational time and memory needed for the alignments. For example, the initial read and genome conversion step reduces the genome alphabet to three bases, leading to an increase in the number of genome locations identified in the hash table. To reduce this effect, multiple seeds from each read are referenced by <italic>GNUMAP-bs</italic>, and the alignment is only conducted on the locations with the top two most <italic>k</italic>-mer hash references. Furthermore, although the original <italic>GNUMAP</italic> software supports multi-threaded computing within the same node using <monospace>pthread</monospace>, <italic>GNUMAP-bs</italic> is fully enabled to support MPI processing. This feature allows a large-scale alignment to be spread across multiple nodes in a cluster or supercomputing facility
[<xref ref-type="bibr" rid="B28">28</xref>]. In this implementation, the genome is divided into equal parts across nodes, and then the same batches of reads are aligned by each node to their individual portion of the genome. Once the batch is completed, the nodes communicate via MPI to calculate the posterior probability scores. Because most of the CPU time is spent on the alignments, the communication overhead is relatively small, resulting in a highly efficient parallel algorithm.</p>
            </sec>
            <sec>
              <title>Competing interests</title>
              <p>The authors declare that they have no competing interests.</p>
            </sec>
            <sec>
              <title>Authors’ contributions</title>
              <p>QS, MJC, and WEJ conceived the study and developed the algorithm. CH and NLC implemented the algorithm and developed the software. CH and SC generated the simulated read dataset and analyzed both datasets. SSH, DTC, and BRC generated the human BS-seq datasets. CH and WEJ wrote the paper. All authors read and approved the final manuscript.</p>
            </sec>
          </body>
          <back>
            <sec>
              <title>Acknowledgements</title>
              <p>This research was conducted using the Fulton Supercomputing Lab at Brigham Young University (Provo, UT, USA) and the Linux Clusters for Genetic Analysis (LinGA) computing resources at Boston University Medical Campus (Boston, MA, USA). The study was supported financially by a grant from the National Institutes of Health (NIH) (R01 HG005692).</p>
            </sec>
            <ref-list>
              <ref id="B1">
                <mixed-citation publication-type="journal">
                  <name>
                    <surname>Clark</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Harrison</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Frommer</surname>
                    <given-names>M</given-names>
                  </name>
                  <etal/>
                  <article-title>CpNpG methylation in mammalian cells</article-title>
                  <source>Nat Genet</source>
                  <year>1995</year>
                  <volume>14</volume>
                  <fpage>20</fpage>
                  <lpage>27</lpage>
                  <pub-id pub-id-type="doi">10.1038/ng0595-20</pub-id>
                  <?supplied-pmid 7647784?>
                  <pub-id pub-id-type="pmid">7647784</pub-id>
                </mixed-citation>
              </ref>
              <ref id="B2">
                <mixed-citation publication-type="journal">
                  <name>
                    <surname>Bernstein</surname>
                    <given-names>BE</given-names>
                  </name>
                  <name>
                    <surname>Meissner</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Lander</surname>
                    <given-names>ES</given-names>
                  </name>
                  <article-title>The mammalian epigenome</article-title>
                  <source>Cell</source>
                  <year>2007</year>
                  <volume>14</volume>
                  <issue>4</issue>
                  <fpage>669</fpage>
                  <lpage>681</lpage>
                  <pub-id pub-id-type="doi">10.1016/j.cell.2007.01.033</pub-id>
                  <?supplied-pmid 17320505?>
                  <pub-id pub-id-type="pmid">17320505</pub-id>
                </mixed-citation>
              </ref>
              <ref id="B3">
                <mixed-citation publication-type="journal">
                  <name>
                    <surname>Ramsahoye</surname>
                    <given-names>BH</given-names>
                  </name>
                  <name>
                    <surname>Biniszkiewicz</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Lyko</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>Clark</surname>
                    <given-names>V</given-names>
                  </name>
                  <name>
                    <surname>Bird</surname>
                    <given-names>AP</given-names>
                  </name>
                  <name>
                    <surname>Jaenisch</surname>
                    <given-names>R</given-names>
                  </name>
                  <article-title>Non-CpG methylation is prevalent in embryonic stem cells and may be mediated by DNA methyltransferase 3a</article-title>
                  <source>Proc Nat Acad Sci</source>
                  <year>2000</year>
                  <volume>14</volume>
                  <issue>10</issue>
                  <fpage>5237</fpage>
                  <lpage>5242</lpage>
                  <comment>
                    <ext-link ext-link-type="uri" xlink:href="http://www.pnas.org/content/97/10/5237.abstract">http://www.pnas.org/content/97/10/5237.abstract</ext-link>
                  </comment>
                  <pub-id pub-id-type="doi">10.1073/pnas.97.10.5237</pub-id>
                  <?supplied-pmid 10805783?>
                  <pub-id pub-id-type="pmid">10805783</pub-id>
                </mixed-citation>
              </ref>
              <ref id="B4">
                <mixed-citation publication-type="journal">
                  <name>
                    <surname>Haines</surname>
                    <given-names>TR</given-names>
                  </name>
                  <name>
                    <surname>Rodenhiser</surname>
                    <given-names>DI</given-names>
                  </name>
                  <name>
                    <surname>Ainsworth</surname>
                    <given-names>PJ</given-names>
                  </name>
                  <article-title>Allele-Specific non-CpG methylation of the Nf1 Gene during early mouse development</article-title>
                  <source>Dev Biol</source>
                  <year>2001</year>
                  <volume>14</volume>
                  <issue>2</issue>
                  <fpage>585</fpage>
                  <lpage>598</lpage>
                  <comment>
                    <ext-link ext-link-type="uri" xlink:href="http://www.sciencedirect.com/science/article/pii/S0012160601905044">http://www.sciencedirect.com/science/article/pii/S0012160601905044</ext-link>
                  </comment>
                  <pub-id pub-id-type="doi">10.1006/dbio.2001.0504</pub-id>
                  <?supplied-pmid 11784085?>
                  <pub-id pub-id-type="pmid">11784085</pub-id>
                </mixed-citation>
              </ref>
              <ref id="B5">
                <mixed-citation publication-type="journal">
                  <name>
                    <surname>Grandjean</surname>
                    <given-names>V</given-names>
                  </name>
                  <name>
                    <surname>Yaman</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Cuzin</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>Rassoulzadegan</surname>
                    <given-names>M</given-names>
                  </name>
                  <article-title>Inheritance of an epigenetic mark: the CpG DNA Methyltransferase 1 is required for de novo establishment of a complex pattern of non-CpG methylation</article-title>
                  <source>PLoS ONE</source>
                  <year>2007</year>
                  <volume>14</volume>
                  <issue>11</issue>
                  <fpage>e1136</fpage>
                  <comment>
                    <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/article/info%3Adoi%2F10.1371%2Fjournal.pone.0001136">http://www.plosone.org/article/info%3Adoi%2F10.1371%2Fjournal.pone.0001136</ext-link>
                  </comment>
                  <pub-id pub-id-type="doi">10.1371/journal.pone.0001136</pub-id>
                  <?supplied-pmid 17989773?>
                  <pub-id pub-id-type="pmid">17989773</pub-id>
                </mixed-citation>
              </ref>
              <ref id="B6">
                <mixed-citation publication-type="journal">
                  <name>
                    <surname>Lister</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Pelizzola</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Dowen</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Hawkins</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Hon</surname>
                    <given-names>G</given-names>
                  </name>
                  <name>
                    <surname>Tonti-Filippini</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Nery</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Lee</surname>
                    <given-names>L</given-names>
                  </name>
                  <name>
                    <surname>Ye</surname>
                    <given-names>Z</given-names>
                  </name>
                  <name>
                    <surname>Ngo</surname>
                    <given-names>Q</given-names>
                  </name>
                  <etal/>
                  <article-title>Human DNA methylomes at base resolution show widespread epigenomic differences</article-title>
                  <source>Nature</source>
                  <year>2009</year>
                  <volume>14</volume>
                  <issue>7271</issue>
                  <fpage>315</fpage>
                  <lpage>322</lpage>
                  <pub-id pub-id-type="doi">10.1038/nature08514</pub-id>
                  <?supplied-pmid 19829295?>
                  <pub-id pub-id-type="pmid">19829295</pub-id>
                </mixed-citation>
              </ref>
              <ref id="B7">
                <mixed-citation publication-type="journal">
                  <name>
                    <surname>Riggs</surname>
                    <given-names>AD</given-names>
                  </name>
                  <article-title>X inactivation, differentiation, and DNA methylation</article-title>
                  <source>Cytogenet Cell Genet</source>
                  <year>1975</year>
                  <volume>14</volume>
                  <fpage>9</fpage>
                  <lpage>25</lpage>
                  <pub-id pub-id-type="doi">10.1159/000130315</pub-id>
                  <?supplied-pmid 1093816?>
                  <pub-id pub-id-type="pmid">1093816</pub-id>
                </mixed-citation>
              </ref>
              <ref id="B8">
                <mixed-citation publication-type="journal">
                  <name>
                    <surname>Holliday</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Pugh</surname>
                    <given-names>JE</given-names>
                  </name>
                  <article-title>DNA modification mechanisms and gene activity during development</article-title>
                  <source>Science</source>
                  <year>1975</year>
                  <volume>14</volume>
                  <issue>4173</issue>
                  <fpage>226</fpage>
                  <lpage>232</lpage>
                  <pub-id pub-id-type="doi">10.1126/science.1111098</pub-id>
                  <?supplied-pmid 1111098?>
                  <pub-id pub-id-type="pmid">1111098</pub-id>
                </mixed-citation>
              </ref>
              <ref id="B9">
                <mixed-citation publication-type="journal">
                  <name>
                    <surname>Morison</surname>
                    <given-names>IM</given-names>
                  </name>
                  <name>
                    <surname>Ramsay</surname>
                    <given-names>JP</given-names>
                  </name>
                  <name>
                    <surname>Spencer</surname>
                    <given-names>HG</given-names>
                  </name>
                  <article-title>A census of mammalian imprinting</article-title>
                  <source>Trends Genet</source>
                  <year>2005</year>
                  <volume>14</volume>
                  <issue>8</issue>
                  <fpage>457</fpage>
                  <lpage>465</lpage>
                  <pub-id pub-id-type="doi">10.1016/j.tig.2005.06.008</pub-id>
                  <?supplied-pmid 15990197?>
                  <pub-id pub-id-type="pmid">15990197</pub-id>
                </mixed-citation>
              </ref>
              <ref id="B10">
                <mixed-citation publication-type="journal">
                  <name>
                    <surname>Chow</surname>
                    <given-names>JC</given-names>
                  </name>
                  <name>
                    <surname>Yen</surname>
                    <given-names>Z</given-names>
                  </name>
                  <name>
                    <surname>Ziesche</surname>
                    <given-names>SM</given-names>
                  </name>
                  <name>
                    <surname>Brown</surname>
                    <given-names>CJ</given-names>
                  </name>
                  <article-title>Silencing of the mammalian X chromosome</article-title>
                  <source>Annu Rev Genomics Hum Genet</source>
                  <year>2005</year>
                  <volume>14</volume>
                  <fpage>69</fpage>
                  <lpage>92</lpage>
                  <pub-id pub-id-type="doi">10.1146/annurev.genom.6.080604.162350</pub-id>
                  <?supplied-pmid 16124854?>
                  <pub-id pub-id-type="pmid">16124854</pub-id>
                </mixed-citation>
              </ref>
              <ref id="B11">
                <mixed-citation publication-type="journal">
                  <name>
                    <surname>Reik</surname>
                    <given-names>W</given-names>
                  </name>
                  <article-title>Stability and flexibility of epigenetic gene regulation in mammalian development</article-title>
                  <source>Nature</source>
                  <year>2007</year>
                  <volume>14</volume>
                  <issue>7143</issue>
                  <fpage>425</fpage>
                  <lpage>432</lpage>
                  <pub-id pub-id-type="doi">10.1038/nature05918</pub-id>
                  <?supplied-pmid 17522676?>
                  <pub-id pub-id-type="pmid">17522676</pub-id>
                </mixed-citation>
              </ref>
              <ref id="B12">
                <mixed-citation publication-type="journal">
                  <name>
                    <surname>Feinberg</surname>
                    <given-names>AP</given-names>
                  </name>
                  <name>
                    <surname>Vogelstein</surname>
                    <given-names>B</given-names>
                  </name>
                  <article-title>Hypomethylation distinguishes genes of some human cancers from their normal counterparts</article-title>
                  <source>Nature</source>
                  <year>1983</year>
                  <volume>14</volume>
                  <issue>5895</issue>
                  <fpage>89</fpage>
                  <lpage>92</lpage>
                  <pub-id pub-id-type="doi">10.1038/301089a0</pub-id>
                  <?supplied-pmid 6185846?>
                  <pub-id pub-id-type="pmid">6185846</pub-id>
                </mixed-citation>
              </ref>
              <ref id="B13">
                <mixed-citation publication-type="journal">
                  <name>
                    <surname>Frommer</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>McDonald</surname>
                    <given-names>L</given-names>
                  </name>
                  <name>
                    <surname>Millar</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Collis</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Watt</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>Grigg</surname>
                    <given-names>G</given-names>
                  </name>
                  <name>
                    <surname>Molloy</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Paul</surname>
                    <given-names>C</given-names>
                  </name>
                  <article-title>A genomic sequencing protocol that yields a positive display of 5-methylcytosine residues in individual DNA strands</article-title>
                  <source>Proc Nat Acad Sci</source>
                  <year>1992</year>
                  <volume>14</volume>
                  <issue>5</issue>
                  <fpage>1827</fpage>
                  <pub-id pub-id-type="doi">10.1073/pnas.89.5.1827</pub-id>
                  <?supplied-pmid 1542678?>
                  <pub-id pub-id-type="pmid">1542678</pub-id>
                </mixed-citation>
              </ref>
              <ref id="B14">
                <mixed-citation publication-type="journal">
                  <name>
                    <surname>Xi</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Li</surname>
                    <given-names>W</given-names>
                  </name>
                  <article-title>BSMAP: whole genome bisulfite sequence MAPping program</article-title>
                  <source>BMC Bioinformatics</source>
                  <year>2009</year>
                  <volume>14</volume>
                  <fpage>232</fpage>
                  <pub-id pub-id-type="doi">10.1186/1471-2105-10-232</pub-id>
                  <?supplied-pmid 19635165?>
                  <pub-id pub-id-type="pmid">19635165</pub-id>
                </mixed-citation>
              </ref>
              <ref id="B15">
                <mixed-citation publication-type="journal">
                  <name>
                    <surname>Cokus</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Feng</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Zhang</surname>
                    <given-names>X</given-names>
                  </name>
                  <name>
                    <surname>Chen</surname>
                    <given-names>Z</given-names>
                  </name>
                  <name>
                    <surname>Merriman</surname>
                    <given-names>B</given-names>
                  </name>
                  <name>
                    <surname>Haudenschild</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Pradhan</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Nelson</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Pellegrini</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Jacobsen</surname>
                    <given-names>S</given-names>
                  </name>
                  <article-title>Shotgun bisulphite sequencing of the Arabidopsis genome reveals DNA methylation patterning</article-title>
                  <source>Nature</source>
                  <year>2008</year>
                  <volume>14</volume>
                  <issue>7184</issue>
                  <fpage>215</fpage>
                  <lpage>219</lpage>
                  <pub-id pub-id-type="doi">10.1038/nature06745</pub-id>
                  <?supplied-pmid 18278030?>
                  <pub-id pub-id-type="pmid">18278030</pub-id>
                </mixed-citation>
              </ref>
              <ref id="B16">
                <mixed-citation publication-type="journal">
                  <name>
                    <surname>Lister</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>O’Malley</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Tonti-Filippini</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Gregory</surname>
                    <given-names>B</given-names>
                  </name>
                  <name>
                    <surname>Berry</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Millar</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Ecker</surname>
                    <given-names>J</given-names>
                  </name>
                  <article-title>Highly integrated single-base resolution maps of the epigenome in Arabidopsis</article-title>
                  <source>Cell</source>
                  <year>2008</year>
                  <volume>14</volume>
                  <issue>3</issue>
                  <fpage>523</fpage>
                  <lpage>536</lpage>
                  <pub-id pub-id-type="doi">10.1016/j.cell.2008.03.029</pub-id>
                  <?supplied-pmid 18423832?>
                  <pub-id pub-id-type="pmid">18423832</pub-id>
                </mixed-citation>
              </ref>
              <ref id="B17">
                <mixed-citation publication-type="journal">
                  <name>
                    <surname>Chen</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Cokus</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Pellegrini</surname>
                    <given-names>M</given-names>
                  </name>
                  <article-title>BS Seeker: precise mapping for bisulfite sequencing</article-title>
                  <source>BMC Bioinformatics</source>
                  <year>2010</year>
                  <volume>14</volume>
                  <fpage>203</fpage>
                  <comment>
                    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/11/203">http://www.biomedcentral.com/1471-2105/11/203</ext-link>
                  </comment>
                  <pub-id pub-id-type="doi">10.1186/1471-2105-11-203</pub-id>
                  <?supplied-pmid 20416082?>
                  <pub-id pub-id-type="pmid">20416082</pub-id>
                </mixed-citation>
              </ref>
              <ref id="B18">
                <mixed-citation publication-type="journal">
                  <name>
                    <surname>Krueger</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>Andrews</surname>
                    <given-names>SR</given-names>
                  </name>
                  <article-title>Bismark: a flexible aligner and methylation caller for Bisulfite-Seq applications</article-title>
                  <source>Bioinformatics</source>
                  <year>2011</year>
                  <volume>14</volume>
                  <issue>11</issue>
                  <fpage>1571</fpage>
                  <lpage>1572</lpage>
                  <comment><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/content/27/11/1571.long">http://bioinformatics.oxfordjournals.org/content/27/11/1571.long</ext-link>;
<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btr167">http://dx.doi.org/10.1093/bioinformatics/btr167</ext-link></comment>
                  <pub-id pub-id-type="doi">10.1093/bioinformatics/btr167</pub-id>
                  <?supplied-pmid 21493656?>
                  <pub-id pub-id-type="pmid">21493656</pub-id>
                </mixed-citation>
              </ref>
              <ref id="B19">
                <mixed-citation publication-type="journal">
                  <name>
                    <surname>Harris</surname>
                    <given-names>EY</given-names>
                  </name>
                  <name>
                    <surname>Ponts</surname>
                    <given-names>N</given-names>
                  </name>
                  <name>
                    <surname>Roch</surname>
                    <given-names>KGL</given-names>
                  </name>
                  <name>
                    <surname>Lonardi</surname>
                    <given-names>S</given-names>
                  </name>
                  <article-title>BRAT-BW: efficient and accurate mapping of bisulfite-treated reads</article-title>
                  <source>Bioinformatics</source>
                  <year>2012</year>
                  <volume>14</volume>
                  <issue>13</issue>
                  <fpage>1795</fpage>
                  <lpage>1796</lpage>
                  <comment><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/content/28/13/1795.long">http://bioinformatics.oxfordjournals.org/content/28/13/1795.long</ext-link>;
<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bts264">http://dx.doi.org/10.1093/bioinformatics/bts264</ext-link></comment>
                  <pub-id pub-id-type="doi">10.1093/bioinformatics/bts264</pub-id>
                  <?supplied-pmid 22563065?>
                  <pub-id pub-id-type="pmid">22563065</pub-id>
                </mixed-citation>
              </ref>
              <ref id="B20">
                <mixed-citation publication-type="other">
                  <name>
                    <surname>Burrows</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Wheeler</surname>
                    <given-names>D</given-names>
                  </name>
                  <article-title>A block-sorting lossless data compression algorithm</article-title>
                  <year>1994,</year>
                  <comment>Technical Report SRC-RR-124, Digital Equipment Corporation, 1–16</comment>
                </mixed-citation>
              </ref>
              <ref id="B21">
                <mixed-citation publication-type="journal">
                  <name>
                    <surname>Frith</surname>
                    <given-names>MC</given-names>
                  </name>
                  <name>
                    <surname>Mori</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Asai</surname>
                    <given-names>K</given-names>
                  </name>
                  <article-title>A mostly traditional approach improves alignment of bisulfite-converted DNA</article-title>
                  <source>Nucleic Acids Res</source>
                  <year>2012</year>
                  <volume>14</volume>
                  <issue>13</issue>
                  <fpage>e100</fpage>
                  <lpage>e100</lpage>
                  <comment>
                    <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/content/38/7/e96.short">http://nar.oxfordjournals.org/content/38/7/e96.short</ext-link>
                  </comment>
                  <pub-id pub-id-type="doi">10.1093/nar/gks275</pub-id>
                  <?supplied-pmid 22457070?>
                  <pub-id pub-id-type="pmid">22457070</pub-id>
                </mixed-citation>
              </ref>
              <ref id="B22">
                <mixed-citation publication-type="journal">
                  <name>
                    <surname>Altschul</surname>
                    <given-names>SF</given-names>
                  </name>
                  <name>
                    <surname>Madden</surname>
                    <given-names>TL</given-names>
                  </name>
                  <name>
                    <surname>Shaffer</surname>
                    <given-names>AA</given-names>
                  </name>
                  <name>
                    <surname>Zhang</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Zhang</surname>
                    <given-names>Z</given-names>
                  </name>
                  <name>
                    <surname>Miller</surname>
                    <given-names>W</given-names>
                  </name>
                  <name>
                    <surname>Lipman</surname>
                    <given-names>DJ</given-names>
                  </name>
                  <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>
                  <source>Nucleic Acids Res</source>
                  <year>1997</year>
                  <volume>14</volume>
                  <issue>17</issue>
                  <fpage>3389</fpage>
                  <lpage>402</lpage>
                  <pub-id pub-id-type="doi">10.1093/nar/25.17.3389</pub-id>
                  <?supplied-pmid 9254694?>
                  <pub-id pub-id-type="pmid">9254694</pub-id>
                </mixed-citation>
              </ref>
              <ref id="B23">
                <mixed-citation publication-type="journal">
                  <name>
                    <surname>Frith</surname>
                    <given-names>MC</given-names>
                  </name>
                  <name>
                    <surname>Wan</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Horton</surname>
                    <given-names>P</given-names>
                  </name>
                  <article-title>Incorporating sequence quality data into alignment improves DNA read mapping</article-title>
                  <source>Nucleic Acids Res</source>
                  <year>2010</year>
                  <volume>14</volume>
                  <issue>7</issue>
                  <fpage>100</fpage>
                  <lpage>100</lpage>
                  <comment>
                    <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/content/38/7/e100.long">http://nar.oxfordjournals.org/content/38/7/e100.long</ext-link>
                  </comment>
                  <pub-id pub-id-type="doi">10.1093/nar/gkq010</pub-id>
                </mixed-citation>
              </ref>
              <ref id="B24">
                <mixed-citation publication-type="journal">
                  <name>
                    <surname>Clement</surname>
                    <given-names>NL</given-names>
                  </name>
                  <name>
                    <surname>Snell</surname>
                    <given-names>Q</given-names>
                  </name>
                  <name>
                    <surname>Clement</surname>
                    <given-names>MJ</given-names>
                  </name>
                  <name>
                    <surname>Hollenhorst</surname>
                    <given-names>PC</given-names>
                  </name>
                  <name>
                    <surname>Purwar</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Graves</surname>
                    <given-names>BJ</given-names>
                  </name>
                  <name>
                    <surname>Cairns</surname>
                    <given-names>BR</given-names>
                  </name>
                  <name>
                    <surname>Johnson</surname>
                    <given-names>WE</given-names>
                  </name>
                  <article-title>The GNUMAP algorithm: unbiased probabilistic mapping of oligonucleotides from next-generation sequencing</article-title>
                  <source>Bioinformatics</source>
                  <year>2010</year>
                  <volume>14</volume>
                  <fpage>38</fpage>
                  <lpage>45</lpage>
                  <comment><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/content/26/1/38">http://bioinformatics.oxfordjournals.org/content/26/1/38</ext-link>;
<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btp614">http://dx.doi.org/10.1093/bioinformatics/btp614</ext-link></comment>
                  <pub-id pub-id-type="doi">10.1093/bioinformatics/btp614</pub-id>
                  <?supplied-pmid 19861355?>
                  <pub-id pub-id-type="pmid">19861355</pub-id>
                </mixed-citation>
              </ref>
              <ref id="B25">
                <mixed-citation publication-type="journal">
                  <name>
                    <surname>Chatterjee</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Stockwell</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Rodger</surname>
                    <given-names>E</given-names>
                  </name>
                  <name>
                    <surname>Morison</surname>
                    <given-names>I</given-names>
                  </name>
                  <article-title>Comparison of alignment software for genome-wide bisulphite sequence data</article-title>
                  <source>Nucleic Acids Res</source>
                  <year>2012</year>
                  <volume>14</volume>
                  <issue>10</issue>
                  <fpage>e79</fpage>
                  <pub-id pub-id-type="doi">10.1093/nar/gks150</pub-id>
                  <?supplied-pmid 22344695?>
                  <pub-id pub-id-type="pmid">22344695</pub-id>
                </mixed-citation>
              </ref>
              <ref id="B26">
                <mixed-citation publication-type="journal">
                  <name>
                    <surname>Eckhardt</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>Lewin</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Cortese</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Rakyan</surname>
                    <given-names>V</given-names>
                  </name>
                  <name>
                    <surname>Attwood</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Burger</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Burton</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Cox</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Davies</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Down</surname>
                    <given-names>T</given-names>
                  </name>
                  <etal/>
                  <article-title>DNA methylation profiling of human chromosomes 6, 20 and 22</article-title>
                  <source>Nat Genet</source>
                  <year>2006</year>
                  <volume>14</volume>
                  <issue>12</issue>
                  <fpage>1378</fpage>
                  <lpage>1385</lpage>
                  <pub-id pub-id-type="doi">10.1038/ng1909</pub-id>
                  <?supplied-pmid 17072317?>
                  <pub-id pub-id-type="pmid">17072317</pub-id>
                </mixed-citation>
              </ref>
              <ref id="B27">
                <mixed-citation publication-type="journal">
                  <name>
                    <surname>Harris</surname>
                    <given-names>RA</given-names>
                  </name>
                  <name>
                    <surname>Wang</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Coarfa</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Nagarajan</surname>
                    <given-names>RP</given-names>
                  </name>
                  <name>
                    <surname>Hong</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Downey</surname>
                    <given-names>SL</given-names>
                  </name>
                  <name>
                    <surname>Johnson</surname>
                    <given-names>BE</given-names>
                  </name>
                  <name>
                    <surname>Fouse</surname>
                    <given-names>SD</given-names>
                  </name>
                  <name>
                    <surname>Delaney</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Zhao</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Olshen</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Ballinger</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Zhou</surname>
                    <given-names>X</given-names>
                  </name>
                  <name>
                    <surname>Forsberg</surname>
                    <given-names>KJ</given-names>
                  </name>
                  <name>
                    <surname>Gu</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Echipare</surname>
                    <given-names>L</given-names>
                  </name>
                  <name>
                    <surname>O’Geen</surname>
                    <given-names>H</given-names>
                  </name>
                  <name>
                    <surname>Lister</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Pelizzola</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Xi</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Epstein</surname>
                    <given-names>CB</given-names>
                  </name>
                  <name>
                    <surname>Bernstein</surname>
                    <given-names>BE</given-names>
                  </name>
                  <name>
                    <surname>Hawkins</surname>
                    <given-names>RD</given-names>
                  </name>
                  <name>
                    <surname>Ren</surname>
                    <given-names>B</given-names>
                  </name>
                  <name>
                    <surname>Chung</surname>
                    <given-names>WY</given-names>
                  </name>
                  <name>
                    <surname>Gu</surname>
                    <given-names>H</given-names>
                  </name>
                  <name>
                    <surname>Bock</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Gnirke</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Zhang</surname>
                    <given-names>MQ</given-names>
                  </name>
                  <name>
                    <surname>Haussler</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Ecker</surname>
                    <given-names>JR</given-names>
                  </name>
                  <name>
                    <surname>Li</surname>
                    <given-names>W</given-names>
                  </name>
                  <name>
                    <surname>Farnham</surname>
                    <given-names>PJ</given-names>
                  </name>
                  <name>
                    <surname>Waterland</surname>
                    <given-names>RA</given-names>
                  </name>
                  <name>
                    <surname>Meissner</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Marra</surname>
                    <given-names>MA</given-names>
                  </name>
                  <name>
                    <surname>Hirst</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Milosavljevic</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Costello</surname>
                    <given-names>JF</given-names>
                  </name>
                  <article-title>Comparison of sequencing-based methods to profile DNA methylation and identification of monoallelic epigenetic modifications</article-title>
                  <source>Nat Biotechnol</source>
                  <year>2010</year>
                  <volume>14</volume>
                  <issue>10</issue>
                  <fpage>1097</fpage>
                  <lpage>1105</lpage>
                  <pub-id pub-id-type="doi">10.1038/nbt.1682</pub-id>
                  <?supplied-pmid 20852635?>
                  <pub-id pub-id-type="pmid">20852635</pub-id>
                </mixed-citation>
              </ref>
              <ref id="B28">
                <mixed-citation publication-type="journal">
                  <name>
                    <surname>Clement</surname>
                    <given-names>N</given-names>
                  </name>
                  <name>
                    <surname>Clement</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Snell</surname>
                    <given-names>Q</given-names>
                  </name>
                  <name>
                    <surname>Johnson</surname>
                    <given-names>W</given-names>
                  </name>
                  <article-title>Parallel Mapping Approaches for GNUMAP</article-title>
                  <source>2012 IEEE 26th Int Parallel Distributed Process Symp Workshops PhD Forum</source>
                  <year>2011</year>
                  <volume>14</volume>
                  <issue>1530-2075</issue>
                  <fpage>435</fpage>
                  <lpage>443</lpage>
                </mixed-citation>
              </ref>
            </ref-list>
          </back>
        </article>
      </metadata>
    </record>
  </GetRecord>
</OAI-PMH>
