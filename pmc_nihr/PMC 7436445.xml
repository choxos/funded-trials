<?xml version="1.0" encoding="UTF-8"?>
<OAI-PMH xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.openarchives.org/OAI/2.0/ http://www.openarchives.org/OAI/2.0/OAI-PMH.xsd">
  <responseDate>2024-05-03T10:37:16Z</responseDate>
  <request verb="GetRecord" identifier="oai:pubmedcentral.nih.gov:7436445" metadataPrefix="pmc">https:/www.ncbi.nlm.nih.gov/pmc/oai/oai.cgi</request>
  <GetRecord>
    <record>
      <header>
        <identifier>oai:pubmedcentral.nih.gov:7436445</identifier>
        <datestamp>2020-09-04</datestamp>
        <setSpec>sageopen</setSpec>
        <setSpec>pmc-open</setSpec>
      </header>
      <metadata>
        <article xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xsi:schemaLocation="https://jats.nlm.nih.gov/ns/archiving/1.3/ https://jats.nlm.nih.gov/archiving/1.3/xsd/JATS-archivearticle1-3.xsd" article-type="research-article">
          <front>
            <journal-meta>
              <journal-id journal-id-type="nlm-ta">Stat Methods Med Res</journal-id>
              <journal-id journal-id-type="iso-abbrev">Stat Methods Med Res</journal-id>
              <journal-id journal-id-type="publisher-id">SMM</journal-id>
              <journal-id journal-id-type="hwp">spsmm</journal-id>
              <journal-title-group>
                <journal-title>Statistical Methods in Medical Research</journal-title>
              </journal-title-group>
              <issn pub-type="ppub">0962-2802</issn>
              <issn pub-type="epub">1477-0334</issn>
              <publisher>
                <publisher-name>SAGE Publications</publisher-name>
                <publisher-loc>Sage UK: London, England</publisher-loc>
              </publisher>
            </journal-meta>
            <article-meta>
              <article-id pub-id-type="accession">PMC7436445</article-id>
              <article-id pub-id-type="pmcid">PMC7436445</article-id>
              <article-id pub-id-type="pmc-uid">7436445</article-id>
              <article-id pub-id-type="pmid">32223524</article-id>
              <article-id pub-id-type="doi">10.1177/0962280220912524</article-id>
              <article-id pub-id-type="publisher-id">10.1177_0962280220912524</article-id>
              <article-categories>
                <subj-group subj-group-type="heading">
                  <subject>Articles</subject>
                </subj-group>
              </article-categories>
              <title-group>
                <article-title>Improved two-stage estimation to adjust for treatment switching in randomised trials: g-estimation to address time-dependent confounding</article-title>
              </title-group>
              <contrib-group>
                <contrib contrib-type="author">
                  <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-5304-5585</contrib-id>
                  <name>
                    <surname>Latimer</surname>
                    <given-names>NR</given-names>
                  </name>
                  <xref ref-type="aff" rid="aff1-0962280220912524">1</xref>
                  <xref ref-type="corresp" rid="corresp1-0962280220912524"/>
                </contrib>
                <contrib contrib-type="author">
                  <name>
                    <surname>White</surname>
                    <given-names>IR</given-names>
                  </name>
                  <xref ref-type="aff" rid="aff2-0962280220912524">2</xref>
                </contrib>
                <contrib contrib-type="author">
                  <name>
                    <surname>Tilling</surname>
                    <given-names>K</given-names>
                  </name>
                  <xref ref-type="aff" rid="aff3-0962280220912524">3</xref>
                  <xref ref-type="aff" rid="aff4-0962280220912524">4</xref>
                </contrib>
                <contrib contrib-type="author">
                  <name>
                    <surname>Siebert</surname>
                    <given-names>U</given-names>
                  </name>
                  <xref ref-type="aff" rid="aff5-0962280220912524">5</xref>
                  <xref ref-type="aff" rid="aff6-0962280220912524">6</xref>
                  <xref ref-type="aff" rid="aff7-0962280220912524">7</xref>
                </contrib>
                <aff id="aff1-0962280220912524"><label>1</label>School of Health and Related Research, University of Sheffield, Sheffield, UK</aff>
                <aff id="aff2-0962280220912524"><label>2</label>MRC Clinical Trials Unit, University College London, London, UK</aff>
                <aff id="aff3-0962280220912524"><label>3</label>Population Health Sciences, Bristol Medical School, University of Bristol, Bristol, UK</aff>
                <aff id="aff4-0962280220912524"><label>4</label>MRC Integrative Epidemiology Unit at the University of Bristol, Bristol, UK</aff>
                <aff id="aff5-0962280220912524"><label>5</label>Department of Public Health, Health Services Research and Health Technology Assessment, UMIT -- University for Health Sciences, Medical Informatics and Technology, Hall i.T., Austria</aff>
                <aff id="aff6-0962280220912524"><label>6</label>ONCOTYROL -- Center for Personalized Cancer Medicine, Innsbruck, Austria</aff>
                <aff id="aff7-0962280220912524"><label>7</label>Harvard T.H. Chan School of Public Health and Massachusetts General Hospital, Harvard Medical School, Boston, MA, USA</aff>
              </contrib-group>
              <author-notes>
                <corresp id="corresp1-0962280220912524">Nicholas Latimer, School of Health and Related Research, University of Sheffield, Regent Court, 30 Regent Street, Sheffield S1 4DA, UK. Email: <email>n.latimer@shef.ac.uk</email></corresp>
              </author-notes>
              <pub-date pub-type="epub">
                <day>30</day>
                <month>3</month>
                <year>2020</year>
              </pub-date>
              <pub-date pub-type="ppub">
                <month>10</month>
                <year>2020</year>
              </pub-date>
              <volume>29</volume>
              <issue>10</issue>
              <fpage>2900</fpage>
              <lpage>2918</lpage>
              <permissions>
                <copyright-statement>© The Author(s) 2020</copyright-statement>
                <copyright-year>2020</copyright-year>
                <copyright-holder content-type="sage">SAGE Publications</copyright-holder>
                <license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">
                  <license-p>This article is distributed under the terms of the Creative Commons Attribution-NonCommercial 4.0 License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>) which permits non-commercial use, reproduction and distribution of the work without further permission provided the original work is attributed as specified on the SAGE and Open Access pages (<ext-link ext-link-type="uri" xlink:href="https://us.sagepub.com/en-us/nam/open-access-at-sage">https://us.sagepub.com/en-us/nam/open-access-at-sage</ext-link>).</license-p>
                </license>
              </permissions>
              <abstract>
                <p>In oncology trials, control group patients often switch onto the experimental treatment during follow-up, usually after disease progression. In this case, an intention-to-treat analysis will not address the policy question of interest – that of whether the new treatment represents an effective and cost-effective use of health care resources, compared to the standard treatment. Rank preserving structural failure time models (RPSFTM), inverse probability of censoring weights (IPCW) and two-stage estimation (TSE) have often been used to adjust for switching to inform treatment reimbursement policy decisions. TSE has been applied using a simple approach (TSEsimp), assuming no time-dependent confounding between the time of disease progression and the time of switch. This is problematic if there is a delay between progression and switch. In this paper we introduce TSEgest, which uses structural nested models and g-estimation to account for time-dependent confounding, and compare it to TSEsimp, RPSFTM and IPCW. We simulated scenarios where control group patients could switch onto the experimental treatment with and without time-dependent confounding being present. We varied switching proportions, treatment effects and censoring proportions. We assessed adjustment methods according to their estimation of control group restricted mean survival times that would have been observed in the absence of switching. All methods performed well in scenarios with no time-dependent confounding. TSEgest and RPSFTM continued to perform well in scenarios with time-dependent confounding, but TSEsimp resulted in substantial bias. IPCW also performed well in scenarios with time-dependent confounding, except when inverse probability weights were high in relation to the size of the group being subjected to weighting, which occurred when there was a combination of modest sample size and high switching proportions. TSEgest represents a useful addition to the collection of methods that may be used to adjust for treatment switching in trials in order to address policy-relevant questions.</p>
              </abstract>
              <kwd-group>
                <kwd>Treatment switching</kwd>
                <kwd>treatment crossover</kwd>
                <kwd>survival analysis</kwd>
                <kwd>overall survival</kwd>
                <kwd>oncology</kwd>
                <kwd>health technology assessment</kwd>
                <kwd>time-to-event outcomes</kwd>
                <kwd>prediction</kwd>
                <kwd>time-dependent confounding</kwd>
                <kwd>structural nested models</kwd>
                <kwd>g-estimation</kwd>
                <kwd>counterfactual</kwd>
              </kwd-group>
              <funding-group>
                <award-group id="award1-0962280220912524">
                  <funding-source id="funding1-0962280220912524">
                    <institution-wrap>
                      <institution>Research Trainees Coordinating Centre</institution>
                      <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100000659</institution-id>
                    </institution-wrap>
                  </funding-source>
                  <award-id rid="funding1-0962280220912524">PDF-2015-08-022</award-id>
                </award-group>
                <award-group id="award2-0962280220912524">
                  <funding-source id="funding2-0962280220912524">
                    <institution-wrap>
                      <institution>Medical Research Council</institution>
                      <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100000265</institution-id>
                    </institution-wrap>
                  </funding-source>
                  <award-id rid="funding2-0962280220912524">MC_UU_00011/3</award-id>
                  <award-id rid="funding2-0962280220912524">MC_UU_12023/21</award-id>
                </award-group>
                <award-group id="award3-0962280220912524">
                  <funding-source id="funding3-0962280220912524">
                    <institution-wrap>
                      <institution>COMET Center ONCOTYROL </institution>
                    </institution-wrap>
                  </funding-source>
                  <award-id rid="funding3-0962280220912524">2073085</award-id>
                </award-group>
                <award-group id="award4-0962280220912524">
                  <funding-source id="funding4-0962280220912524">
                    <institution-wrap>
                      <institution>Yorkshire Cancer Research</institution>
                      <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100002653</institution-id>
                    </institution-wrap>
                  </funding-source>
                  <award-id rid="funding4-0962280220912524">S406NL</award-id>
                </award-group>
              </funding-group>
              <custom-meta-group>
                <custom-meta>
                  <meta-name>typesetter</meta-name>
                  <meta-value>ts2</meta-value>
                </custom-meta>
              </custom-meta-group>
            </article-meta>
          </front>
          <body>
            <sec sec-type="intro" id="sec1-0962280220912524">
              <title>1 Introduction</title>
              <p>In recent times there has been considerable interest in methods that allow treatment effects to be estimated adjusting for treatment changes that occur in randomised controlled trials (RCTs).<sup><xref rid="bibr1-0962280220912524" ref-type="bibr">1</xref><xref rid="bibr2-0962280220912524" ref-type="bibr"/><xref rid="bibr3-0962280220912524" ref-type="bibr"/><xref rid="bibr4-0962280220912524" ref-type="bibr"/><xref rid="bibr5-0962280220912524" ref-type="bibr"/><xref rid="bibr6-0962280220912524" ref-type="bibr"/>–<xref rid="bibr7-0962280220912524" ref-type="bibr">7</xref></sup> Treatment pathways observed in RCTs often do not reflect those that would be observed in reality, and therefore intention to treat (ITT) analyses may not address the question of interest. For instance, in clinical trials of new oncology therapies, patients who are randomised to the control group are often permitted to switch onto the experimental treatment during the trial, usually after disease progression. In such circumstances, the ITT analysis provides an estimate of the effect of immediate compared to deferred experimental treatment. An alternative estimand might consider the effectiveness of immediate experimental treatment compared to no experimental treatment. This is particularly important in health technology assessment (HTA), where the objective is usually to identify whether inserting a new treatment into the treatment pathway at the line of therapy designated by its licence represents an effective and cost-effective use of healthcare resources, compared to retaining the existing treatment pathway. In HTA, treatment benefits are usually summarised using estimates of mean (quality adjusted) survival advantages.<sup><xref rid="bibr8-0962280220912524" ref-type="bibr">8</xref><xref rid="bibr9-0962280220912524" ref-type="bibr"/><xref rid="bibr10-0962280220912524" ref-type="bibr"/>–<xref rid="bibr11-0962280220912524" ref-type="bibr">11</xref></sup></p>
              <p>Treatment changes are to be expected in any clinical trial. If these changes reflect what would happen in practice, it is not necessary to make adjustments to enable appropriate HTA decision making. However, switching from the control group onto the experimental treatment does cause a problem. If the HTA decision maker does not recommend a new treatment it will not be available in the health system. The HTA decision problem involves a comparison of a world in which the new treatment exists (and is given at its licensed line of therapy) to a world in which the new treatment does not exist at all. Therefore, if patients randomised to the control group of an RCT are permitted to receive the experimental treatment at some point during the trial, the observed treatment pathway is not relevant for the HTA decision problem.</p>
              <p>This is illustrated in <xref ref-type="fig" rid="fig1-0962280220912524">Figure 1</xref>. The horizontal axis represents survival time, consisting of progression-free survival (PFS) and post-progression survival (PPS). Rows 1 and 2 illustrate what we would ideally observe in an RCT. Row 1 (the upper row) illustrates survival in the control group in the absence of any switching onto the experimental treatment, and Row 2 (the middle row) illustrates survival in the experimental group. However, when control group patients are permitted to switch onto the experimental treatment at the point of disease progression, we observe Row 3 (the bottom row) and not Row 1. If switching occurs, an ITT analysis provides an estimate of the difference between Row 2 and Row 3. In contrast, the HTA decision maker is likely to require an estimate of the difference between Row 2 and Row 1 – comparing a world where the experimental treatment exists to one where it does not. Therefore, the ITT analysis does not address the HTA decision problem; an analysis that adjusts for treatment switching is needed such that Row 2 can be compared to an estimated Row 1.</p>
              <fig id="fig1-0962280220912524" orientation="portrait" position="float">
                <label>Figure 1.</label>
                <caption>
                  <p>Illustrating treatment switching – switching immediately upon disease progression. PFS: progression-free survival; PPS: post-progression survival; OS: overall survival; ITT: intention-to-treat.Adapted from [1] with permission of SAGE publications.</p>
                </caption>
                <graphic xlink:href="10.1177_0962280220912524-fig1"/>
              </fig>
              <p>Research on methods for adjusting for treatment switching in an RCT context have focussed on rank preserving structural failure time models (RPSFTM), inverse probability of censoring weights (IPCW) and two-stage estimation (TSE).<sup><xref rid="bibr1-0962280220912524" ref-type="bibr">1</xref><xref rid="bibr2-0962280220912524" ref-type="bibr"/><xref rid="bibr3-0962280220912524" ref-type="bibr"/><xref rid="bibr4-0962280220912524" ref-type="bibr"/><xref rid="bibr5-0962280220912524" ref-type="bibr"/><xref rid="bibr6-0962280220912524" ref-type="bibr"/>–<xref rid="bibr7-0962280220912524" ref-type="bibr">7</xref>,<xref rid="bibr12-0962280220912524" ref-type="bibr">12</xref><xref rid="bibr13-0962280220912524" ref-type="bibr"/>–<xref rid="bibr14-0962280220912524" ref-type="bibr">14</xref></sup> These methods have been included in analyses used to make reimbursement decisions on new cancer drugs around the world.<sup><xref rid="bibr5-0962280220912524" ref-type="bibr">5</xref></sup> When attempting to adjust analyses to account for treatment switches that occur over time, the key difficulty is time-dependent confounding.<sup><xref rid="bibr15-0962280220912524" ref-type="bibr">15</xref></sup> If a variable influences the treatment switch decision, is prognostic for the outcome of interest (such as survival), and is itself affected by treatment, it is a time-dependent confounder for the effect of treatment on outcome. The RPSFTM and IPCW approaches originate in the causal inference literature and, provided their assumptions hold, are able to provide unbiased adjusted treatment effects in the presence of time-dependent confounding.<sup><xref rid="bibr16-0962280220912524" ref-type="bibr">16</xref><xref rid="bibr17-0962280220912524" ref-type="bibr"/>–<xref rid="bibr18-0962280220912524" ref-type="bibr">18</xref></sup> In contrast, the TSE method uses a simple estimation procedure and is only appropriate when switching occurs after a specific disease-related time-point, referred to as a “secondary baseline”, such as disease progression.<sup><xref rid="bibr12-0962280220912524" ref-type="bibr">12</xref></sup> The first stage of the method requires the post-secondary-baseline treatment effect in switchers to be estimated, but the method does not adjust for any time-dependent confounding that may occur between the secondary baseline and the time of switch. This may be reasonable when switching occurs either at or very soon after the secondary baseline (as depicted in <xref ref-type="fig" rid="fig1-0962280220912524">Figure 1</xref>), but if there is an appreciable gap between the secondary baseline and the time of switch (as depicted in <xref ref-type="fig" rid="fig2-0962280220912524">Figure 2</xref>), the TSE method may become biased.</p>
              <fig id="fig2-0962280220912524" orientation="portrait" position="float">
                <label>Figure 2.</label>
                <caption>
                  <p>Illustrating treatment switching – switching sometime after disease progression. PFS: progression-free survival; PPS: post-progression survival; OS: overall survival; ITT: intention-to-treat.</p>
                </caption>
                <graphic xlink:href="10.1177_0962280220912524-fig2"/>
              </fig>
              <p>To illustrate this, first consider a simple case where switching can only occur immediately upon disease progression. Consider an RCT investigating the effectiveness of an experimental adjuvant treatment for non-metastatic cancer, in which switching from the control group onto the experimental treatment is permitted at the point of disease progression. The TSE method would estimate the effect of switching by comparing post-progression survival in control group switchers and non-switchers, adjusting for differences between switchers and non-switchers at the point of disease progression. The directed acyclic graph (DAG)<sup><xref rid="bibr19-0962280220912524" ref-type="bibr">19</xref></sup> presented in <xref ref-type="fig" rid="fig3-0962280220912524">Figure 3</xref> illustrates the post-progression period for control group patients in this example. Upon disease progression, the decision as to whether or not a patient switches treatment (denoted by <inline-formula id="ilm1-0962280220912524"><mml:math id="mml-math1-0962280220912524"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> in <xref ref-type="fig" rid="fig3-0962280220912524">Figure 3</xref>) is dependent on prognostic characteristics measured either at or before the time of disease progression (labelled <inline-formula id="ilm2-0962280220912524"><mml:math id="mml-math2-0962280220912524"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi> </mml:mi></mml:math></inline-formula>in <xref ref-type="fig" rid="fig3-0962280220912524">Figure 3</xref>). Let us assume that receiving treatment prolongs survival (<italic>Y</italic>) and affects the probability of metastatic disease developing at a later time-point (<inline-formula id="ilm3-0962280220912524"><mml:math id="mml-math3-0962280220912524"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> in <xref ref-type="fig" rid="fig3-0962280220912524">Figure 3</xref>). Note that in this example (and throughout this paper), we consider a case where disease progression is distinct from metastatic disease – first, disease progression may occur (as measured, for example, by an increase in tumour size) and subsequently the disease may become metastatic. <inline-formula id="ilm4-0962280220912524"><mml:math id="mml-math4-0962280220912524"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> has a direct effect on <italic>Y</italic>, and also an indirect effect through <inline-formula id="ilm5-0962280220912524"><mml:math id="mml-math5-0962280220912524"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>. In this case, an analyst using the TSE method to estimate the effect of <inline-formula id="ilm6-0962280220912524"><mml:math id="mml-math6-0962280220912524"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> on <italic>Y</italic> can simply adjust for <inline-formula id="ilm7-0962280220912524"><mml:math id="mml-math7-0962280220912524"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>. <inline-formula id="ilm8-0962280220912524"><mml:math id="mml-math8-0962280220912524"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is not a confounder because it is not a cause of <inline-formula id="ilm9-0962280220912524"><mml:math id="mml-math9-0962280220912524"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and therefore does not need to be adjusted for in the analysis.</p>
              <fig id="fig3-0962280220912524" orientation="portrait" position="float">
                <label>Figure 3.</label>
                <caption>
                  <p>Directed acyclic graph illustrating post-progression switching with no time-dependent confounding.</p>
                </caption>
                <graphic xlink:href="10.1177_0962280220912524-fig3"/>
              </fig>
              <p>Next, consider a more complex case, where switching can occur either at the point of disease progression or at an additional time-point thereafter (<inline-formula id="ilm10-0962280220912524"><mml:math id="mml-math10-0962280220912524"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>). The DAG presented in <xref ref-type="fig" rid="fig4-0962280220912524">Figure 4</xref> illustrates the post-progression period for control group patients in this case. Upon disease progression, the decision as to whether or not a patient switches treatment (<inline-formula id="ilm11-0962280220912524"><mml:math id="mml-math11-0962280220912524"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> is again dependent on prognostic characteristics measured at or before the time of disease progression (<inline-formula id="ilm12-0962280220912524"><mml:math id="mml-math12-0962280220912524"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>). Again receiving treatment prolongs survival (<italic>Y</italic>) and affects the probability of metastatic disease developing at a later time-point (<inline-formula id="ilm13-0962280220912524"><mml:math id="mml-math13-0962280220912524"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>) but in this case developing metastatic disease affects the clinician’s decision as to whether or not a patient should subsequently change treatments (<inline-formula id="ilm14-0962280220912524"><mml:math id="mml-math14-0962280220912524"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>). In this case, an analyst using the TSE method to estimate the effect of switching must decide whether to include the occurrence of metastatic disease (<inline-formula id="ilm15-0962280220912524"><mml:math id="mml-math15-0962280220912524"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>) as a time-varying covariate in their statistical model. If they do not, the estimate of the treatment effect will be biased because patients who switch treatment have a different prognosis to those who do not switch – this is known as confounding by indication,<sup><xref rid="bibr15-0962280220912524" ref-type="bibr">15</xref></sup> and in <xref ref-type="fig" rid="fig4-0962280220912524">Figure 4</xref> is illustrated by the open backdoor path from <inline-formula id="ilm16-0962280220912524"><mml:math id="mml-math16-0962280220912524"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>←</mml:mo><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:mi>Y</mml:mi></mml:math></inline-formula>. However, including metastatic disease as a time-varying covariate will also result in biased estimates of the treatment effect because part of the treatment effect occurs through reducing the likelihood of metastatic disease (the causal path from <inline-formula id="ilm17-0962280220912524"><mml:math id="mml-math17-0962280220912524"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:mi>Y</mml:mi></mml:math></inline-formula> would be blocked). In this example, <inline-formula id="ilm18-0962280220912524"><mml:math id="mml-math18-0962280220912524"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is a time-dependent confounder. The TSE method would produce biased estimates of the treatment effect because simple regression adjustment cannot deal with time-dependent confounders.</p>
              <fig id="fig4-0962280220912524" orientation="portrait" position="float">
                <label>Figure 4.</label>
                <caption>
                  <p>Directed acyclic graph illustrating post-progression switching with time-dependent confounding.</p>
                </caption>
                <graphic xlink:href="10.1177_0962280220912524-fig4"/>
              </fig>
              <p>It is possible to apply the TSE method using a more sophisticated estimation procedure (g-estimation) in order to obtain unbiased estimates in the presence of time-dependent confounding. Previous research attempted to assess such a technique, but found that it did not work well in realistic simulated scenarios – the method often failed to converge and frequently resulted in high levels of bias.<sup><xref rid="bibr12-0962280220912524" ref-type="bibr">12</xref></sup> In this paper, we re-visit this. We improved the statistical program used to apply the method (stgest, for use in Stata<sup><xref rid="bibr20-0962280220912524" ref-type="bibr">20</xref></sup>) – principally by improving the g-estimation algorithm used – and tested this in a simulation study including scenarios with and without time-dependent confounding. Our aims were to develop and assess a version of the TSE method that is capable of adjusting for time-dependent confounding and to compare this to alternative adjustment methods in a range of scenarios. We focus on the problem typically seen in HTA,<sup><xref rid="bibr1-0962280220912524" ref-type="bibr">1</xref><xref rid="bibr2-0962280220912524" ref-type="bibr"/><xref rid="bibr3-0962280220912524" ref-type="bibr"/><xref rid="bibr4-0962280220912524" ref-type="bibr"/><xref rid="bibr5-0962280220912524" ref-type="bibr"/><xref rid="bibr6-0962280220912524" ref-type="bibr"/>–<xref rid="bibr7-0962280220912524" ref-type="bibr">7</xref>,<xref rid="bibr21-0962280220912524" ref-type="bibr">21</xref>,<xref rid="bibr22-0962280220912524" ref-type="bibr">22</xref></sup> whereby a subset of control group patients switch onto the experimental treatment after disease progression and we wish to estimate what survival would have been in the control group as a whole if this switching had not occurred.</p>
            </sec>
            <sec sec-type="methods" id="sec2-0962280220912524">
              <title>2 Methods</title>
              <p>In this section, we first describe the TSE method using simple estimation (denoted TSEsimp) and using g-estimation (TSEgest). We also summarise RPSFTM and IPCW, because these represent relevant comparator methods that can control for time-dependent confounding. We then describe the design of our simulation study.</p>
              <sec id="sec3-0962280220912524">
                <title>2.1 Adjustment methods</title>
                <p><xref ref-type="boxed-text" rid="boxed-text1">Box 1</xref> summarises the key assumptions used by each of the adjustment methods, in our context. We assume that switching is not a problem in the experimental group (that is, we only address switches from the control group onto the experimental treatment, not switches in the opposite direction). Below we provide more detail on each adjustment method, organised by concept, assumptions and modelling approach.<boxed-text id="boxed-text1" position="float" orientation="portrait"><label>Box 1</label><caption><p>Key assumptions of TSEsimp, TSEgest, IPCW and RPSFTM for estimating unbiased treatment effects in the presence of treatment switching.</p></caption><table-wrap id="table2-0962280220912524" orientation="portrait" position="float"><alternatives><graphic xlink:href="10.1177_0962280220912524-table2"/><table frame="hsides" rules="groups"><tbody valign="top"><tr><td rowspan="1" colspan="1">TSEsimp<italic>Assumptions</italic> – Switching at or after a disease-related secondary baseline time-point – From the point of the secondary baseline, independence between switch status and potential outcomes, conditional on variables measured at or before the secondary baseline time-point (i.e. no unmeasured confounding) – If switching happens after the secondary baseline, no time-dependent confounding between secondary baseline and time of switch (i.e. post-secondary-baseline values of prognostic variables do not influence the probability of switch)<italic>Model specification</italic> – Correctly specified model for effect of switching on survival time – Correctly specified outcomes model</td></tr><tr><td rowspan="1" colspan="1">TSEgest<italic>Assumptions</italic> – From the point of the secondary baseline, independence between switch status and potential outcomes, conditional on variables measured at or before, and after the secondary baseline time-point (i.e. no unmeasured confounding)<italic>Model specification</italic> – Correctly specified model for switching – Correctly specified model for counterfactual survival – Correctly specified outcomes model – Note: can be applied without a secondary baseline, with the resulting assumption:Independence between switch status and potential outcomes, conditional on variables measured at baseline and over time (i.e. no unmeasured confounding)</td></tr><tr><td rowspan="1" colspan="1">IPCW<italic>Assumptions</italic> – Independence between switch status and potential outcomes, conditional on variables measured in unswitched observations (i.e. no unmeasured confounding)<italic>Model specification</italic> – Correctly specified model for switching  – Correctly specified outcomes model – Not applicable if there are any covariates which ensure that switching will occur</td></tr><tr><td rowspan="1" colspan="1">RPSFTM<italic>Assumptions</italic> – Independence between randomised groups and potential outcomes – Common treatment effect in all treated patients<italic>Model specification</italic> – Correctly specified model for counterfactual survival – Correctly specified outcomes model</td></tr></tbody></table></alternatives></table-wrap></boxed-text></p>
                <sec id="sec4-0962280220912524">
                  <title>2.1.1 Two-stage estimation – simple approach</title>
                  <sec id="sec5-0962280220912524">
                    <title>2.1.1.1 TSEsimp – concept</title>
                    <p>As previously described, TSE is designed to adjust for switching that occurs after a specific disease-related time-point, referred to as a “secondary baseline”.<sup><xref rid="bibr12-0962280220912524" ref-type="bibr">12</xref></sup> The TSE method involves first estimating the effect associated with switching treatments and then using this estimated effect to derive counterfactual survival times for switchers – those that would have been observed if switching had not occurred.</p>
                  </sec>
                  <sec id="sec6-0962280220912524">
                    <title>2.1.1.2 TSEsimp – assumptions</title>
                    <p>The simple TSE approach, TSEsimp, relies on three assumptions (see <xref ref-type="boxed-text" rid="boxed-text1">Box 1</xref>):<sup><xref rid="bibr12-0962280220912524" ref-type="bibr">12</xref></sup> (i) Switching must only occur at or after a disease-related secondary baseline time-point; (ii) from the point of the secondary baseline, switching is independent of potential outcomes, conditional on variables measured at or before the secondary baseline time-point, and; (iii) if switching happens after the secondary baseline, there must be no time-dependent confounding between the secondary baseline time-point and the time of switch – that is, post-secondary baseline values of prognostic variables must not influence the probability of switching. Essentially, there must be no confounding that is not accounted for in the TSEsimp model used to estimate the effect of switching. This is referred to as no unmeasured confounding, where a confounder is a variable that influences the treatment decision and is prognostic for the outcome of interest (i.e. survival).</p>
                  </sec>
                  <sec id="sec7-0962280220912524">
                    <title>2.1.1.3 TSEsimp – modelling approach</title>
                    <p>TSEsimp involves a model for the effect of treatment switching on survival time and an outcomes model, which may be used to estimate the effect of the intervention on survival using the estimated survival times from the adjustment procedure. These models must be correctly specified in order for TSEsimp to provide appropriate estimates of the effect of being randomised to experimental treatment adjusted for treatment switching (see <xref ref-type="boxed-text" rid="boxed-text1">Box 1</xref>).</p>
                    <p>A standard parametric accelerated failure time model (e.g. Weibull or Generalised Gamma) is used to estimate the effect of switching on survival time.<sup><xref rid="bibr12-0962280220912524" ref-type="bibr">12</xref></sup> Post-secondary-baseline survival times in control group switchers are compared to those in control group non-switchers. The model includes covariates for prognostic characteristics measured at the secondary baseline time-point or before in an attempt to account for potential prognostic differences between switchers and non-switchers, and a switching variable which equals ‘1’ after the time of switch. The model provides an estimate of the treatment effect associated with switching in the form of a time-ratio, representing a multiplicative factor by which an individual’s expected survival time is increased (or decreased) by being on the treatment switched to, referred to as<inline-formula id="ilm19-0962280220912524"><mml:math id="mml-math19-0962280220912524"><mml:mi> </mml:mi><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>.</p>
                    <p>The inverse of the treatment effect, i.e. <inline-formula id="ilm20-0962280220912524"><mml:math id="mml-math20-0962280220912524"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, is then used to estimate counterfactual survival times (<inline-formula id="ilm21-0962280220912524"><mml:math id="mml-math21-0962280220912524"><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) for switchers. This implies using the causal interpretation of the model used to estimate the effect of treatment switching on survival times. The model assumes that treatment has a multiplicative effect on survival time and splits the observed event time, <inline-formula id="ilm22-0962280220912524"><mml:math id="mml-math22-0962280220912524"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, for each patient into time spent on the control treatment, <inline-formula id="ilm23-0962280220912524"><mml:math id="mml-math23-0962280220912524"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and time spent on the experimental treatment, <inline-formula id="ilm24-0962280220912524"><mml:math id="mml-math24-0962280220912524"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. For control group switchers, <inline-formula id="ilm25-0962280220912524"><mml:math id="mml-math25-0962280220912524"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is equal to the time from randomisation until switching occurs, and <inline-formula id="ilm26-0962280220912524"><mml:math id="mml-math26-0962280220912524"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is equal to the time from switch until death or censoring. For non-switchers in the control group, <inline-formula id="ilm27-0962280220912524"><mml:math id="mml-math27-0962280220912524"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:math></inline-formula> The structural model for counterfactual survival times is therefore specified as follows:
<disp-formula id="disp-formula1-0962280220912524"><label>(1)</label><alternatives><mml:math id="math1-0962280220912524"><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="10.1177_0962280220912524-eq1.jpg" position="float" orientation="portrait"/></alternatives></disp-formula></p>
                    <p>Using <xref ref-type="disp-formula" rid="disp-formula1-0962280220912524">equation (1)</xref>, survival times are estimated for switching patients under a counterfactual scenario where they did not switch. For each switcher, values for <inline-formula id="ilm28-0962280220912524"><mml:math id="mml-math28-0962280220912524"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="ilm29-0962280220912524"><mml:math id="mml-math29-0962280220912524"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are plugged into <xref ref-type="disp-formula" rid="disp-formula1-0962280220912524">equation (1)</xref>, along with the estimate of <inline-formula id="ilm30-0962280220912524"><mml:math id="mml-math30-0962280220912524"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> taken from the parametric accelerated failure time model used to estimate the effect of switching on survival time. Thereby, counterfactual survival times are estimated for switchers. In the absence of censoring, the adjustment for treatment switching is complete. However, if censoring is present, an additional step called “re-censoring” is required.<sup><xref rid="bibr23-0962280220912524" ref-type="bibr">23</xref><xref rid="bibr24-0962280220912524" ref-type="bibr"/>–<xref rid="bibr25-0962280220912524" ref-type="bibr">25</xref></sup> For switchers who are not observed to die, the model for counterfactual survival times results in a shrunken censoring time (assuming the treatment is beneficial). If switching is related to prognostic factors, shrinking censoring times in switchers (and not in non-switchers) will result in informative censoring because censoring times will be related to prognosis. Re-censoring breaks the dependence between the counterfactual censoring time and treatment received.<sup><xref rid="bibr23-0962280220912524" ref-type="bibr">23</xref><xref rid="bibr24-0962280220912524" ref-type="bibr"/>–<xref rid="bibr25-0962280220912524" ref-type="bibr">25</xref></sup> The counterfactual survival time associated with a given value of <inline-formula id="ilm31-0962280220912524"><mml:math id="mml-math31-0962280220912524"><mml:mi>ψ</mml:mi></mml:math></inline-formula> (that is, <inline-formula id="ilm32-0962280220912524"><mml:math id="mml-math32-0962280220912524"><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>ψ</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>) is re-censored for <italic>all</italic> patients in the treatment group in which switching occurs at the minimum of the administrative censoring time <inline-formula id="ilm33-0962280220912524"><mml:math id="mml-math33-0962280220912524"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="ilm34-0962280220912524"><mml:math id="mml-math34-0962280220912524"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, representing the earliest possible censoring time over all possible treatment trajectories, <inline-formula id="ilm35-0962280220912524"><mml:math id="mml-math35-0962280220912524"><mml:msubsup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msubsup><mml:mfenced separators="|"><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>. <inline-formula id="ilm36-0962280220912524"><mml:math id="mml-math36-0962280220912524"><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>ψ</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> is then replaced by <inline-formula id="ilm37-0962280220912524"><mml:math id="mml-math37-0962280220912524"><mml:msubsup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msubsup><mml:mfenced separators="|"><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> if <inline-formula id="ilm38-0962280220912524"><mml:math id="mml-math38-0962280220912524"><mml:msubsup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msubsup><mml:mfenced separators="|"><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow></mml:mfenced><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>ψ</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>. Re-censoring results in a loss of longer term information, which can be problematic if the aim is to estimate long-term treatment effects – this is discussed elsewhere.<sup><xref rid="bibr26-0962280220912524" ref-type="bibr">26</xref></sup></p>
                    <p>After estimating untreated survival times for switchers and undertaking re-censoring if required, a new dataset is derived consisting of a mixture of observed (for non-switchers) and adjusted (for switchers) survival times. This dataset may be used to compare experimental and control group survival times using any outcomes model, to estimate the effect of experimental treatment adjusted for treatment switching. For instance, a Cox proportional hazards model might be used to estimate a hazard ratio.<sup><xref rid="bibr27-0962280220912524" ref-type="bibr">27</xref></sup> Confidence intervals produced by the outcomes model will be inappropriate because they do not take into account that survival times have been adjusted in switchers – bootstrapping the entire adjustment process is recommended to appropriately characterise uncertainty.<sup><xref rid="bibr1-0962280220912524" ref-type="bibr">1</xref>,<xref rid="bibr12-0962280220912524" ref-type="bibr">12</xref></sup></p>
                  </sec>
                  <sec id="sec8-0962280220912524">
                    <title>2.1.1.4 TSEsimp – a variation</title>
                    <p>TSEsimp relies upon simple regression and does not attempt to adjust for time-dependent confounders. A variation of this approach is to include time-dependent variables in the simple regression model used to estimate the effect of switching. For reasons previously described and illustrated in <xref ref-type="fig" rid="fig4-0962280220912524">Figure 4</xref>, this approach is prone to bias. However, in order to highlight the inadequacies of using simple regression adjustment to control for time-dependent confounding, we include this approach in this study, denoted TSEsimpTDC.</p>
                  </sec>
                </sec>
                <sec id="sec9-0962280220912524">
                  <title>2.1.2 Two-stage Estimation – g-estimation approach</title>
                  <sec id="sec10-0962280220912524">
                    <title>2.1.2.1 TSEgest – concept</title>
                    <p>Through its use of g-estimation and a structural nested model (SNM), TSEgest allows the assumptions of TSEsimp to be relaxed because it is capable of dealing with time-dependent confounding, provided its own assumptions hold.<sup><xref rid="bibr20-0962280220912524" ref-type="bibr">20</xref>,<xref rid="bibr28-0962280220912524" ref-type="bibr">28</xref>,<xref rid="bibr29-0962280220912524" ref-type="bibr">29</xref></sup> Importantly, the method does not even require that a secondary baseline exists – for instance, it is applicable if switching happens before or after disease progression. However, in this study we are interested in a situation where switching only happens at or beyond disease progression. In this context, where the risk of switching is zero before progression, it is reasonable to apply TSEgest using disease progression as a secondary baseline. We describe TSEgest in this setting, in which it involves the same concept as TSEsimp – a treatment effect associated with treatment switching is estimated which is then used in a counterfactual survival model to estimate untreated survival times for switchers.</p>
                  </sec>
                  <sec id="sec11-0962280220912524">
                    <title>2.1.2.2 TSEgest – assumptions</title>
                    <p>TSEgest involves modelling switching and relies on one key assumption (see <xref ref-type="boxed-text" rid="boxed-text1">Box 1</xref>):<sup><xref rid="bibr29-0962280220912524" ref-type="bibr">29</xref></sup> switching is independent of potential outcomes, conditional on measured variables – that is, there is no unmeasured confounding. It is not a problem if post-secondary-baseline values of prognostic variables influence the probability of switch, provided those variables are measured and included in the analysis.</p>
                  </sec>
                  <sec id="sec12-0962280220912524">
                    <title>2.1.2.3 TSEgest – modelling approach</title>
                    <p>TSEgest involves a model for switching, a counterfactual survival model, and an outcomes model. Each of these models must be correctly specified in order for TSEgest to provide appropriate estimates of the effect of being randomised to experimental treatment adjusted for treatment switching (see <xref ref-type="boxed-text" rid="boxed-text1">Box 1</xref>).</p>
                    <p>The switching model is used in combination with g-estimation to estimate <inline-formula id="ilm39-0962280220912524"><mml:math id="mml-math39-0962280220912524"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, that is, the treatment effect associated with switching in the form of a time-ratio also used by TSEsimp. The no unmeasured confounding assumption means that switching at each measurement occasion is independent of counterfactual survival times <inline-formula id="ilm40-0962280220912524"><mml:math id="mml-math40-0962280220912524"><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, conditional on measured variables.<sup><xref rid="bibr20-0962280220912524" ref-type="bibr">20</xref></sup> The switching model therefore relates treatment at each measurement observation to counterfactual survival time given a specific value for <italic>ψ,</italic> controlling for all confounders and the g-estimation procedure searches for the value of <italic>ψ</italic> that results in independence between switch status and <inline-formula id="ilm41-0962280220912524"><mml:math id="mml-math41-0962280220912524"><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. For instance, from Sterne and Tilling<sup><xref rid="bibr20-0962280220912524" ref-type="bibr">20</xref></sup>
<disp-formula id="disp-formula2-0962280220912524"><label>(2)</label><alternatives><mml:math id="math2-0962280220912524"><mml:mi>logit</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>p</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math><graphic xlink:href="10.1177_0962280220912524-eq2.jpg" position="float" orientation="portrait"/></alternatives></disp-formula>where <inline-formula id="ilm42-0962280220912524"><mml:math id="mml-math42-0962280220912524"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is observed switch status for individual <italic>i</italic> at observation <italic>k</italic>, <inline-formula id="ilm43-0962280220912524"><mml:math id="mml-math43-0962280220912524"><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the counterfactual survival time for individual <italic>i</italic> given a specific value for <italic>ψ</italic>, and <inline-formula id="ilm44-0962280220912524"><mml:math id="mml-math44-0962280220912524"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are all confounders for individual <italic>i</italic> at observation <italic>k</italic>. If TSEgest is applied from a secondary baseline, <inline-formula id="ilm45-0962280220912524"><mml:math id="mml-math45-0962280220912524"><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> refers to post-secondary-baseline counterfactual survival; the structure of the counterfactual survival model used to estimate this is the same as in (1), but <inline-formula id="ilm46-0962280220912524"><mml:math id="mml-math46-0962280220912524"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> refers to the time spent after the secondary baseline on control treatment, and <inline-formula id="ilm47-0962280220912524"><mml:math id="mml-math47-0962280220912524"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> refers to the time spent after the secondary baseline on the experimental treatment. The switching model and the post-secondary-baseline counterfactual survival model are used simultaneously to provide the g-estimate of <inline-formula id="ilm48-0962280220912524"><mml:math id="mml-math48-0962280220912524"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>.</p>
                    <p>The g-estimation procedure involves fitting a series of models defined by (2) for a range of values of <italic>ψ,</italic> searching for the value of <italic>ψ</italic> (the “g-estimate”) for which switch status at each measurement occasion is independent of <inline-formula id="ilm49-0962280220912524"><mml:math id="mml-math49-0962280220912524"><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. This assessment is based on a test statistic for <italic>α</italic> in <xref ref-type="disp-formula" rid="disp-formula2-0962280220912524">equation (2)</xref> that is zero (that is, the P-value is 1), meaning that there is no association between current treatment and <inline-formula id="ilm50-0962280220912524"><mml:math id="mml-math50-0962280220912524"><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. Typically a Wald statistic is used.<sup><xref rid="bibr20-0962280220912524" ref-type="bibr">20</xref></sup> The upper and lower limits of the 95% confidence interval for <italic>ψ</italic> are the two values for which the two-sided <italic>P</italic>-values for the test statistic of <italic>α</italic> are 0.05.</p>
                    <p>Once <italic>ψ</italic> has been identified, it is used in <xref ref-type="disp-formula" rid="disp-formula1-0962280220912524">equation (1)</xref> to estimate counterfactual survival times for patients who switched treatments, as in TSEsimp, resulting in a new dataset consisting of a mixture of observed and unobserved survival times. When censoring is present, re-censoring is required. Then, an outcomes model is used to estimate the effect of experimental treatment adjusted for treatment switching. Again, bootstrapping of the entire adjustment process is required to appropriately characterise uncertainty.</p>
                  </sec>
                </sec>
                <sec id="sec13-0962280220912524">
                  <title>2.1.3 Inverse probability of censoring weights</title>
                  <sec id="sec14-0962280220912524">
                    <title>2.1.3.1 IPCW – concept</title>
                    <p>IPCW can be used to adjust for treatment switching and can cope with time-dependent confounders. IPCW involves censoring patients at the time of switch but then weighting remaining observations using information on baseline and time-dependent patient characteristics to avoid the selection bias associated with the censoring.<sup><xref rid="bibr1-0962280220912524" ref-type="bibr">1</xref>,<xref rid="bibr18-0962280220912524" ref-type="bibr">18</xref></sup></p>
                  </sec>
                  <sec id="sec15-0962280220912524">
                    <title>2.1.3.2 IPCW – assumptions</title>
                    <p>IPCW involves modelling the switching process and is reliant on one key assumption (see <xref ref-type="boxed-text" rid="boxed-text1">Box 1</xref>): that there is no unmeasured confounding.<sup><xref rid="bibr1-0962280220912524" ref-type="bibr">1</xref>,<xref rid="bibr18-0962280220912524" ref-type="bibr">18</xref>,<xref rid="bibr29-0962280220912524" ref-type="bibr">29</xref></sup> The definition of a confounder is the same as for the TSE methods – that is, a variable that influences the probability of switching and is prognostic for survival. Therefore, data must be available on all such variables.<sup><xref rid="bibr30-0962280220912524" ref-type="bibr">30</xref>,<xref rid="bibr31-0962280220912524" ref-type="bibr">31</xref></sup></p>
                  </sec>
                  <sec id="sec16-0962280220912524">
                    <title>2.1.3.3 IPCW – modelling approach</title>
                    <p>IPCW involves a switching model and an outcomes model. The switching model is used to estimate weights, which are then used in the outcomes model to estimate a treatment effect adjusted for treatment switching. These models must both be correctly specified in order for IPCW to provide unbiased estimates of the effect of being randomised to experimental treatment, adjusted for treatment switching (see <xref ref-type="boxed-text" rid="boxed-text1">Box 1</xref>). The method is not applicable if there are any covariate patterns which ensure (i.e. the probability equals 1) that treatment switching will occur.<sup><xref rid="bibr18-0962280220912524" ref-type="bibr">18</xref>,<xref rid="bibr31-0962280220912524" ref-type="bibr">31</xref>,<xref rid="bibr32-0962280220912524" ref-type="bibr">32</xref></sup></p>
                    <p>IPCW is often applied working in discrete time, dividing follow-up into small intervals and using pooled logistic regression.<sup><xref rid="bibr18-0962280220912524" ref-type="bibr">18</xref></sup> First, a model for switching is fitted, controlling for all baseline and time-varying confounders. This model is used to estimate the probability of switching for each individual in each interval. An individual’s probabilities of remaining unswitched up to interval <italic>t</italic> are then multiplied together, with the weight representing the inverse probability of remaining unswitched up to interval <italic>t</italic>. These weights can be highly variable, decreasing statistical efficiency,<sup><xref rid="bibr33-0962280220912524" ref-type="bibr">33</xref></sup> and therefore stabilised weights are often used instead<sup><xref rid="bibr18-0962280220912524" ref-type="bibr">18</xref></sup>
<disp-formula id="disp-formula3-0962280220912524"><label>(3)</label><alternatives><mml:math id="math3-0962280220912524"><mml:mover accent="true"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="italic">Pr</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mfenced separators="|"><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mfenced separators="|"><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="italic">Pr</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mfenced separators="|"><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mfenced separators="|"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math><graphic xlink:href="10.1177_0962280220912524-eq3.jpg" position="float" orientation="portrait"/></alternatives></disp-formula>where <inline-formula id="ilm51-0962280220912524"><mml:math id="mml-math51-0962280220912524"><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> is an indicator function demonstrating whether or not switching had occurred at the end of interval <inline-formula id="ilm52-0962280220912524"><mml:math id="mml-math52-0962280220912524"><mml:mi>k</mml:mi></mml:math></inline-formula>, and <inline-formula id="ilm53-0962280220912524"><mml:math id="mml-math53-0962280220912524"><mml:mover accent="true"><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mfenced separators="|"><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula> denotes switching history to the end of the previous interval. <inline-formula id="ilm54-0962280220912524"><mml:math id="mml-math54-0962280220912524"><mml:mover accent="true"><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mfenced separators="|"><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula> denotes an individual’s treatment history up to the end of the previous interval, and <inline-formula id="ilm55-0962280220912524"><mml:math id="mml-math55-0962280220912524"><mml:mi>V</mml:mi></mml:math></inline-formula> is an array of an individual’s baseline covariates. <inline-formula id="ilm56-0962280220912524"><mml:math id="mml-math56-0962280220912524"><mml:mover accent="true"><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mfenced separators="|"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> denotes the history of an individual’s time-dependent covariates measured at or prior to the beginning of interval <inline-formula id="ilm57-0962280220912524"><mml:math id="mml-math57-0962280220912524"><mml:mi>k</mml:mi></mml:math></inline-formula> and includes <inline-formula id="ilm58-0962280220912524"><mml:math id="mml-math58-0962280220912524"><mml:mi>V</mml:mi></mml:math></inline-formula>. Only baseline and time-dependent <italic>confounding</italic> variables need to be included in <inline-formula id="ilm59-0962280220912524"><mml:math id="mml-math59-0962280220912524"><mml:mi>V</mml:mi></mml:math></inline-formula> and <inline-formula id="ilm60-0962280220912524"><mml:math id="mml-math60-0962280220912524"><mml:mover accent="true"><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mfenced separators="|"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>.</p>
                    <p>The denominator of <xref ref-type="disp-formula" rid="disp-formula3-0962280220912524">equation (3)</xref> represents the probability of an individual remaining unswitched at the end of interval <italic>k</italic> given that he or she had not switched at the end of the previous interval <inline-formula id="ilm61-0962280220912524"><mml:math id="mml-math61-0962280220912524"><mml:mfenced separators="|"><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula>, conditional on baseline confounders, time-dependent confounders and treatment history – as estimated by the switching model. The numerator of <xref ref-type="disp-formula" rid="disp-formula3-0962280220912524">equation (3)</xref> represents that same probability, but is conditional only on baseline confounders and treatment history. For unstabilised weights, this numerator would simply equal 1. The idea behind stabilised weights is that the numerator is made as similar as possible to the denominator without re-introducing confounding – time-dependent confounders must not be included in the numerator.<sup><xref rid="bibr34-0962280220912524" ref-type="bibr">34</xref></sup></p>
                    <p>Inverse probability weights can be incorporated within any outcomes model to adjust for treatment switching. Any baseline confounders <inline-formula id="ilm62-0962280220912524"><mml:math id="mml-math62-0962280220912524"><mml:mi>V</mml:mi></mml:math></inline-formula> included in the numerator of the weighting model should be included in the weighted outcomes model.<sup><xref rid="bibr17-0962280220912524" ref-type="bibr">17</xref></sup> Ordinary standard errors are not valid in a weighted analysis and these must instead be computed in a robust way, using the sandwich variance.</p>
                  </sec>
                </sec>
                <sec id="sec17-0962280220912524">
                  <title>2.1.4 Rank preserving structural failure time models</title>
                  <sec id="sec18-0962280220912524">
                    <title>2.1.4.1 RPSFTM – concept</title>
                    <p>The RPSFTM involves a similar concept to TSEsimp and TSEgest – a treatment effect associated with switching is estimated and this is used to derive what survival times would have been in the absence of switching. Unlike the TSE methods, the RPSFTM does not differentiate between the treatment effect in the experimental group and the treatment effect in switchers – the treatment effect <inline-formula id="ilm63-0962280220912524"><mml:math id="mml-math63-0962280220912524"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is assumed to be the same irrespective of when treatment is received. This may be regarded as a disadvantage, particularly in the context of post-progression switching in an oncology trial, as progressive disease may alter capacity to benefit. However, by making this assumption – in combination with g-estimation designed specifically for an RCT context – the RPSFTM avoids the no unmeasured confounding assumption.<sup><xref rid="bibr16-0962280220912524" ref-type="bibr">16</xref>,<xref rid="bibr35-0962280220912524" ref-type="bibr">35</xref></sup></p>
                  </sec>
                  <sec id="sec19-0962280220912524">
                    <title>2.1.4.2 RPSFTM – assumptions</title>
                    <p>The RPSFTM makes two crucial assumptions (see <xref ref-type="boxed-text" rid="boxed-text1">Box 1</xref>): (i) Potential outcomes are independent of randomised group, and (ii) there is a common treatment effect (that is, the time ratio <italic>ψ</italic> is equal for all treated patients).<sup><xref rid="bibr16-0962280220912524" ref-type="bibr">16</xref>,<xref rid="bibr35-0962280220912524" ref-type="bibr">35</xref></sup></p>
                  </sec>
                  <sec id="sec20-0962280220912524">
                    <title>2.1.4.3 RPSFTM – modelling approach</title>
                    <p>The RPSFTM involves a counterfactual survival model to estimate untreated survival times for all randomised patients, and an outcomes model used to estimate the effect of experimental treatment adjusted for treatment switching. These models must be correctly specified in order for RPSFTM to provide unbiased estimates of the effect of being randomised to experimental treatment adjusted for treatment switching (see <xref ref-type="boxed-text" rid="boxed-text1">Box 1</xref>).</p>
                    <p>For the simple one-parameter RPSFTM, the counterfactual survival model splits the observed event time (<inline-formula id="ilm64-0962280220912524"><mml:math id="mml-math64-0962280220912524"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) for each patient into the time spent on the control treatment (<inline-formula id="ilm65-0962280220912524"><mml:math id="mml-math65-0962280220912524"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) and the time spent on the experimental treatment (<inline-formula id="ilm66-0962280220912524"><mml:math id="mml-math66-0962280220912524"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>). <inline-formula id="ilm67-0962280220912524"><mml:math id="mml-math67-0962280220912524"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is related to the counterfactual event time (<inline-formula id="ilm68-0962280220912524"><mml:math id="mml-math68-0962280220912524"><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) with the same model as presented in <xref ref-type="disp-formula" rid="disp-formula1-0962280220912524">equation (1)</xref>. The value of <italic>ψ</italic> is estimated using g-estimation.<sup><xref rid="bibr28-0962280220912524" ref-type="bibr">28</xref></sup> For a range of values of <italic>ψ</italic>, the counterfactual survival model (1) is used to estimate <inline-formula id="ilm69-0962280220912524"><mml:math id="mml-math69-0962280220912524"><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and the true value is that which results in <inline-formula id="ilm70-0962280220912524"><mml:math id="mml-math70-0962280220912524"><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> being independent of randomised groups, based upon a g-test.<sup><xref rid="bibr36-0962280220912524" ref-type="bibr">36</xref></sup> The g-test (e.g. log-rank, Cox) tests the hypothesis that the counterfactual (untreated) survival curves are identical in the two treatment groups, with the point estimate of <italic>ψ</italic> being that for which the test (z) statistic equals zero.</p>
                    <p>The g-estimation process results in counterfactual survival times estimated for the g-estimate of <italic>ψ</italic>. A new dataset is derived consisting of observed survival times for experimental group patients and control group non-switchers, and counterfactual survival times for switchers. When censoring is present, re-censoring (for all patients in treatment groups affected by switching) is incorporated within the g-estimation process. Then, an outcomes model is used to estimate the effect of experimental treatment adjusted for treatment switching. The <italic>P</italic>-value produced by the outcomes model is likely to be too small and confidence intervals too narrow because they do not account for the fact that the data have been adjusted. It is recommended that the <italic>P</italic>-value from an equivalent ITT analysis should be used and confidence intervals calculated accordingly<sup><xref rid="bibr16-0962280220912524" ref-type="bibr">16</xref>,<xref rid="bibr37-0962280220912524" ref-type="bibr">37</xref></sup> or, as for the TSE methods, the entire adjustment procedure could be bootstrapped.</p>
                  </sec>
                </sec>
              </sec>
              <sec id="sec21-0962280220912524">
                <title>2.2 Simulation study</title>
                <p>Detailed information on our simulation study, including code used to simulate the data, is provided in the appendices. Here we provide a brief summary of our aims, data generating mechanism, estimand, methods included and performance measures. The simulation study was conducted using Stata software, version 14.2.<sup><xref rid="bibr38-0962280220912524" ref-type="bibr">38</xref></sup></p>
                <sec id="sec22-0962280220912524">
                  <title>2.2.1 Aims</title>
                  <p>Our objective was to assess the performance of TSEgest compared to TSEsimp, IPCW and RPSFTM in adjusting for treatment switching in simple scenarios, where time-dependent confounding is not an issue, and in more complex scenarios affected by time-dependent confounding. We focus on the problem typically seen in HTA whereby a subset of patients randomised to the control group of an RCT switch onto the experimental treatment after disease progression. Our aim is to estimate what survival would have been in the control group if switching had not occurred.</p>
                </sec>
                <sec id="sec23-0962280220912524">
                  <title>2.2.2 Data generating mechanism</title>
                  <p>In common with previous simulation studies,<sup><xref rid="bibr13-0962280220912524" ref-type="bibr">13</xref>,<xref rid="bibr26-0962280220912524" ref-type="bibr">26</xref></sup> we simulated datasets with a sample size of 500 and 2:1 randomisation in favour of the experimental group, and with treatment switching permitted from the control group onto the experimental treatment. A step-by-step description of our data generating mechanism is provided in online Appendix A.</p>
                  <p>Our primary interest was in the performance of the adjustment methods in scenarios when time-dependent confounding was present, and when time-dependent confounding was not present. To this end, we simulated a set of ‘simple’ scenarios (which did not include time-dependent confounding) and a set of ‘complex’ scenarios (where time-dependent confounding was present). In the ‘simple’ scenarios, control group patients could only switch onto the experimental treatment immediately upon disease progression – no switching before or after this time point was allowed. Hence, there could be no time-dependent confounding between the time of progression and the time of switch. In the ‘complex’ scenarios, control group patients could switch onto the experimental treatment either immediately upon disease progression or beyond this time point. A post-progression confounding variable (referred to as ‘metastatic disease’) was simulated to ensure that these scenarios were affected by time-dependent confounding. In addition, there was an interaction between the effect of switching and the metastatic disease variable. In patients who had not yet developed metastatic disease, switching treatments reduced the probability of subsequently developing metastatic disease. In patients who had developed metastatic disease, switching treatments extended survival but did not alter the fact that metastatic disease had been developed. Hence treatment effect heterogeneity was present.</p>
                  <p>In addition to the existence of time-dependent confounding, we considered that the size of the treatment effect, the switching proportion, and whether or not censoring was present could affect the performance of the adjustment methods. Hence, scenarios were run varying the following characteristics:
<list list-type="bullet" id="list1-0962280220912524"><list-item><p>Treatment effect: low (average HR under the assumption of proportional hazards (which is an incorrect assumption in complex scenarios) approximately 0.82); high (average HR approximately 0.61)</p></list-item><list-item><p>Switch proportion: moderate (approximately 50% of control group patients who experienced disease progression); high (approximately 75% of control group patients who experienced disease progression)</p></list-item><list-item><p>Censoring: none; present (administrative censoring proportion approximately 20–35%)</p></list-item><list-item><p>Time-dependent confounding: none (in simple scenarios); present (in complex scenarios)</p></list-item></list></p>
                  <p>Using a 2 × 2×2 × 2 factorial design resulted in a total of 16 scenarios. The scenarios were numbered 1–16 with all levels of one factor nested inside one level of the next factor, following the order listed above. Details on scenario values and settings are presented in online Appendices B and C. Scenarios 1–8 were the simple scenarios, in which the metastatic disease time-dependent confounder was not included. Scenarios 9–16 were the complex scenarios, which included the time-dependent confounder. Scenarios 15 and 16 were re-run simulating a sample size of 10,000 instead of 500, because we anticipated that IPCW and TSEgest may be prone to high error levels with relatively small sample sizes. Repeating these scenarios with a much larger sample size allowed us to assess this. Therefore, in total 18 scenarios were run. One thousand simulations were run for each scenario.</p>
                </sec>
                <sec id="sec24-0962280220912524">
                  <title>2.2.3 Estimand</title>
                  <p>Our estimand was restricted mean survival time (RMST) in the control group, consistent with our aim of investigating the performance of adjustment methods in estimating survival times for the control group that would have been observed in the absence of treatment switching.</p>
                  <p>In the simple scenarios, it was possible to integrate the simulated survival function to calculate true RMST (see equations (A1) to (A3) in online Appendix A). In the complex scenarios, the survival function was not analytically tractable, so to estimate our “true” value for each scenario, we simulated data for 1,000,000 patients without incorporating treatment switching, and estimated control group RMST by calculating the area under the Kaplan–Meier survival function. This value is the product of a simulation so is prone to error, but this is minimal given the large number of patients simulated. For instance, in Scenario 1, the standard error of the control group RMST estimate of 424.37 days was 0.48. In scenarios that did not include censoring, RMST was effectively unrestricted because death was observed in all simulated patients. In scenarios that included censoring, RMST was estimated up to 546 days (the maximum administrative censoring time in the simulated datasets).</p>
                </sec>
                <sec id="sec25-0962280220912524">
                  <title>2.2.4 Adjustment methods compared</title>
                  <p>TSEsimp, TSEgest, RPSFTM and IPCW were included and their application is described in detail in online Appendix D. TSEsimpTDC was only included in Scenarios 9–18 because in Scenarios 1–8, where switching could only occur immediately at the point of disease progression, TSEsimpTDC simplifies to TSEsimp. As described previously, TSEsimp (and TSEsimpTDC), TSEgest and RPSFTM involve estimating a treatment effect associated with switching and then using this to derive counterfactual survival times, whereas IPCW results in weighted survival times. We used the Stata command stpm2<sup><xref rid="bibr39-0962280220912524" ref-type="bibr">39</xref></sup> to fit flexible parametric models to the counterfactual datasets provided by TSEsimp, TSEsimpTDC, TSEgest and RPSFTM, and to the weighted survival times provided by IPCW, to obtain the survivor function extrapolated (if necessary) to 546 days, ensuring that our RMST comparisons were comparing “like with like”. Non-parametric methods to estimate RMST up to the final follow-up time-point could not be used because, in scenarios that included censoring, when re-censoring is applied (for the TSE and RPSFTM methods) the re-censored final follow-up time-point may differ from 546 days and may differ for each adjustment method. Using flexible parametric models is consistent with UK HTA recommendations for undertaking survival modelling in the presence of complex hazard functions.<sup><xref rid="bibr40-0962280220912524" ref-type="bibr">40</xref>,<xref rid="bibr41-0962280220912524" ref-type="bibr">41</xref></sup></p>
                  <p>To provide context on the performance of the various adjustment methods, we included a ‘No Switching’ analysis, representing the results of a standard ITT analysis (that is, an unadjusted estimate of control group RMST) undertaken on the simulated dataset before switching was applied. This represents the “truth” for each simulation and does not represent a feasible estimator, but provides a useful upper bound for adjustment method performance which may be considered a ‘gold standard’. We also included a standard ITT analysis after switching was applied. Though this has a different estimand to the adjustment methods (because it does not adjust for switching), it is standard practice to present an ITT analysis even in the presence of treatment switching.</p>
                </sec>
                <sec id="sec26-0962280220912524">
                  <title>2.2.5 Performance measures</title>
                  <p>The performance of methods was evaluated according to the percentage bias in their estimate of control group RMST at 546 days. Percentage bias was estimated by taking the difference between the mean estimated RMST and the true RMST and expressing this as a percentage of true RMST.<sup><xref rid="bibr42-0962280220912524" ref-type="bibr">42</xref></sup> Root mean squared error (RMSE) and empirical standard errors (SE) of the RMST estimates were also calculated for each method and expressed as percentages of the true RMST. Convergence was measured, defined as the proportion of times that each method resulted in an estimate of control group RMST. Percentage bias, RMSE and empirical SE were calculated based upon simulations in which convergence occurred. Monte Carlo (MC) standard errors were calculated for each performance measure, for each method.<sup><xref rid="bibr43-0962280220912524" ref-type="bibr">43</xref></sup> For the IPCW method, we recorded the mean, standard deviation, minimum, maximum and coefficient of variation of the weights measured across control group patients in each simulated data set, in order to explore the relationship between these and the performance of the method.</p>
                </sec>
              </sec>
            </sec>
            <sec sec-type="results" id="sec27-0962280220912524">
              <title>3 Results</title>
              <p>First, we present results from the simple scenarios, focusing on results from one scenario to illustrate the key findings. We then repeat this for the complex scenarios. A summary table describing the data generated under each scenario is presented in online Appendix E.</p>
              <sec id="sec28-0962280220912524">
                <title>3.1 Results from simple scenarios</title>
                <p>The upper half of <xref rid="table1-0962280220912524" ref-type="table">Table 1</xref> presents detailed results from Scenario 2, which included no time-dependent confounder, a large treatment effect, a moderate switch proportion and zero censoring. The ITT analysis over-estimated control group RMST, equivalent to a percentage bias of 12.4%. TSEsimp, TSEgest, RPSFTM and IPCW all predicted control group RMST with very little percentage bias, ranging from 0.0% for RPSFTM to 1.0% for TSEgest. TSEsimp resulted in empirical standard errors and RMSE that were approximately 10–13% lower than those from TSEgest, RPSFTM and IPCW.</p>
                <table-wrap id="table1-0962280220912524" orientation="portrait" position="float">
                  <label>Table 1.</label>
                  <caption>
                    <p>Scenarios 2 and 10 – performance measures for estimation of control arm RMST.</p>
                  </caption>
                  <alternatives>
                    <graphic xlink:href="10.1177_0962280220912524-table1"/>
                    <table frame="hsides" rules="groups">
                      <thead valign="top">
                        <tr>
                          <th rowspan="1" colspan="1">Scenario details</th>
                          <th rowspan="1" colspan="1">Method</th>
                          <th rowspan="1" colspan="1">Percent bias in RMST</th>
                          <th rowspan="1" colspan="1">Empirical SEas percentage of true RMST</th>
                          <th rowspan="1" colspan="1">RMSEas percentage of true RMST</th>
                          <th rowspan="1" colspan="1">Convergence (%)</th>
                        </tr>
                      </thead>
                      <tbody valign="top">
                        <tr>
                          <td rowspan="7" colspan="1">Scenario number: 2True RMST:Control: 424Experimental: 600Mean switch: 50%True ave. HR: 0.61True ave. TR: 1.42Mean censored: 0%</td>
                          <td align="char" char="." rowspan="1" colspan="1">No switching</td>
                          <td align="char" char="." rowspan="1" colspan="1">−0.0</td>
                          <td align="char" char="." rowspan="1" colspan="1">5.5</td>
                          <td align="char" char="." rowspan="1" colspan="1">5.5</td>
                          <td align="char" char="." rowspan="1" colspan="1">100</td>
                        </tr>
                        <tr>
                          <td rowspan="1" colspan="1">ITT</td>
                          <td align="char" char="." rowspan="1" colspan="1">12.4</td>
                          <td align="char" char="." rowspan="1" colspan="1">6.3</td>
                          <td align="char" char="." rowspan="1" colspan="1">13.9</td>
                          <td align="char" char="." rowspan="1" colspan="1">100</td>
                        </tr>
                        <tr>
                          <td rowspan="1" colspan="1">TSEsimp</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.4</td>
                          <td align="char" char="." rowspan="1" colspan="1">7.4</td>
                          <td align="char" char="." rowspan="1" colspan="1">7.4</td>
                          <td align="char" char="." rowspan="1" colspan="1">100</td>
                        </tr>
                        <tr>
                          <td rowspan="1" colspan="1">TSEgest</td>
                          <td align="char" char="." rowspan="1" colspan="1">1.0</td>
                          <td align="char" char="." rowspan="1" colspan="1">8.2</td>
                          <td align="char" char="." rowspan="1" colspan="1">8.3</td>
                          <td align="char" char="." rowspan="1" colspan="1">100</td>
                        </tr>
                        <tr>
                          <td rowspan="1" colspan="1">RPSFTM</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.0</td>
                          <td align="char" char="." rowspan="1" colspan="1">8.2</td>
                          <td align="char" char="." rowspan="1" colspan="1">8.2</td>
                          <td align="char" char="." rowspan="1" colspan="1">100</td>
                        </tr>
                        <tr>
                          <td rowspan="1" colspan="1">IPCW</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.6</td>
                          <td align="char" char="." rowspan="1" colspan="1">8.1</td>
                          <td align="char" char="." rowspan="1" colspan="1">8.1</td>
                          <td align="char" char="." rowspan="1" colspan="1">100</td>
                        </tr>
                        <tr>
                          <td rowspan="1" colspan="1">min/max MC error</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.2/0.3</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.1/0.2</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.1/0.2</td>
                          <td align="char" char="." rowspan="1" colspan="1">–</td>
                        </tr>
                        <tr>
                          <td rowspan="8" colspan="1">Scenario number: 10True RMST:Control: 338Experimental: 465Mean switch: 51%True ave. HR: 0.65True ave. TR: 1.38Mean censored: 0%</td>
                          <td align="char" char="." rowspan="1" colspan="1">No switching</td>
                          <td align="char" char="." rowspan="1" colspan="1">−0.1</td>
                          <td align="char" char="." rowspan="1" colspan="1">5.5</td>
                          <td align="char" char="." rowspan="1" colspan="1">5.5</td>
                          <td align="char" char="." rowspan="1" colspan="1">100</td>
                        </tr>
                        <tr>
                          <td rowspan="1" colspan="1">ITT</td>
                          <td align="char" char="." rowspan="1" colspan="1">7.3</td>
                          <td align="char" char="." rowspan="1" colspan="1">6.0</td>
                          <td align="char" char="." rowspan="1" colspan="1">9.5</td>
                          <td align="char" char="." rowspan="1" colspan="1">100</td>
                        </tr>
                        <tr>
                          <td rowspan="1" colspan="1">TSEsimp</td>
                          <td align="char" char="." rowspan="1" colspan="1">5.6</td>
                          <td align="char" char="." rowspan="1" colspan="1">7.0</td>
                          <td align="char" char="." rowspan="1" colspan="1">9.0</td>
                          <td align="char" char="." rowspan="1" colspan="1">100</td>
                        </tr>
                        <tr>
                          <td rowspan="1" colspan="1">TSEsimpTDC</td>
                          <td align="char" char="." rowspan="1" colspan="1">6.9</td>
                          <td align="char" char="." rowspan="1" colspan="1">7.4</td>
                          <td align="char" char="." rowspan="1" colspan="1">10.1</td>
                          <td align="char" char="." rowspan="1" colspan="1">100</td>
                        </tr>
                        <tr>
                          <td rowspan="1" colspan="1">TSEgest</td>
                          <td align="char" char="." rowspan="1" colspan="1">−0.6</td>
                          <td align="char" char="." rowspan="1" colspan="1">6.4</td>
                          <td align="char" char="." rowspan="1" colspan="1">6.4</td>
                          <td align="char" char="." rowspan="1" colspan="1">100</td>
                        </tr>
                        <tr>
                          <td rowspan="1" colspan="1">RPSFTM</td>
                          <td align="char" char="." rowspan="1" colspan="1">−0.1</td>
                          <td align="char" char="." rowspan="1" colspan="1">7.0</td>
                          <td align="char" char="." rowspan="1" colspan="1">7.0</td>
                          <td align="char" char="." rowspan="1" colspan="1">100</td>
                        </tr>
                        <tr>
                          <td rowspan="1" colspan="1">IPCW</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.6</td>
                          <td align="char" char="." rowspan="1" colspan="1">7.0</td>
                          <td align="char" char="." rowspan="1" colspan="1">7.0</td>
                          <td align="char" char="." rowspan="1" colspan="1">100</td>
                        </tr>
                        <tr>
                          <td rowspan="1" colspan="1">min/max MC error</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.2/0.2</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.1/0.2</td>
                          <td align="char" char="." rowspan="1" colspan="1">0.1/0.2</td>
                          <td align="char" char="." rowspan="1" colspan="1">–</td>
                        </tr>
                      </tbody>
                    </table>
                  </alternatives>
                  <table-wrap-foot>
                    <fn id="table-fn1-0962280220912524">
                      <p>RMST: Restricted mean survival time; HR: hazard ratio; SE: standard error; RMSE: root mean squared error; MC: Monte-Carlo; ITT: intention to treat; TSEsimp: two-stage estimation with simple Weibull model; TSEgest: two-stage estimation with g-estimation; RPSFTM: rank preserving structural failure time model; IPCW: inverse probability of censoring weights; TSEsimpTDC: two-stage estimation with simple Weibull model and time-dependent covariates.</p>
                    </fn>
                  </table-wrap-foot>
                </table-wrap>
                <p>Results were similar across all simple scenarios (Scenarios 1–8) for all methods except IPCW and ITT, as illustrated by <xref ref-type="fig" rid="fig5-0962280220912524">Figures 5</xref>
<xref ref-type="fig" rid="fig6-0962280220912524"/>to <xref ref-type="fig" rid="fig7-0962280220912524">7</xref>, which present nested loop plots for percentage bias, empirical SE and RMSE across all scenarios.<sup><xref rid="bibr44-0962280220912524" ref-type="bibr">44</xref></sup> Across Scenarios 1–8, TSEsimp and IPCW resulted in least percentage bias in three scenarios apiece and RPSFTM resulted in least percentage bias in two scenarios. All methods always had percentage bias of less than 1.4%, except IPCW which resulted in percentage bias of approximately 3% in Scenarios 3 and 4, in which the switching proportion was high. TSEsimp consistently generated lower empirical standard errors than the other adjustment methods in the simple scenarios, with these ranging between 0% and 20% lower than the empirical standard errors associated with TSEgest, 11–49% lower than those associated with RPSFTM, and 9–63% lower than those associated with IPCW. This contributed to TSEsimp always resulting in the lowest RMSE of all the adjustment methods in the simple scenarios.</p>
                <fig id="fig5-0962280220912524" orientation="portrait" position="float">
                  <label>Figure 5.</label>
                  <caption>
                    <p>Percentage bias in estimation of control group restricted mean survival time across all scenarios. ITT: intention to treat; TSEsimp: two-stage estimation with simple Weibull model; TSEgest: two-stage estimation with g-estimation; RPSFTM: rank preserving structural failure time model; IPCW: inverse probability of censoring weights; TSEsimpTDC: two-stage estimation with simple Weibull model and time-dependent covariates.</p>
                  </caption>
                  <graphic xlink:href="10.1177_0962280220912524-fig5"/>
                </fig>
                <fig id="fig6-0962280220912524" orientation="portrait" position="float">
                  <label>Figure 6.</label>
                  <caption>
                    <p>Empirical standard error in estimation of control group restricted mean survival time across all scenarios. ITT: intention to treat; TSEsimp: two-stage estimation with simple Weibull model; TSEgest: two-stage estimation with g-estimation; RPSFTM: rank preserving structural failure time model; IPCW: inverse probability of censoring weights; TSEsimpTDC: two-stage estimation with simple Weibull model and time-dependent covariates; SE: standard error.</p>
                  </caption>
                  <graphic xlink:href="10.1177_0962280220912524-fig6"/>
                </fig>
                <fig id="fig7-0962280220912524" orientation="portrait" position="float">
                  <label>Figure 7.</label>
                  <caption>
                    <p>Root mean squared error in estimation of control group restricted mean survival time across all scenarios. ITT: intention to treat; TSEsimp: two-stage estimation with simple Weibull model; TSEgest: two-stage estimation with g-estimation; RPSFTM: rank preserving structural failure time model; IPCW: inverse probability of censoring weights; TSEsimpTDC: two-stage estimation with simple Weibull model and time-dependent covariates; RMSE: root mean squared error.</p>
                  </caption>
                  <graphic xlink:href="10.1177_0962280220912524-fig7"/>
                </fig>
              </sec>
              <sec id="sec29-0962280220912524">
                <title>3.2 Results from complex scenarios</title>
                <p><xref rid="table1-0962280220912524" ref-type="table">Table 1</xref> also presents detailed results from Scenario 10, which was similar to Scenario 2 with respect to treatment effect, switch proportion and censoring, but included time-dependent confounding. The ITT analysis again over-estimated control group RMST, equivalent to a percentage bias of 7.3%. TSEsimp resulted in high percentage bias in Scenario 10 – over-estimating control group RMST to almost the same extent as the ITT analysis (percentage bias 5.6%). In contrast, TSEgest, RPSFTM and IPCW generated very low percentage bias (−0.6% for TSEgest, −0.1% for RPSFTM and 0.6% for IPCW). TSEsimpTDC resulted in percentage bias (6.9%) that was similar in size to that of TSEsimp. TSEgest resulted in an empirical standard error that was approximately 10% lower than that of TSEsimp, RPSFTM and IPCW, and also generated the lowest RMSE. TSEsimp produced substantially higher RMSE due to its increased bias.</p>
                <p>Results for RPSFTM and TSEgest were relatively stable in all the complex scenarios, as illustrated in <xref ref-type="fig" rid="fig5-0962280220912524">Figures 5</xref>
<xref ref-type="fig" rid="fig6-0962280220912524"/>to <xref ref-type="fig" rid="fig7-0962280220912524">7</xref>. These methods consistently resulted in low bias, although TSEgest was prone to slightly increased bias (up to approximately 2%) in scenarios with a high switching proportion. TSEsimp (and TSEsimpTDC) consistently resulted in much higher levels of bias than TSEgest and RPSFTM, with increased switching proportions and treatment effect sizes associated with higher bias. IPCW resulted in low bias in Scenarios 9, 10, 13 and 14, when the switching proportion was moderate (approximately 50%), but produced much higher bias in Scenarios 11, 12, 15 and 16, when the switching proportion was high (approximately 75%).</p>
                <p>The switching proportions in Scenarios 11–12 and 15–16 were not different to those simulated in simple Scenarios 3–4 and 7–8, in which IPCW resulted in low bias. However, the incorporation of the time-dependent confounding variable meant that additional covariates were used in the TSEgest and IPCW switching models, which, combined with a low sample size and high switching proportion resulted in slightly increased bias for TSEgest and substantially increased bias for IPCW. Re-running Scenarios 15 and 16 with a much larger sample size (in Scenarios 17 and 18) had minimal impact on TSEgest, but resulted in substantially reduced bias for IPCW. In Scenarios 17 and 18, IPCW produced weights that were much lower as a proportion of the size of the group being subjected to weighting, compared to Scenarios 15 and 16 (and Scenarios 11 and 12). Within Scenarios 1–16, the range of weights was widest in Scenarios 11, 12, 15 and 16, with average minimum and maximum weights of approximately 0.02 and 18 in these scenarios, in a control group made up of approximately 170 patients. The coefficient of variation of the weights was also highest in these scenarios (approximately 0.77) but this was not substantially different to the coefficient of variation in scenarios in which the IPCW worked well (e.g. Scenarios 3, 4, 7 and 8). In Scenarios 17 and 18, the range of weights and the coefficient of variation increased (average minimum and maximum weight 0.02 and 71, coefficient of variation 0.98–0.99), but the maximum weight was much lower as a proportion of the size of the group being subjected to weighting, as approximately 3400 patients were randomised to the control group in these scenarios. This indicates that it is the size of the maximum weight in relation to the size of the group being subjected to weighting that is a key determinant of the bias associated with IPCW. In Scenarios 1–8, the maximum weight as a proportion of the control group sample size varied between 3% and 6% and in Scenarios 9–10, 13–14 and 17–18 it was approximately 2%. However, in Scenarios 11, 12, 15 and 16, this proportion increased to 10–11%.</p>
                <p>Across Scenarios 9–18, RPSFTM generated least percentage bias in seven scenarios and IPCW in three scenarios. Neither TSEsimp or TSEgest resulted in least percentage bias in any of these scenarios, but percentage bias was considerably lower for TSEgest than TSEsimp in all of these scenarios, and levels of bias associated with TSEgest were not substantially different from those associated with RPSFTM. IPCW resulted in much higher percentage bias than TSEgest and RPSFTM in Scenarios 11, 12, 15 and 16. TSEsimp produced lower empirical standard errors than the other adjustment methods in scenarios which incorporated censoring (Scenarios 13–18), but TSEgest produced the lowest empirical standard errors in scenarios without censoring (Scenarios 9–12). Across Scenarios 9–18, TSEgest resulted in lowest RMSE in six scenarios, RPSFTM in three scenarios and IPCW in one scenario.</p>
              </sec>
            </sec>
            <sec sec-type="discussion" id="sec30-0962280220912524">
              <title>4 Discussion</title>
              <p>In scenarios without time-dependent confounding, TSEsimp resulted in estimates of control group RMST that had similar or lower bias than the complex adjustment methods, and had less variability. However, in scenarios with time-dependent confounding, TSEsimp resulted in estimates that had substantially higher bias than TSEgest and RPSFTM. IPCW also resulted in substantially lower bias than TSEsimp in scenarios with time-dependent confounding, provided the inverse probability weights were not too high. Overall, if time-dependent confounding is unlikely, TSEsimp remains an appropriate adjustment method. But if time-dependent confounding is a possibility – for instance, due to long time periods between the secondary baseline and the switching time, or due to measured prognostic events that occurred between these two time-points – TSEgest, RPSFTM and IPCW should be considered instead.</p>
              <p>In scenarios with time-dependent confounding, TSEsimp over-estimated control group RMST to almost the same extent as the ITT analysis – sometimes actually resulting in a higher estimate of control group RMST than the ITT analysis. This is because patients who experienced the metastatic event (which drastically reduced survival times) were more likely to switch (as explained in online Appendix A). Failing to account for this constitutes confounding by indication and results in switching appearing to have only a very minor beneficial effect, or in fact in switching appearing harmful. The opposite would be the case if switching was more likely in patients who had not experienced the metastatic event. Either way, in the presence of such time-dependent confounding, TSEsimp becomes prone to high levels of bias. Controlling for a time-dependent confounder using simple regression is inadequate and inappropriate, because we control for a variable through which treatment has an effect on the outcome of interest – as demonstrated by the biased results associated with the TSEsimpTDC analyses.</p>
              <p>We demonstrated that correctly specified TSEgest and IPCW models were able to deal with the time-dependent confounding caused by the metastatic disease variable. Interestingly, TSEgest was more robust to high switching proportions in small sample sizes than IPCW. This is in line with theory, because when positivity begins to break down in a particular subgroup (due to very small numbers of patients who do not switch), IPCW is more prone to error because it weights remaining observations in that subgroup – often resulting in very high weights – whereas TSEgest remains able to estimate the treatment effect using data from other subgroups. In practice, violations of the positivity assumption are possible when certain prognostic characteristics are highly predictive for switching. Our IPCW results reflect previous findings, with the added reassurance that the method can perform well even in the presence of serious time-dependent confounding – provided models are accurately specified and weights are not too high. Previous studies have demonstrated that IPCW performs well when weights are not extreme,<sup><xref rid="bibr12-0962280220912524" ref-type="bibr">12</xref>,<xref rid="bibr13-0962280220912524" ref-type="bibr">13</xref>,<xref rid="bibr26-0962280220912524" ref-type="bibr">26</xref>,<xref rid="bibr45-0962280220912524" ref-type="bibr">45</xref></sup> and have discussed the definition of weights that are too high or have too great a range or coefficient of variation.<sup><xref rid="bibr12-0962280220912524" ref-type="bibr">12</xref>,<xref rid="bibr13-0962280220912524" ref-type="bibr">13</xref>,<xref rid="bibr26-0962280220912524" ref-type="bibr">26</xref></sup> In this study we found that the coefficient of variation did not seem to be the most important determinant of bias associated with IPCW – instead it appeared that the size of the weights in relation to the sample size of the group subject to weighting was the critical factor. We are unable to draw firm conclusions, but we found that when the maximum weight as a proportion of the group being weighted was less than 6%, the IPCW method resulted in low bias, but when this proportion increased to 10–11% bias increased substantially.</p>
              <p>Our study also provides further information on the performance of the RPSFTM, which performed well across all scenarios, often resulting in the lowest percentage bias in scenarios that involved time-dependent confounding – though TSEgest more often generated the lowest RMSE in these scenarios. It is important to note – and is a limitation of our study – that we only simulated scenarios that involved an approximately common treatment effect between switchers and patients randomised to the experimental group. Previous studies have consistently shown that RPSFTM performs well in these circumstances,<sup><xref rid="bibr12-0962280220912524" ref-type="bibr">12</xref><xref rid="bibr13-0962280220912524" ref-type="bibr"/>–<xref rid="bibr14-0962280220912524" ref-type="bibr">14</xref>,<xref rid="bibr26-0962280220912524" ref-type="bibr">26</xref></sup> although these have not involved important time-dependent confounding variables similar to the metastatic disease variable simulated in this study. Hence, our results provide increased confidence that the RPSFTM method is reliable even in the presence of serious time-dependent confounding. However, as previously demonstrated,<sup><xref rid="bibr12-0962280220912524" ref-type="bibr">12</xref>,<xref rid="bibr13-0962280220912524" ref-type="bibr">13</xref>,<xref rid="bibr26-0962280220912524" ref-type="bibr">26</xref></sup> performance of the RPSFTM worsens when the common treatment effect assumption does not hold and sensitivity analysis should always be undertaken around this.<sup><xref rid="bibr6-0962280220912524" ref-type="bibr">6</xref></sup> Linked to this, the RPSFTM method is only likely to be appropriate in situations where treatment switching is between randomised treatments. In contrast, TSE and IPCW methods could be used irrespective of what treatment patients switched on to.</p>
              <p>It is useful to note that using g-estimation substantially increases the flexibility of the TSE adjustment method – the approach may be thought of as generalised TSE. In fact, because the approach can account for time-dependent confounding, it is not necessary to use a secondary baseline. If treatment switching was only permitted after disease progression, the SNM could be fit from baseline with disease progression included as a time-dependent indicator variable. In such a case, we would expect the model to provide the same results as if it was fitted only from the disease progression time-point, because switching only occurred after progression and thus the switching model would only use data from the point of disease progression onwards – prior observations would be excluded due to perfectly predicting non-switching. However, whilst TSEsimp is not appropriate in circumstances where some (or all) switching occurs <italic>before</italic> disease progression, TSEgest could be used – representing an important advantage of this approach. An additional practical point worthy of note is that data must be in discrete time interval format for TSEgest to be applied. If variables were measured in continuous time, we would need to discretise time. However, narrow time intervals could be used and we expect that TSEgest could still work well.</p>
              <p>Our study has limitations. We used estimates of control group RMST to assess the performance of the adjustment methods. This may seem unexpected given our focus on comparing TSEsimp and TSEgest – two methods that begin by estimating the treatment effect in switchers. However, we could not use this treatment effect as our estimand because this would not have allowed us to make broader conclusions around the performance of the TSE methods in relation to the other adjustment methods. RPSFTM and IPCW do not estimate a treatment effect specific to switchers, so this could not be used as a comparative measure.</p>
              <p>The fact that our study consists of simulations may also be considered to be a limitation. Though we investigated several realistic scenarios, these can never cover all situations that may occur in reality. Because we knew the underlying data generating process, we were able to correctly specify switching models for TSEgest and IPCW. In the real world, careful thought must be given to how variables are linked, as model mis-specification will likely result in bias. This illustrates the importance of paying close attention to model specification; it is not enough to simply identify a method that <italic>could</italic> work, we must consider how the method should actually be applied. In our study we simulated a metastatic disease variable and assumed that this variable had a lagged effect on treatment choices. We think this is realistic – there is often a lag between ordering laboratory tests or scans, receiving the results and making treatment decisions. Therefore, using lagged values of variables in switching models is often likely to be sensible. Careful thought regarding causal pathways is necessary when specifying models that rely on no unmeasured confounding to account for time-dependent confounding, and clinical expert knowledge is likely to be crucial.</p>
              <p>It is a limitation that we did not consider coverage in this study. Previous simulation studies have reported coverage, but in a limited way.<sup><xref rid="bibr12-0962280220912524" ref-type="bibr">12</xref><xref rid="bibr13-0962280220912524" ref-type="bibr"/>–<xref rid="bibr14-0962280220912524" ref-type="bibr">14</xref>,<xref rid="bibr26-0962280220912524" ref-type="bibr">26</xref></sup> To properly account for uncertainty around survival estimates provided by RPSFTM and TSE methods bootstrapping is required, but is not feasible in simulation studies that investigate many scenarios. Without bootstrapping, estimates of coverage are not useful, and so we decided not to include them in this study. In practice, the entire RPSFTM, TSE and IPCW adjustment processes should be bootstrapped to obtain appropriate confidence intervals. In one previous study it was demonstrated that this results in adequate coverage levels, in scenarios where adjustment methods result in low bias.<sup><xref rid="bibr46-0962280220912524" ref-type="bibr">46</xref></sup> We therefore chose to focus on bias in this study, and are confident that methods that produce low bias would provide adequate standard errors and coverage provided bootstrapping is used.</p>
              <p>Finally, it is worthy of note that in our complex scenarios, treatment effect heterogeneity was simulated. Patients who switched after developing metastatic disease received a singular treatment effect of increased survival time, whereas patients who switched before developing metastatic disease received an additional treatment effect through reduced subsequent risk of developing metastatic disease. In our application of TSEgest, we did not include an interaction term for the treatment effect and the metastatic disease variable – doing so is not trivial in a g-estimation procedure. Hence the method estimated an average treatment effect across all switchers, rather than two separate effects dependent on metastatic disease status. This is a limitation, but we have shown that the method still produces little bias. However, this may explain why the method often produced some bias (1–2%) in the complex scenarios.</p>
              <p>We have demonstrated the performance of TSEgest, an alternative to the simple TSE method (TSEsimp) that has been used in health technology assessment to adjust for treatment switching.<sup><xref rid="bibr47-0962280220912524" ref-type="bibr">47</xref><xref rid="bibr48-0962280220912524" ref-type="bibr"/>–<xref rid="bibr49-0962280220912524" ref-type="bibr">49</xref></sup> TSEsimp is efficient and unbiased provided there is no time-dependent confounding between the time that switch becomes possible and the time that switch actually occurs. However, if there is a gap between these two time-points and prognostic events occur during this period TSEsimp results in serious bias, whereas TSEgest does not. RPSFTM and IPCW methods can also result in low levels of bias in the presence of time-dependent confounding, but TSEgest holds some advantages over these methods – being less prone to bias than IPCW in scenarios with high switching proportions and breakdowns in positivity, and, unlike the RPSFTM, not being reliant on the common treatment effect assumption. TSEgest represents a useful addition to the collection of methods that may be used to adjust for treatment switching in trials in order to address policy-relevant treatment reimbursement decision problems.</p>
            </sec>
            <sec sec-type="supplementary-material" specific-use="figshare">
              <title>Supplemental Material</title>
              <supplementary-material content-type="local-data" id="suppl1-0962280220912524">
                <caption>
                  <title>SMM912524 online Appendices - Supplemental material for Improved two-stage estimation to adjust for treatment switching in randomised trials: g-estimation to address time-dependent confounding</title>
                </caption>
                <media xlink:href="SMM912524_online_Appendices.pdf">
                  <caption>
                    <p>Click here for additional data file.</p>
                  </caption>
                </media>
                <p>Supplemental material, SMM912524 online Appendices for Improved two-stage estimation to adjust for treatment switching in randomised trials: g-estimation to address time-dependent confounding by NR Latimer, IR White, K Tilling and U Siebert in Statistical Methods in Medical Research</p>
              </supplementary-material>
            </sec>
          </body>
          <back>
            <sec id="sec31-0962280220912524">
              <title>Declaration of conflicting interests</title>
              <p>The author(s) declared the following potential conflicts of interest with respect to the research, authorship, and/or publication of this article: This report is independent research partly supported by the National Institute for Health Research, Yorkshire Cancer Research and the Medical Research Council. The views expressed in this publication are those of the author(s) and not necessarily those of the NHS, the National Institute for Health Research, Yorkshire Cancer Research, the Medical Research Council or the Department of Health.</p>
            </sec>
            <sec id="sec32-0962280220912524">
              <title>Funding</title>
              <p>The author(s) disclosed receipt of the following financial support for the research, authorship, and/or publication of this article: NRL was supported by the National Institute for Health Research (NIHR Post Doctoral Fellowship, Dr Nicholas Latimer, PDF-2015-08-022). NRL is now supported by Yorkshire Cancer Research (Award reference number S406NL). IRW is supported by the Medical Research Council (Programme number MC_UU_12023/21). KT is supported by the Medical Research Council (Programme number MC_UU_00011/3). US was in part supported by the COMET Center ONCOTYROL (Grant no. 2073085), which is funded by the Austrian Federal Ministries BMVIT/BMWFJ (via FFG) and the Tiroler Zukunftsstiftung/Standortagentur Tirol (SAT).</p>
            </sec>
            <sec>
              <title>ORCID iD</title>
              <p>NR Latimer <ext-link ext-link-type="uri" xlink:href="https://orcid.org/0000-0001-5304-5585">https://orcid.org/0000-0001-5304-5585</ext-link></p>
            </sec>
            <sec>
              <title>Supplemental material</title>
              <p>Supplemental material for this article is available online.</p>
            </sec>
            <ref-list content-type="numbered">
              <title>References</title>
              <ref id="bibr1-0962280220912524">
                <label>1</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Latimer</surname><given-names>NR</given-names></name><name><surname>Abrams</surname><given-names>KR</given-names></name><name><surname>Lambert</surname><given-names>PC</given-names></name></person-group>, <etal>et al</etal><article-title>Adjusting survival time estimates to account for treatment switching in randomised controlled trials – an economic evaluation context: methods, limitations and recommendations.</article-title><source>Med Decis Making</source><year>2014</year>; 
<volume>34</volume>: <fpage>387</fpage>–<lpage>402</lpage>.<pub-id pub-id-type="pmid">24449433</pub-id></mixed-citation>
              </ref>
              <ref id="bibr2-0962280220912524">
                <label>2</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jonsson</surname><given-names>L</given-names></name><name><surname>Sandin</surname><given-names>R</given-names></name><name><surname>Ekman</surname><given-names>M</given-names></name></person-group>, <etal>et al</etal><article-title>Analyzing overall survival in randomized controlled trials with crossover and implications for economic evaluation.</article-title><source>Value Health</source><year>2014</year>; 
<volume>17</volume>: <fpage>707</fpage>–<lpage>713</lpage>.<pub-id pub-id-type="pmid">25236994</pub-id></mixed-citation>
              </ref>
              <ref id="bibr3-0962280220912524">
                <label>3</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ishak</surname><given-names>KJ</given-names></name><name><surname>Proskorovsky</surname><given-names>I</given-names></name><name><surname>Korytowsky</surname><given-names>B</given-names></name></person-group>, <etal>et al</etal><article-title>Methods for adjusting for bias due to crossover in oncology trials.</article-title><source>Pharmacoeconomics</source><year>2014</year>; 
<volume>32</volume>: <fpage>533</fpage>–<lpage>546</lpage>.<pub-id pub-id-type="pmid">24595585</pub-id></mixed-citation>
              </ref>
              <ref id="bibr4-0962280220912524">
                <label>4</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Watkins</surname><given-names>C</given-names></name><name><surname>Huang</surname><given-names>X</given-names></name><name><surname>Latimer</surname><given-names>N</given-names></name></person-group>, <etal>et al</etal><article-title>Adjusting overall survival for treatment switches: commonly used methods and practical application.</article-title><source>Pharm Stat</source><year>2013</year>; 
<volume>12</volume>: <fpage>348</fpage>–<lpage>357</lpage>.<pub-id pub-id-type="pmid">24136868</pub-id></mixed-citation>
              </ref>
              <ref id="bibr5-0962280220912524">
                <label>5</label>
                <mixed-citation publication-type="other"><person-group person-group-type="author"><name><surname>Latimer</surname><given-names>NR.</given-names></name></person-group> Treatment switching in oncology trials and the acceptability of adjustment methods. <italic>Expert Rev Pharmacoecon Outcomes Res</italic>
<year>2015</year>; <bold>15</bold>: 561--564.</mixed-citation>
              </ref>
              <ref id="bibr6-0962280220912524">
                <label>6</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Latimer</surname><given-names>NR</given-names></name><name><surname>Henshall</surname><given-names>C</given-names></name><name><surname>Siebert</surname><given-names>U</given-names></name></person-group>, <etal>et al</etal><article-title>Treatment Switching: statistical and decision making challenges and approaches</article-title>. <source>Int J Technol Assess Health Care</source><year>2016</year>; 
<volume>32</volume>: <fpage>160</fpage>–<lpage>166</lpage>.<pub-id pub-id-type="pmid">27624982</pub-id></mixed-citation>
              </ref>
              <ref id="bibr7-0962280220912524">
                <label>7</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Henshall</surname><given-names>C</given-names></name><name><surname>Latimer</surname><given-names>NR</given-names></name><name><surname>Sansom</surname><given-names>L</given-names></name></person-group>, <etal>et al</etal><article-title>Treatment switching in cancer trials: issues and proposals.</article-title><source>Int J Technol Assess Health Care</source><year>2016</year>; 
<volume>32</volume>: <fpage>167</fpage>–<lpage>174</lpage>.<pub-id pub-id-type="pmid">27624983</pub-id></mixed-citation>
              </ref>
              <ref id="bibr8-0962280220912524">
                <label>8</label>
                <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Briggs</surname><given-names>A</given-names></name><name><surname>Claxton</surname><given-names>K</given-names></name><name><surname>Sculpher</surname><given-names>M.</given-names></name></person-group><source>Decision modelling for health economic evaluation</source>. 
<publisher-loc>New York, NY</publisher-loc>: 
<publisher-name>Oxford University Press Inc</publisher-name>, <year>2006</year>.</mixed-citation>
              </ref>
              <ref id="bibr9-0962280220912524">
                <label>9</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanders</surname><given-names>GD</given-names></name><name><surname>Neumann</surname><given-names>PJ</given-names></name><name><surname>Basu</surname><given-names>A</given-names></name></person-group>, <etal>et al</etal><article-title>Recommendations for conduct, methodological practices, and reporting of cost-effectiveness analyses: second panel on cost-effectiveness in health and medicine.</article-title><source>JAMA</source><year>2016</year>; 
<volume>316</volume>: <fpage>1093</fpage>–<lpage>1103</lpage>.<pub-id pub-id-type="pmid">27623463</pub-id></mixed-citation>
              </ref>
              <ref id="bibr10-0962280220912524">
                <label>10</label>
                <mixed-citation publication-type="book"><collab>National Institute for Health and Care Excellence</collab>. <source>Guide to the methods of technology appraisal</source>. 
<publisher-loc>London</publisher-loc>: 
<publisher-name>NICE</publisher-name>, <year>2013</year>, <ext-link ext-link-type="uri" xlink:href="http://nice.org.uk/process/pmg9">nice.org.uk/process/pmg9</ext-link> (accessed 2 June 2017).</mixed-citation>
              </ref>
              <ref id="bibr11-0962280220912524">
                <label>11</label>
                <mixed-citation publication-type="book"><collab>Canadian Agency for Drugs and Technologies in Health</collab>. <source>Guidelines for the economic evaluation of health technologies: Canada</source>. <edition>4th ed</edition><publisher-loc>Ottawa</publisher-loc>: 
<publisher-name>CADTH</publisher-name>, <year>2017</year>.</mixed-citation>
              </ref>
              <ref id="bibr12-0962280220912524">
                <label>12</label>
                <mixed-citation publication-type="other"><person-group person-group-type="author"><name><surname>Latimer</surname><given-names>NR</given-names></name><name><surname>Abrams</surname><given-names>KR</given-names></name><name><surname>Lambert</surname><given-names>PC</given-names></name></person-group>, <etal>et al</etal> Adjusting for treatment switching in randomised controlled trials – a simulation study and a simplified two-stage method. <italic>Stat Meth Med Res</italic> 2017; <bold>26</bold>: 724--751.</mixed-citation>
              </ref>
              <ref id="bibr13-0962280220912524">
                <label>13</label>
                <mixed-citation publication-type="other"><person-group person-group-type="author"><name><surname>Latimer</surname><given-names>NR</given-names></name><name><surname>Abrams</surname><given-names>KR</given-names></name><name><surname>Lambert</surname><given-names>PC</given-names></name></person-group>, <etal>et al</etal> Assessing methods for dealing with treatment switching in clinical trials: a follow-up simulation study. <italic>Stat Meth Med Res</italic> 2018; <bold>27</bold>: 765--784.</mixed-citation>
              </ref>
              <ref id="bibr14-0962280220912524">
                <label>14</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morden</surname><given-names>JP</given-names></name><name><surname>Lambert</surname><given-names>PC</given-names></name><name><surname>Latimer</surname><given-names>N</given-names></name></person-group>, <etal>et al</etal><article-title>Assessing statistical methods for dealing with treatment switching in randomised controlled trials: a simulation study</article-title>. <source>BMC Med Res Methodol</source><year>2011</year>; 
<volume>11</volume>: Article 4. </mixed-citation>
              </ref>
              <ref id="bibr15-0962280220912524">
                <label>15</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Walker</surname><given-names>AM.</given-names></name></person-group><article-title>Counfounding by indication</article-title>. <source>Epidemiology</source><year>1996</year>; 
<volume>7</volume>: <fpage>335</fpage>–<lpage>336</lpage>.<pub-id pub-id-type="pmid">8793355</pub-id></mixed-citation>
              </ref>
              <ref id="bibr16-0962280220912524">
                <label>16</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robins</surname><given-names>JM</given-names></name><name><surname>Tsiatis</surname><given-names>AA.</given-names></name></person-group><article-title>Correcting for noncompliance in randomized trials using rank preserving structural failure time models</article-title>. <source>Commun Stat Theory Meth</source><year>1991</year>; 
<volume>20</volume>: <fpage>2609</fpage>–<lpage>2631</lpage>.</mixed-citation>
              </ref>
              <ref id="bibr17-0962280220912524">
                <label>17</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robins</surname><given-names>JM</given-names></name><name><surname>Finkelstein</surname><given-names>DM.</given-names></name></person-group><article-title>Correcting for noncompliance and dependent censoring in an AIDS clinical trial with inverse probability of censoring weighted (IPCW) log-rank tests.</article-title><source>Biometrics</source><year>2000</year>; 
<volume>56</volume>: <fpage>779</fpage>–<lpage>788</lpage>.<pub-id pub-id-type="pmid">10985216</pub-id></mixed-citation>
              </ref>
              <ref id="bibr18-0962280220912524">
                <label>18</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hernan</surname><given-names>MA</given-names></name><name><surname>Brumback</surname><given-names>B</given-names></name><name><surname>Robins</surname><given-names>JM.</given-names></name></person-group><article-title>Marginal structural models to estimate the joint causal effect of nonrandomized treatments</article-title>. <source>J Am Statist Assoc</source><year>2001</year>; 
<volume>96</volume>: <fpage>440</fpage>–<lpage>448</lpage>.</mixed-citation>
              </ref>
              <ref id="bibr19-0962280220912524">
                <label>19</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robins</surname><given-names>JM.</given-names></name></person-group><article-title>A graphical approach to the identification and estimation of causal parameters in mortality studies with sustained exposure periods</article-title>. <source>J Chron Dis</source><year>1987</year>; 
<volume>40</volume>: <fpage>139S</fpage>–<lpage>161S</lpage>.<pub-id pub-id-type="pmid">3667861</pub-id></mixed-citation>
              </ref>
              <ref id="bibr20-0962280220912524">
                <label>20</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sterne</surname><given-names>JAC</given-names></name><name><surname>Tilling</surname><given-names>K.</given-names></name></person-group><article-title>G-estimation of causal effects, allowing for time-varying confounding</article-title>. <source>Stata J 2002;</source><volume>2</volume>: <page-range>164, 182</page-range>.</mixed-citation>
              </ref>
              <ref id="bibr21-0962280220912524">
                <label>21</label>
                <mixed-citation publication-type="other"><person-group person-group-type="author"><name><surname>Latimer</surname><given-names>N</given-names></name><name><surname>Abrams</surname><given-names>K.</given-names></name></person-group> NICE DSU Technical Support Document 16: adjusting survival time estimates in the presence of treatment switching, Report by the Decision Support Unit, July <year>2014</year>.</mixed-citation>
              </ref>
              <ref id="bibr22-0962280220912524">
                <label>22</label>
                <mixed-citation publication-type="other"><collab>Australian Government Department of Health</collab>, Guidelines for preparing a submission to the Pharmaceutical Benefits Advisory Committee Version 5.0, September <year>2016</year>, <ext-link ext-link-type="uri" xlink:href="https://pbac.pbs.gov.au/section-2/2-6-trial-results-additional-analyses.html">https://pbac.pbs.gov.au/section-2/2-6-trial-results-additional-analyses.html</ext-link> (accessed 11 April 2019).</mixed-citation>
              </ref>
              <ref id="bibr23-0962280220912524">
                <label>23</label>
                <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Robins</surname><given-names>JM.</given-names></name></person-group><chapter-title>The analysis of randomized and non-randomized AIDS treatment trials using a new approach to causal inference in longitudinal studies</chapter-title> In: <person-group person-group-type="editor"><name><surname>L</surname><given-names>Sechrest</given-names></name><name><surname>H</surname><given-names>Freeman</given-names></name><name><surname>A</surname><given-names>Mulley</given-names></name></person-group> (eds) <source>Health service research methodology: a focus on AIDS</source>. 
<publisher-loc>Washington, D.C</publisher-loc>: 
<publisher-name>U.S. Public Health Service, National Center for Health Services Research</publisher-name>, <year>1989</year>, pp.<fpage>113</fpage>–<lpage>159</lpage>.</mixed-citation>
              </ref>
              <ref id="bibr24-0962280220912524">
                <label>24</label>
                <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Robins</surname><given-names>JM.</given-names></name></person-group><chapter-title>Analytic methods for estimating HIV treatment and cofactor effects</chapter-title> In: <person-group person-group-type="editor"><name><surname>DG</surname><given-names>Ostrow</given-names></name><name><surname>R</surname><given-names>Kessler</given-names></name></person-group> (eds) <source>Methodological issues of AIDS mental health research</source>. 
<publisher-loc>New York, NY</publisher-loc>: 
<publisher-name>Plenum Publishing</publisher-name>, <year>1993</year>, pp.<fpage>213</fpage>–<lpage>290</lpage>.</mixed-citation>
              </ref>
              <ref id="bibr25-0962280220912524">
                <label>25</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>White</surname><given-names>IR</given-names></name><name><surname>Babiker</surname><given-names>AG</given-names></name><name><surname>Walker</surname><given-names>S</given-names></name></person-group>, <etal>et al</etal><article-title>Randomization-based methods for correcting for treatment changes: examples from the Concorde trial</article-title>. <source>Stat Med</source><year>1999</year>; 
<volume>18</volume>: <fpage>2617</fpage>–<lpage>2634</lpage>.<pub-id pub-id-type="pmid">10495460</pub-id></mixed-citation>
              </ref>
              <ref id="bibr26-0962280220912524">
                <label>26</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Latimer</surname><given-names>NR</given-names></name><name><surname>White</surname><given-names>IR</given-names></name><name><surname>Abrams</surname><given-names>KR</given-names></name></person-group>, <etal>et al</etal> Causal inference for long-term survival in randomised trials with treatment switching: Should re-censoring be applied when estimating counterfactual survival times? <italic>Stat Meth Med Res</italic>
<year>2018</year> (in press). DOI: 10.1177/0962
<volume>28</volume>0218780856.</mixed-citation>
              </ref>
              <ref id="bibr27-0962280220912524">
                <label>27</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Сox</surname><given-names>DR.</given-names></name></person-group><article-title>Regression models and life tables (with discussion)</article-title>. <source>J R Stat Soc Ser B</source><year>1972</year>; 
<volume>34</volume>: <fpage>187</fpage>–<lpage>220</lpage>.</mixed-citation>
              </ref>
              <ref id="bibr28-0962280220912524">
                <label>28</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robins</surname><given-names>JM</given-names></name><name><surname>Blevins</surname><given-names>D</given-names></name><name><surname>Ritter</surname><given-names>G</given-names></name></person-group>, <etal>et al</etal><article-title>G-estimation of the effect of prophylaxis therapy for Pneumocystisc ariniip neumonia on the survival of AIDS patients (erratum in Epidemiology 1993;3:189)</article-title>. <source>Epidemiology</source><year>1992</year>; 
<volume>3</volume>: <fpage>319</fpage>–<lpage>336</lpage>.<pub-id pub-id-type="pmid">1637895</pub-id></mixed-citation>
              </ref>
              <ref id="bibr29-0962280220912524">
                <label>29</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Naimi</surname><given-names>AI</given-names></name><name><surname>Cole</surname><given-names>SR</given-names></name><name><surname>Kennedy</surname><given-names>EH.</given-names></name></person-group><article-title>An introduction to g methods</article-title>. <source>Int J Epidemiol</source><year>2017</year>; 
<volume>46</volume>: <issue>2</issue>.</mixed-citation>
              </ref>
              <ref id="bibr30-0962280220912524">
                <label>30</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robins</surname><given-names>JM</given-names></name><name><surname>Greenland</surname><given-names>S.</given-names></name></person-group><article-title>Adjusting for differential rates of prophylaxis therapy for Pcp in high-dose versus low-dose Azt treatment arms in an aids randomized trial</article-title>. <source>J Am Stat Assoc</source><year>1994</year>; 
<volume>89</volume>: <fpage>737</fpage>–<lpage>749</lpage>.</mixed-citation>
              </ref>
              <ref id="bibr31-0962280220912524">
                <label>31</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yamaguchi</surname><given-names>T</given-names></name><name><surname>Ohashi</surname><given-names>Y.</given-names></name></person-group><article-title>Adjusting for differential proportions of second-line treatment in cancer clinical trials. Part I: structural nested models and marginal structural models to test and estimate treatment arm effects.</article-title><source>Stat Med</source><year>2004</year>; 
<volume>23</volume>: <fpage>1991</fpage>–<lpage>2003</lpage>.<pub-id pub-id-type="pmid">15211598</pub-id></mixed-citation>
              </ref>
              <ref id="bibr32-0962280220912524">
                <label>32</label>
                <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Robins</surname><given-names>JM.</given-names></name></person-group><chapter-title>Marginal structural models versus structural nested models as tools for causal inference</chapter-title> In: <person-group person-group-type="editor"><name><surname>Halloran</surname><given-names>ME</given-names></name><name><surname>Berry</surname><given-names>D</given-names></name></person-group> (eds) <source>Statistical models in epidemiology: the environment and clinical trials</source>. 
<publisher-loc>New York, NY</publisher-loc>: 
<publisher-name>Springer-Verlag</publisher-name>, <year>1999</year>, pp.<fpage>95</fpage>–<lpage>134</lpage>.</mixed-citation>
              </ref>
              <ref id="bibr33-0962280220912524">
                <label>33</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seaman</surname><given-names>SR</given-names></name><name><surname>White</surname><given-names>IR.</given-names></name></person-group><article-title>Review of inverse probability weighting for dealing with missing data.</article-title><source>Stat Meth Med Res</source><year>2013</year>; 
<volume>22</volume>: <fpage>278</fpage>–<lpage>295</lpage>.</mixed-citation>
              </ref>
              <ref id="bibr34-0962280220912524">
                <label>34</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cole</surname><given-names>SR</given-names></name><name><surname>Hernán</surname><given-names>MA.</given-names></name></person-group><article-title>Constructing inverse probability weights for marginal structural models.</article-title><source>Am J Epidemiol</source><year>2008</year>; 
<volume>168</volume>: <fpage>656</fpage>–<lpage>664</lpage>.<pub-id pub-id-type="pmid">18682488</pub-id></mixed-citation>
              </ref>
              <ref id="bibr35-0962280220912524">
                <label>35</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mark</surname><given-names>SD</given-names></name><name><surname>Robins</surname><given-names>JM.</given-names></name></person-group><article-title>A method for the analysis of randomized trials with compliance information – an application to the multiple risk factor intervention trial</article-title>. <source>Control Clin Trials</source><year>1993</year>; 
<volume>14</volume>: <fpage>79</fpage>–<lpage>97</lpage>.<pub-id pub-id-type="pmid">8500308</pub-id></mixed-citation>
              </ref>
              <ref id="bibr36-0962280220912524">
                <label>36</label>
                <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Robins</surname><given-names>JM.</given-names></name></person-group><chapter-title>Structural nested failure time models</chapter-title> In: <person-group person-group-type="editor"><name><surname>PK</surname><given-names>Andersen</given-names></name><name><surname>N</surname><given-names>Keiding</given-names></name></person-group> (eds) <source>Survival analysis</source>. 
<publisher-loc>Chichester, UK</publisher-loc>: 
<publisher-name>John Wiley and Sons</publisher-name>, <year>1998</year>, pp.<fpage>4372</fpage>–<lpage>4389</lpage>.</mixed-citation>
              </ref>
              <ref id="bibr37-0962280220912524">
                <label>37</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>White</surname><given-names>IR.</given-names></name></person-group><article-title>Uses and limitations of randomization-based efficacy estimators.</article-title><source>Stat Meth Med Res</source><year>2005</year>; 
<volume>14</volume>: <fpage>327</fpage>–<lpage>347</lpage>.</mixed-citation>
              </ref>
              <ref id="bibr38-0962280220912524">
                <label>38</label>
                <mixed-citation publication-type="book"><collab>StataCorp</collab>. <year>2015</year><source>Stata statistical software: Release 14</source>. 
<publisher-loc>College Station, TX</publisher-loc>: 
<publisher-name>StataCorp LP</publisher-name>.</mixed-citation>
              </ref>
              <ref id="bibr39-0962280220912524">
                <label>39</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lambert</surname><given-names>PC</given-names></name><name><surname>Royston</surname><given-names>P.</given-names></name></person-group><article-title>Further development of flexible parametric models for survival analysis</article-title>. <source>Stata J 2009;</source><volume>9</volume>: <fpage>265</fpage>–<lpage>290</lpage>.</mixed-citation>
              </ref>
              <ref id="bibr40-0962280220912524">
                <label>40</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Latimer</surname><given-names>NR.</given-names></name></person-group><article-title>Survival analysis for economic evaluations alongside clinical trials – extrapolation with patient-level data: inconsistencies, limitations, and a practical guide.</article-title><source>Medical Decision Making</source><year>2013</year>; 
<volume>33</volume>: <fpage>743</fpage>–<lpage>754</lpage>.<pub-id pub-id-type="pmid">23341049</pub-id></mixed-citation>
              </ref>
              <ref id="bibr41-0962280220912524">
                <label>41</label>
                <mixed-citation publication-type="other"><person-group person-group-type="author"><name><surname>Latimer</surname><given-names>N.</given-names></name></person-group> NICE DSU Technical Support Document 14: Survival analysis for economic evaluations alongside clinical trials – extrapolation with patient-level data, Report by the Decision Support Unit, June <year>2011</year>.</mixed-citation>
              </ref>
              <ref id="bibr42-0962280220912524">
                <label>42</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burton</surname><given-names>A</given-names></name><name><surname>Altman</surname><given-names>DG</given-names></name><name><surname>Royston</surname><given-names>P</given-names></name></person-group>, <etal>et al</etal><article-title>The design of simulation studies in medical statistics.</article-title><source>Stat Med</source><year>2006</year>; 
<volume>25</volume>: <fpage>4279</fpage>–<lpage>4292</lpage>.<pub-id pub-id-type="pmid">16947139</pub-id></mixed-citation>
              </ref>
              <ref id="bibr43-0962280220912524">
                <label>43</label>
                <mixed-citation publication-type="other"><person-group person-group-type="author"><name><surname>Morris</surname><given-names>TP</given-names></name><name><surname>White</surname><given-names>IR</given-names></name><name><surname>Crowther</surname><given-names>MJ.</given-names></name></person-group> Using simulation studies to evaluate statistical methods. Under review, <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1712.03198">https://arxiv.org/abs/1712.03198</ext-link> (accessed 18 October 2018).</mixed-citation>
              </ref>
              <ref id="bibr44-0962280220912524">
                <label>44</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rucker</surname><given-names>G</given-names></name><name><surname>Schwarzer</surname><given-names>G.</given-names></name></person-group><article-title>Presenting simulation results in a nested loop plot.</article-title><source>BMC Med Res Methodol</source><year>2014</year>; 
<volume>14</volume>: <fpage>129</fpage>.<pub-id pub-id-type="pmid">25495636</pub-id></mixed-citation>
              </ref>
              <ref id="bibr45-0962280220912524">
                <label>45</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Howe</surname><given-names>CJ</given-names></name><name><surname>Cole</surname><given-names>SR</given-names></name><name><surname>Chmiel</surname><given-names>JS</given-names></name></person-group>, <etal>et al</etal><article-title>Limitation of inverse probability-of-censoring weights in estimating survival in the presence of strong selection bias.</article-title><source>Am J Epidemiol</source><year>2011</year>; 
<volume>173</volume>: <fpage>569</fpage>–<lpage>577</lpage>.<pub-id pub-id-type="pmid">21289029</pub-id></mixed-citation>
              </ref>
              <ref id="bibr46-0962280220912524">
                <label>46</label>
                <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Latimer</surname><given-names>NR</given-names></name><name><surname>Abrams</surname><given-names>KR</given-names></name><name><surname>Siebert</surname><given-names>U.</given-names></name></person-group><article-title>Two-stage estimation to adjust for treatment switching in randomised trials: a simulation study investigating the use of inverse probability weighting instead of re-censoring.</article-title><source>BMC Med Res Methodol</source><year>2019</year>; 
<volume>19</volume>: <fpage>69</fpage>.<pub-id pub-id-type="pmid">30935369</pub-id></mixed-citation>
              </ref>
              <ref id="bibr47-0962280220912524">
                <label>47</label>
                <mixed-citation publication-type="other"><collab>National Institute for Health and Care Excellence</collab>, TA406: Crizotinib for untreated anaplastic lymphoma kinase-positive advanced non-small-cell lung cancer. Technology appraisal guidance, nice.org.uk/guidance/ta406 (<year>2016</year>).</mixed-citation>
              </ref>
              <ref id="bibr48-0962280220912524">
                <label>48</label>
                <mixed-citation publication-type="other"><collab>National Institute for Health and Care Excellence</collab>, TA357: Pembrolizumab for treating advanced melanoma after disease progression with ipilimumab. Technology appraisal guidance, nice.org.uk/guidance/ta357 (<year>2015</year>).</mixed-citation>
              </ref>
              <ref id="bibr49-0962280220912524">
                <label>49</label>
                <mixed-citation publication-type="other"><collab>National Institute for Health and Care Excellence</collab>, TA428: Pembrolizumab for treating PDL1-positive non-small-cell lung cancer after chemotherapy. Technology appraisal guidance, nice.org.uk/guidance/ta428 (<year>2017</year>).</mixed-citation>
              </ref>
            </ref-list>
          </back>
        </article>
      </metadata>
    </record>
  </GetRecord>
</OAI-PMH>
