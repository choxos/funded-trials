<?xml version="1.0" encoding="UTF-8"?>
<OAI-PMH xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.openarchives.org/OAI/2.0/ http://www.openarchives.org/OAI/2.0/OAI-PMH.xsd">
  <responseDate>2024-05-03T08:27:21Z</responseDate>
  <request verb="GetRecord" identifier="oai:pubmedcentral.nih.gov:9293235" metadataPrefix="pmc">https:/www.ncbi.nlm.nih.gov/pmc/oai/oai.cgi</request>
  <GetRecord>
    <record>
      <header>
        <identifier>oai:pubmedcentral.nih.gov:9293235</identifier>
        <datestamp>2022-07-20</datestamp>
        <setSpec>blackwellopen</setSpec>
        <setSpec>pmc-open</setSpec>
      </header>
      <metadata>
        <article xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" xsi:schemaLocation="https://jats.nlm.nih.gov/ns/archiving/1.3/ https://jats.nlm.nih.gov/archiving/1.3/xsd/JATS-archivearticle1-3.xsd" dtd-version="1.3" id="sim9176" xml:lang="en" article-type="research-article">
          <processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
            <restricted-by>pmc</restricted-by>
          </processing-meta>
          <front>
            <journal-meta>
              <journal-id journal-id-type="nlm-ta">Stat Med</journal-id>
              <journal-id journal-id-type="iso-abbrev">Stat Med</journal-id>
              <journal-id journal-id-type="doi">10.1002/(ISSN)1097-0258</journal-id>
              <journal-id journal-id-type="publisher-id">SIM</journal-id>
              <journal-title-group>
                <journal-title>Statistics in Medicine</journal-title>
              </journal-title-group>
              <issn pub-type="ppub">0277-6715</issn>
              <issn pub-type="epub">1097-0258</issn>
              <publisher>
                <publisher-name>John Wiley &amp; Sons, Inc.</publisher-name>
                <publisher-loc>Hoboken, USA</publisher-loc>
              </publisher>
            </journal-meta>
            <article-meta>
              <article-id pub-id-type="accession">PMC9293235</article-id>
              <article-id pub-id-type="pmcid">PMC9293235</article-id>
              <article-id pub-id-type="pmc-uid">9293235</article-id>
              <article-id pub-id-type="pmid">34510501</article-id>
              <article-id pub-id-type="pmid">34510501</article-id>
              <article-id pub-id-type="doi">10.1002/sim.9176</article-id>
              <article-id pub-id-type="publisher-id">SIM9176</article-id>
              <article-categories>
                <subj-group subj-group-type="overline">
                  <subject>Research Article</subject>
                </subj-group>
                <subj-group subj-group-type="heading">
                  <subject>Research Articles</subject>
                </subj-group>
              </article-categories>
              <title-group>
                <article-title>Informing power and sample size calculations when using inverse probability of treatment weighting using the propensity score</article-title>
                <alt-title alt-title-type="left-running-head">Austin</alt-title>
              </title-group>
              <contrib-group>
                <contrib id="sim9176-cr-0001" contrib-type="author" corresp="yes">
                  <name>
                    <surname>Austin</surname>
                    <given-names>Peter C.</given-names>
                  </name>
                  <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3337-233X</contrib-id>
                  <xref rid="sim9176-aff-0001" ref-type="aff">
                    <sup>1</sup>
                  </xref>
                  <xref rid="sim9176-aff-0002" ref-type="aff">
                    <sup>2</sup>
                  </xref>
                  <xref rid="sim9176-aff-0003" ref-type="aff">
                    <sup>3</sup>
                  </xref>
                  <address>
                    <email>peter.austin@ices.on.ca</email>
                  </address>
                </contrib>
              </contrib-group>
              <aff id="sim9176-aff-0001">
                <label>
                  <sup>1</sup>
                </label>
                <institution>ICES</institution>
                <city>Toronto</city>
                <named-content content-type="country-part">Ontario</named-content>
                <country country="CA">Canada</country>
              </aff>
              <aff id="sim9176-aff-0002">
                <label>
                  <sup>2</sup>
                </label>
                <named-content content-type="organisation-division">Institute of Health Management, Policy and Evaluation</named-content>
                <institution>University of Toronto</institution>
                <named-content content-type="country-part">Ontario</named-content>
                <country country="CA">Canada</country>
              </aff>
              <aff id="sim9176-aff-0003">
                <label>
                  <sup>3</sup>
                </label>
                <institution>Sunnybrook Research Institute</institution>
                <city>Toronto</city>
                <named-content content-type="country-part">Ontario</named-content>
                <country country="CA">Canada</country>
              </aff>
              <author-notes>
                <corresp id="correspondenceTo"><label>*</label><bold>Correspondence</bold><break/>
Peter C. Austin, ICES, G106, 2075 Bayview Avenue, Toronto, ON M4N 3M5, Canada.<break/>
Email: <email>peter.austin@ices.on.ca</email>
<break/>
</corresp>
              </author-notes>
              <pub-date pub-type="epub">
                <day>12</day>
                <month>9</month>
                <year>2021</year>
              </pub-date>
              <pub-date pub-type="ppub">
                <day>30</day>
                <month>11</month>
                <year>2021</year>
              </pub-date>
              <volume>40</volume>
              <issue seq="120">27</issue>
              <issue-id pub-id-type="doi">10.1002/sim.v40.27</issue-id>
              <fpage>6150</fpage>
              <lpage>6163</lpage>
              <history>
                <date date-type="rev-recd">
                  <day>18</day>
                  <month>5</month>
                  <year>2021</year>
                </date>
                <date date-type="received">
                  <day>03</day>
                  <month>2</month>
                  <year>2021</year>
                </date>
                <date date-type="accepted">
                  <day>09</day>
                  <month>8</month>
                  <year>2021</year>
                </date>
              </history>
              <permissions>
                <!--&#x000a9; 2021 John Wiley & Sons, Ltd.-->
                <copyright-statement content-type="article-copyright">© 2021 The Authors. <italic toggle="yes">Statistics in Medicine</italic> published by John Wiley &amp; Sons Ltd.</copyright-statement>
                <license>
                  <ali:license_ref specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
                  <license-p>This is an open access article under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link> License, which permits use, distribution and reproduction in any medium, provided the original work is properly cited and is not used for commercial purposes.</license-p>
                </license>
              </permissions>
              <self-uri content-type="pdf" xlink:href="file:SIM-40-6150.pdf"/>
              <abstract>
                <p>Propensity score weighting is increasingly being used in observational studies to estimate the effects of treatments. The use of such weights induces a within‐person homogeneity in outcomes that must be accounted for when estimating the variance of the estimated treatment effect. Knowledge of the variance inflation factor (VIF), which describes the extent to which the effective sample size has been reduced by weighting, allows for conducting sample size and power calculations for observational studies that use propensity score weighting. However, estimation of the VIF requires knowledge of the weights, which are only known once the study has been conducted. We describe methods to estimate the VIF based on two characteristics of the observational study: the anticipated prevalence of treatment and the anticipated c‐statistic of the propensity score model. We considered five different sets of weights: those for estimating the average treatment effect (ATE), the average treated effect in the treated (ATT), and three recently described sets of weights: overlap weights, matching weights, and entropy weights. The VIF was substantially smaller for the latter three sets of weights than for the first two sets of weights. Once the VIF has been estimated during the design phase of the study, sample size and power calculations can be done using calculations appropriate for a randomized controlled trial with similar prevalence of treatment and similar outcome variable, and then multiplying the requisite sample size by the estimated VIF. Implementation of these methods allows for improving the design and reporting of observational studies that use propensity score weighting.</p>
              </abstract>
              <kwd-group kwd-group-type="author-generated">
                <kwd id="sim9176-kwd-0001">inverse probability of treatment weighting</kwd>
                <kwd id="sim9176-kwd-0002">power</kwd>
                <kwd id="sim9176-kwd-0003">propensity score</kwd>
                <kwd id="sim9176-kwd-0004">sample size</kwd>
                <kwd id="sim9176-kwd-0005">study design</kwd>
              </kwd-group>
              <funding-group>
                <award-group id="funding-0001">
                  <funding-source>
                    <institution-wrap>
                      <institution>Canadian Institutes of Health Research
</institution>
                      <institution-id institution-id-type="doi">10.13039/501100000024</institution-id>
                    </institution-wrap>
                  </funding-source>
                  <award-id>PJT 166161</award-id>
                </award-group>
                <award-group id="funding-0002">
                  <funding-source>
                    <institution-wrap>
                      <institution>Heart and Stroke Foundation of Canada
</institution>
                      <institution-id institution-id-type="doi">10.13039/100004411</institution-id>
                    </institution-wrap>
                  </funding-source>
                </award-group>
                <award-group id="funding-0003">
                  <funding-source>
                    <institution-wrap>
                      <institution>Ontario Ministry of Health and Long‐Term Care
</institution>
                      <institution-id institution-id-type="doi">10.13039/501100000226</institution-id>
                    </institution-wrap>
                  </funding-source>
                </award-group>
              </funding-group>
              <counts>
                <fig-count count="6"/>
                <table-count count="1"/>
                <page-count count="14"/>
                <word-count count="5986"/>
              </counts>
              <custom-meta-group>
                <custom-meta>
                  <meta-name>source-schema-version-number</meta-name>
                  <meta-value>2.0</meta-value>
                </custom-meta>
                <custom-meta>
                  <meta-name>cover-date</meta-name>
                  <meta-value>30 November 2021</meta-value>
                </custom-meta>
                <custom-meta>
                  <meta-name>details-of-publishers-convertor</meta-name>
                  <meta-value>Converter:WILEY_ML3GV2_TO_JATSPMC version:6.1.7 mode:remove_FC converted:18.07.2022</meta-value>
                </custom-meta>
              </custom-meta-group>
            </article-meta>
            <notes>
              <p content-type="self-citation">
                <mixed-citation publication-type="journal" id="sim9176-cit-1001"><string-name><surname>Austin</surname><given-names>PC</given-names></string-name>. <article-title>Informing power and sample size calculations when using inverse probability of treatment weighting using the propensity score</article-title>. <source>Statistics in Medicine</source>. <year>2021</year>;<volume>40</volume>(<issue>27</issue>):<fpage>6150</fpage>–<lpage>6163</lpage>. <pub-id pub-id-type="doi">10.1002/sim.9176</pub-id>
<pub-id pub-id-type="pmid">34510501</pub-id></mixed-citation>
              </p>
              <fn-group>
                <fn id="sim9176-note-1002">
                  <p><bold>Funding information</bold> Canadian Institutes of Health Research, PJT 166161; Heart and Stroke Foundation of Canada, Ontario Ministry of Health and Long‐Term Care</p>
                </fn>
              </fn-group>
            </notes>
          </front>
          <body id="sim9176-body-0001">
            <sec id="sim9176-sec-0001">
              <label>1</label>
              <title>INTRODUCTION</title>
              <p>Dorn suggested that when conducting an observational study one ask “how would the study be conducted if it were possible to do it by controlled experimentation?<xref rid="sim9176-bib-0001" ref-type="bibr"><sup>1</sup></xref> Rubin suggests that this question defines the objective of an observational study<xref rid="sim9176-bib-0002" ref-type="bibr"><sup>2</sup></xref> (p. 16). Similarly, Hernan and Robins define the concept of the “target trial” as the randomized controlled experiment that one is trying to emulate using observational data.<xref rid="sim9176-bib-0003" ref-type="bibr"><sup>3</sup></xref> Sample size and power calculations are an integral component of the design of controlled experiments (eg, randomized controlled trials [RCTs]). In RCTs, sample size calculations are conducted during the design phase of the study, to ensure that the sample size provides adequate power to detect clinically meaningful effects. Similarly, power calculations serve an important role in observational studies, as they provide reassurance that the study sample is sufficiently large to provide adequate power to detect as statistically significant a clinically meaningful effect size. Researchers using observational data are often tempted to provide post‐hoc power calculations, despite this practice being criticized.<xref rid="sim9176-bib-0004" ref-type="bibr"><sup>4</sup></xref>
</p>
              <p>In observational studies, unlike in RCTs, treatment selection is frequently confounded with subject characteristics, so that treated subjects often differ systematically from control subjects. Consequently, statistical methods must be used to reduce the effects of confounding. A popular way to do this is using methods based on the propensity score. The propensity score is the probability of treatment selection conditional on the subject's measured baseline covariates.<xref rid="sim9176-bib-0005" ref-type="bibr"><sup>5</sup></xref>, <xref rid="sim9176-bib-0006" ref-type="bibr"><sup>6</sup></xref> Weighting using the propensity score is one way of using the propensity score to estimate the effects of treatment.<xref rid="sim9176-bib-0007" ref-type="bibr"><sup>7</sup></xref> Using propensity score‐based weights results in a weighted sample in which the distribution of measured baseline covariates is similar between treated and control subjects. The use of weighting‐based methods is becoming increasingly popular in the medical and epidemiological literature.</p>
              <p>When using propensity score‐based weighting, estimation of the point estimate of the treatment effect can mimic the analysis that would be done in an RCT with a similar outcome variable. However, estimation of the variance of the treatment effect must account for the within‐subject homogeneity in outcomes that is induced by weighting.<xref rid="sim9176-bib-0008" ref-type="bibr"><sup>8</sup></xref>, <xref rid="sim9176-bib-0009" ref-type="bibr"><sup>9</sup></xref> Zhou and colleagues described a variance inflation factor (VIF) that describes the inflation in the sample size that has occurred due to the incorporation of weights.<xref rid="sim9176-bib-0010" ref-type="bibr"><sup>10</sup></xref> The concept of the VIF, or equivalently the design effect (DE), arises from sample survey design and cluster randomized trials.<xref rid="sim9176-bib-0011" ref-type="bibr"><sup>11</sup></xref>, <xref rid="sim9176-bib-0012" ref-type="bibr"><sup>12</sup></xref>, <xref rid="sim9176-bib-0013" ref-type="bibr"><sup>13</sup></xref> It represents the increase in the variance of a test statistic due to using a sample other than a simple random sample. A drawback to using the VIF for the prospective planning of studies and for the prospective evaluation of statistical power is that calculation of the VIF requires knowledge of the subject‐specific weights, which are only known once the analyses have been conducted.</p>
              <p>The objective of the current study is to examine the relationship between study characteristics and the VIF (or DE). We examine the relationship between the c‐statistic (equivalent to the area under the receiver operating characteristic curve) of the propensity score model, prevalence of treatment and the VIF (or DE). This will allow study investigators to conduct power calculations before the weights have been estimated. The paper is structured as follows. In Section <xref rid="sim9176-sec-0002" ref-type="sec">2</xref>, we provide background on propensity score weighting and different sets of propensity score weights. In Section <xref rid="sim9176-sec-0003" ref-type="sec">3</xref>, we describe a set of Monte Carlo simulations to describe the relationship between the c‐statistic of the propensity score model, prevalence of treatment and the VIF (or DE). In Section <xref rid="sim9176-sec-0006" ref-type="sec">4</xref>, we report the results of these simulations. In Section <xref rid="sim9176-sec-0009" ref-type="sec">5</xref>, we provide a brief case study illustrating the application of these results. Finally, in Section <xref rid="sim9176-sec-0010" ref-type="sec">6</xref>, we summarize our findings and place them in the context of the existing literature.</p>
            </sec>
            <sec id="sim9176-sec-0002">
              <label>2</label>
              <title>PROPENSITY SCORE‐BASED WEIGHTS AND VIF<styled-content style="fixed-case" toggle="no">s</styled-content>
</title>
              <p>Let <mml:math id="jats-math-1" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow></mml:math> denote a vector of observed baseline covariates and let Z denote a binary treatment variable (Z = 0 for control vs Z = 1 for active treatment). The propensity score is defined as <mml:math id="jats-math-2" display="inline" overflow="scroll"><mml:mrow><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>Pr</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math>. In practice, the propensity score is often estimated using a logistic regression model in which treatment selection is regressed on measured baseline covariates.</p>
              <p>Rubin developed a framework for causal inference that is referred to as Rubin's Causal Model.<xref rid="sim9176-bib-0014" ref-type="bibr"><sup>14</sup></xref> Given an outcome Y, we define two potential outcomes: Y(0) and Y(1), which denote the outcomes under control and treatment, respectively, if the subject received either the control or treatment under identical circumstances. The effect of treatment is defined as Y(1) − Y(0). The average treatment effect (ATE) is defined as <mml:math id="jats-math-3" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="normal">ATE</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="normal">Y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math>, while the average treatment effect in the treated (ATT) is defined as <mml:math id="jats-math-4" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="normal">ATT</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="normal">Y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="normal">Z</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math>
<sub>.</sub>
<xref rid="sim9176-bib-0015" ref-type="bibr"><sup>15</sup></xref> The ATE is the average effect of treatment in the entire population, while the ATT is the average effect of treatment in those subjects in the population who were treated.</p>
              <p>In an RCT the population to which the estimated treatment effect pertains is defined by the study inclusion and exclusion criteria. Thus, in an RCT, the ATE is a well‐defined estimand because the overall population is well defined due to the use of inclusion and exclusion criteria. Similarly, a well‐designed observational study attempts to mimic the target trial, and, as such, will employ inclusion and exclusion criteria. Thus, in a well‐designed observational study, the target population for the ATE is also well‐defined. The target population of the ATT is defined as the subset of treated subjects in the ATE target population. While this population cannot be defined in terms of inclusion and exclusion criteria, it can be defined in terms of inclusion and exclusion criteria and receipt of treatment. However, the treated population may vary across jurisdictions, if there are regional characteristics (eg, insurance policy) that influence treatment assignment.</p>
              <p>Different propensity‐score based weights have been defined that allow one to balance measured baseline covariates between treated and control subjects. The original weights were defined as <mml:math id="jats-math-5" display="inline" overflow="scroll"><mml:mrow><mml:mi>w</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>Z</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math>
<sub>.</sub>
<xref rid="sim9176-bib-0007" ref-type="bibr"><sup>7</sup></xref> We refer to these weights as IPTW‐ATE weights (where IPTW stands for inverse probability of treatment weighting), as they permit estimation of the ATE. A second set of weights, <mml:math id="jats-math-6" display="inline" overflow="scroll"><mml:mrow><mml:mi>w</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>Z</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math>, permit estimation of the ATT.<xref rid="sim9176-bib-0015" ref-type="bibr"><sup>15</sup></xref> We refer to these weights as IPTW‐ATT weights. Use of IPTW‐ATE weights implies that the ATE is the target estimands, while use of IPTW‐ATT weights implies that the ATT is the target estimand.</p>
              <p>Recently, alternative sets of weights have been proposed. These include overlap weights (OW), matching weights (MW), and entropy weights (EW).<xref rid="sim9176-bib-0010" ref-type="bibr"><sup>10</sup></xref>, <xref rid="sim9176-bib-0016" ref-type="bibr"><sup>16</sup></xref> These are defined as: <mml:math id="jats-math-7" display="inline" overflow="scroll"><mml:mrow><mml:mtext>IPTW</mml:mtext><mml:mo>‐</mml:mo><mml:mi mathvariant="normal">OW</mml:mi><mml:mo>=</mml:mo><mml:mi>Z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>Z</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math>, <mml:math id="jats-math-8" display="inline" overflow="scroll"><mml:mrow><mml:mtext>IPTW</mml:mtext><mml:mo>‐</mml:mo><mml:mi mathvariant="normal">MW</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mi>min</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>Z</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>min</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math>, and <mml:math id="jats-math-9" display="inline" overflow="scroll"><mml:mrow><mml:mtext>IPTW</mml:mtext><mml:mi>‐</mml:mi><mml:mi mathvariant="normal">EW</mml:mi><mml:mo>=</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi>log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi>log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math> respectively. Use of these alternative weights targets inference at the subpopulation for whom there is the greatest clinical equipoise about treatment.<xref rid="sim9176-bib-0010" ref-type="bibr"><sup>10</sup></xref> These weights have been shown to have desirable statistical properties.<xref rid="sim9176-bib-0010" ref-type="bibr"><sup>10</sup></xref> However, it can be difficult to formally describe the population to whom the estimand applies, whereas this can easily be done for the ATE. While the target population for the ATE can be formally defined using the study inclusion and exclusion criteria, this cannot be done for the target population when using OWs, MWs, or EWs. While the target population cannot be formally defined, the characteristics of the target population can be described by reporting a table  in which the weighted means and prevalences of baseline variables are reported.<xref rid="sim9176-bib-0017" ref-type="bibr"><sup>17</sup></xref> In an RCT, an examination of such a table allows one to describe the study sample, but such a table does not allow one to define the population to which the estimated treatment effect pertains.</p>
              <p>The use of weighting induces a within‐subject correlation in outcomes as subjects can have weights that are unequal to one another.<xref rid="sim9176-bib-0008" ref-type="bibr"><sup>8</sup></xref>, <xref rid="sim9176-bib-0009" ref-type="bibr"><sup>9</sup></xref> This within‐subject homogeneity in outcomes must be accounted for when estimating the variance of the estimated treatment effect. Thus, while the statistical analyses conducted in the weighted sample can reflect those conducted in a sample that is free from selection‐bias (eg, data from an RCT), variance estimation must account for the within‐subject homogeneity in outcomes induced by weighting.</p>
              <p>Zhou et al describe a VIF quantifying the inflation in the sample size due to weighting: <mml:math id="jats-math-10" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="normal">VIF</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfenced open="[" close="]" separators=""><mml:mrow><mml:mfenced open="(" close=")" separators=""><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mspace width="0.2em"/><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>w</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>/</mml:mo><mml:msup><mml:mfenced open="(" close=")" separators=""><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mspace width="0.2em"/><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced open="(" close=")" separators=""><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mspace width="0.2em"/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>w</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>/</mml:mo><mml:msup><mml:mfenced open="(" close=")" separators=""><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mspace width="0.2em"/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>w</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:math>, where N denotes the sample size and <mml:math id="jats-math-11" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math> denotes the number of treated subjects.<xref rid="sim9176-bib-0010" ref-type="bibr"><sup>10</sup></xref> Computation of the VIF requires knowledge of the weights, which are only known after the analysis has been conducted, which complicates computations to determine statistical power or the necessary sample size prior to the sample being collected and the weights determined. The VIF (or DE) is related to the concept of the “effective sample” size discussed by Golinelli et al, which denotes the reduction in sample size due to the use of matching or the incorporation of weights.<xref rid="sim9176-bib-0018" ref-type="bibr"><sup>18</sup></xref>
</p>
            </sec>
            <sec id="sim9176-sec-0003">
              <label>3</label>
              <title>EFFECTS OF STUDY CHARACTERISTICS ON THE VIF: METHODS</title>
              <p>We conducted a set of Monte Carlo simulations to examine the effect of the proportion of subjects who were treated and the c‐statistic of the propensity score model on the VIF for a given set of weights. The c‐statistic is a measure of discrimination that assesses the ability of the estimated propensity score model to discriminate between treated and untreated subjects. It ranges from 0.5 to 1, which a value of 0.5 denoting discrimination no different than random choice, and 1 denoting perfect discrimination. The c‐statistic can be computed by considering all possible pairs consisting of treated and untreated subjects and determining the proportion of these pairs in which the treated subject had a higher propensity score than the untreated subject. Perfect discrimination would occur if all treated subjects had a higher propensity score than all untreated subjects.</p>
              <p>We conducted four sets of simulations to examine the effect of study characteristics on the VIF. In the primary set of simulations, we assumed that the single predictor variable was normally distributed. We then conducted three sets of simulations as sensitivity analyses in which the single predictor variable followed either a Beta distribution, a Chi‐squared distribution, or a log‐normal distribution.</p>
              <sec id="sim9176-sec-0004">
                <label>3.1</label>
                <title>Primary simulations: normally distribution predictor variable</title>
                <p>For a given prevalence of treatment and c‐statistic of the propensity score model, we simulated a continuous baseline covariate for each of 1 000 000 subjects: <mml:math id="jats-math-12" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math>. This covariate can be thought of as either a single covariate (eg, age) or as a linear predictor summarizing information on a set of covariates.</p>
                <p>We specified a logistic model for treatment status as <mml:math id="jats-math-13" display="inline" overflow="scroll"><mml:mrow><mml:mtext>logit</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>Pr</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>X</mml:mi></mml:mrow></mml:math>. Under the assumption that <mml:math id="jats-math-14" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="normal">var</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="normal">var</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math> the c‐statistic of the logistic model is equal to <mml:math id="jats-math-15" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi><mml:mi>α</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math>, where <mml:math id="jats-math-16" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi></mml:mrow></mml:math> denotes the normal cumulative distribution function.<xref rid="sim9176-bib-0019" ref-type="bibr"><sup>19</sup></xref> Thus, the c‐statistic of the propensity score model is entirely determined by the log‐odds ratio for the continuous variable and the variance of the continuous variable in the treated and control subjects (under the assumption that this variance is equal in treated and control subjects). Using the above relationship, we determined the value of α<sub>1</sub> that would result in a propensity score model with the desired c‐statistic. We then used a bisection approach to determine the value of α<sub>0</sub> that would result in the desired prevalence of treatment in the overall sample. Once the values of α<sub>0</sub> and α<sub>1</sub> had been determined, we generated a binary treatment status for each subject using a Bernoulli distribution with a subject‐specific probability determined from the propensity score model. This completed the construction of the simulated dataset of 1 000 000 subjects. The dataset consisted of two variables: the continuous predictor variable and the binary treatment status variable.</p>
                <p>Once the simulated dataset had been constructed, we regressed the binary treatment status variable on the continuous predictor using a logistic regression model. We then determined the empirical c‐statistic of the fitted propensity score model. This may differ slightly from the theoretical value because the assumption that <mml:math id="jats-math-17" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="normal">var</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="normal">var</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math> may be violated in the simulated sample. Using the estimated propensity score we computed the five different sets of weights described above (IPTW‐ATE, IPTW‐ATT, IPTW‐OW, IPTW‐MW, and IPTW‐EW) and the corresponding VIFs.</p>
                <p>We allowed two factors to vary in our simulations: the c‐statistic of the propensity score model and the prevalence of treatment. We allowed the former to vary from 0.55 to 0.95 in increments of 0.025, while the latter varied from 0.10 to 0.90 in increments of 0.10. We thus considered 153 different scenarios (17 c‐statistics × 9 prevalences of treatment).</p>
                <p>Figure <xref rid="sim9176-fig-0001" ref-type="fig">1</xref> reports the distribution of the propensity score separately in treated and control subjects when the target c‐statistic ranged from 0.55 to 0.90 in increments of 0.05 and the prevalence of treatment was 0.5. There is one panel for each of the eight empirical c‐statistics (as opposed to the target c‐statistic). The overlap in the propensity score distribution between the treated and control subjects decreased as the empirical c‐statistic increased. Thus, an increasing c‐statistic is indicative of increasing dissimilarities between treated and control subjects. Note that despite the covariate being normally distributed, the distribution of the propensity can be non‐normal in treated and control patients, particularly when the c‐statistic is moderate to high. There were scenarios with a high overlap in the distribution of the propensity score between treated and control subjects and scenarios with relatively little overlap.</p>
                <fig position="float" fig-type="FIGURE" id="sim9176-fig-0001">
                  <label>FIGURE 1</label>
                  <caption>
                    <p>Distribution of the propensity score in treated and control subjects (primary simulations)
[Colour figure can be viewed at <ext-link xlink:href="http://wileyonlinelibrary.com" ext-link-type="uri">wileyonlinelibrary.com</ext-link>]</p>
                  </caption>
                  <graphic xlink:href="SIM-40-6150-g006" position="anchor" id="jats-graphic-1">
                    <alt-text>SIM-9176-FIG-0001-c</alt-text>
                  </graphic>
                </fig>
                <p>An R function is provided in the Appendix <xref rid="sim9176-app-0001" ref-type="app">A</xref> that allows one to compute the VIF for each set of weights and for any value of the c‐statistic of the propensity score model and prevalence of treatment. The function has two input parameters: the prevalence of treatment and the target c‐statistic of the propensity score model. It assumes that the covariate follows a standard normal distribution and uses the methods described above to estimate the regression coefficients for the propensity score model. Along with outputting the VIFs for the different sets of weights, it also provides the empirical c‐statistic that was associated with the simulations.</p>
              </sec>
              <sec id="sim9176-sec-0005">
                <label>3.2</label>
                <title>Secondary simulations: non‐normally distribution predictor variable</title>
                <p>We repeated the above set of simulations, using three different distributions for the baseline covariate: a Beta distribution, a Chi‐squared distribution, and a log‐normal distribution. In the first set of secondary simulation, we simulated a continuous baseline covariate for each of 1 000 000 subjects: <mml:math id="jats-math-18" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>β</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math>. In the second set of secondary simulations, we assumed that the covariate followed Chi‐squared distribution with 3 degrees of freedom. In the third set of secondary simulations, we assumed that the covariate followed a standard log‐normal distribution (ie, the logarithm of the random variable had mean zero and variance one). In the latter two sets of simulations, once the baseline covariate was simulated, we standardized it to have mean zero and SD one.</p>
                <p>In all three secondary simulations we specified a logistic model for treatment status as <mml:math id="jats-math-19" display="inline" overflow="scroll"><mml:mrow><mml:mtext>logit</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>Pr</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>X</mml:mi></mml:mrow></mml:math> and used an iterative bisection approach to determine values of <mml:math id="jats-math-20" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math> and <mml:math id="jats-math-21" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math> to induce the desired prevalence of treatment and c‐statistic. Apart from these modifications, the simulations were conducted identically to those described above. Figures <xref rid="sim9176-supitem-0001" ref-type="supplementary-material">S1</xref>–S3 in the online supplemental material describe the distribution of the propensity score separately in treated and control subjects when the target c‐statistic ranged from 0.55 to 0.90 in increments of 0.05 and the prevalence of treatment was 0.5.</p>
              </sec>
            </sec>
            <sec id="sim9176-sec-0006">
              <label>4</label>
              <title>EFFECTS OF STUDY CHARACTERISTICS ON THE VIF: RESULTS</title>
              <sec id="sim9176-sec-0007">
                <label>4.1</label>
                <title>Primary set of simulations</title>
                <p>The relationship between the prevalence of treatment, the empirical c‐statistic of the propensity score model and the VIF is reported in Figure <xref rid="sim9176-fig-0002" ref-type="fig">2</xref> (there is one panel for each of the five sets of weights). We added a horizontal line denoting a VIF of 2 to two of the panels, indicating that the use of weights resulted in an effective sample size that was 50% smaller than the initial sample. Note that the scale of the vertical axis for the figures for the IPTW‐ATE and IPTW‐ATT weights is substantially different from that for the other three sets of weights.</p>
                <fig position="float" fig-type="FIGURE" id="sim9176-fig-0002">
                  <label>FIGURE 2</label>
                  <caption>
                    <p>Variance inflation factors/design effects for main simulations
[Colour figure can be viewed at <ext-link xlink:href="http://wileyonlinelibrary.com" ext-link-type="uri">wileyonlinelibrary.com</ext-link>]</p>
                  </caption>
                  <graphic xlink:href="SIM-40-6150-g005" position="anchor" id="jats-graphic-3">
                    <alt-text>SIM-9176-FIG-0002-c</alt-text>
                  </graphic>
                </fig>
                <p>Across all five sets of weights, the VIF increased as the empirical c‐statistic of the propensity score model increased. When using IPTW‐ATE weights, the VIF tended to be below 2 when the c‐statistic of the propensity score model was less than or equal to 0.75. The VIF was very large when the c‐statistic was very high and the prevalence of treatment was either very low or very high. Similar observations were made for the ITPW‐ATT weights. With IPTW‐OW, IPTW‐MW, and IPTW‐EW, the VIF was always less than 2, even when the c‐statistic of the propensity score model was very high and treatment prevalence was very low or very high. When the empirical c‐statistic of the propensity score model was modest (≤0.75), then the VIF was always lower than 1.3 for these three latter sets of weights.</p>
                <p>For each set of weights we used quantile regression to regress the logarithm of the VIF on the empirical c‐statistic of the propensity score, the square of the empirical c‐statistic of the propensity score, and the prevalence of treatment, with the latter being treated as a categorical variable with nine levels.<xref rid="sim9176-bib-0020" ref-type="bibr"><sup>20</sup></xref>, <xref rid="sim9176-bib-0021" ref-type="bibr"><sup>21</sup></xref> The estimated regression coefficients for each of the five models are reported in Table <xref rid="sim9176-tbl-0001" ref-type="table">1</xref>. For each of the 153 scenarios and each set of weights, we computed the absolute difference between the true VIF and the VIF estimated using the regression coefficients. The median absolute difference across the 153 scenarios was 0.12 (IPTW‐ATE), 0.17 (IPTW‐ATT), 0.01 (IPTW‐OW), 0.01 (IPTW‐MW), and 0.01 (IPTW‐EW) (Table <xref rid="sim9176-tbl-0001" ref-type="table">1</xref>). Modified Bland‐Altman plots comparing estimated vs true VIFs across the 153 scenarios are reported in Figure <xref rid="sim9176-fig-0003" ref-type="fig">3</xref>.<xref rid="sim9176-bib-0022" ref-type="bibr"><sup>22</sup></xref> The horizontal axis denotes the true VIF, while the vertical axis denotes the difference between true and estimated VIF. There is one panel for each set of weights. The points in each panel are color coded to indicate the empirical c‐statistic associated with that point. On each panel we have superimposed two horizontal lines denoting the 25th and 75th percentiles of the absolute difference between the true and estimated VIFs across the 153 scenarios. With the IPTW‐ATE and IPTW‐ATT weights, prediction error was highest when the c‐statistic was very high. In general, prediction was accurate when the c‐statistic of the propensity score model was not very high.</p>
                <table-wrap position="float" id="sim9176-tbl-0001" content-type="TABLE">
                  <label>TABLE 1</label>
                  <caption>
                    <p>Quantile regression results for VIF analysis, where the outcome is log(VIF)</p>
                  </caption>
                  <table frame="hsides" rules="groups">
                    <col align="left" span="1"/>
                    <col align="char" char="." span="1"/>
                    <col align="char" char="." span="1"/>
                    <col align="char" char="." span="1"/>
                    <col align="char" char="." span="1"/>
                    <col align="char" char="." span="1"/>
                    <thead valign="bottom">
                      <tr style="border-bottom:solid 1px #000000">
                        <th align="left" valign="bottom" rowspan="1" colspan="1">Parameter</th>
                        <th align="char" valign="bottom" rowspan="1" colspan="1">ATE</th>
                        <th align="char" valign="bottom" rowspan="1" colspan="1">ATT</th>
                        <th align="char" valign="bottom" rowspan="1" colspan="1">OW</th>
                        <th align="char" valign="bottom" rowspan="1" colspan="1">MW</th>
                        <th align="char" valign="bottom" rowspan="1" colspan="1">EW</th>
                      </tr>
                    </thead>
                    <tbody valign="top">
                      <tr>
                        <td align="left" valign="top" rowspan="1" colspan="1">Intercept</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">10.88</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">8.65</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">1.18</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">1</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">1.27</td>
                      </tr>
                      <tr>
                        <td align="left" valign="top" rowspan="1" colspan="1">c‐Statistic</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">−34.53</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">−29.9</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">−4.59</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">−4.11</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">−4.85</td>
                      </tr>
                      <tr>
                        <td align="left" valign="top" rowspan="1" colspan="1">c‐Statistic<sup>2</sup>
</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">28.03</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">24.84</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">4.21</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">3.94</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">4.44</td>
                      </tr>
                      <tr>
                        <td align="left" valign="top" rowspan="1" colspan="1">Prevalence of treatment = 0.2</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">−0.16</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.09</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.06</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.07</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.05</td>
                      </tr>
                      <tr>
                        <td align="left" valign="top" rowspan="1" colspan="1">Prevalence of treatment = 0.3</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">−0.25</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.24</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.09</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.09</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.07</td>
                      </tr>
                      <tr>
                        <td align="left" valign="top" rowspan="1" colspan="1">Prevalence of treatment = 0.4</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">−0.34</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.36</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.1</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.1</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.08</td>
                      </tr>
                      <tr>
                        <td align="left" valign="top" rowspan="1" colspan="1">Prevalence of treatment = 0.5</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">−0.36</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.39</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.1</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.1</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.09</td>
                      </tr>
                      <tr>
                        <td align="left" valign="top" rowspan="1" colspan="1">Prevalence of treatment = 0.6</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">−0.36</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.48</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.1</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.1</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.08</td>
                      </tr>
                      <tr>
                        <td align="left" valign="top" rowspan="1" colspan="1">Prevalence of treatment = 0.7</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">−0.21</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.55</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.09</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.09</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.07</td>
                      </tr>
                      <tr>
                        <td align="left" valign="top" rowspan="1" colspan="1">Prevalence of treatment = 0.8</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">−0.18</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.61</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.06</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.07</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.05</td>
                      </tr>
                      <tr>
                        <td align="left" valign="top" rowspan="1" colspan="1">Prevalence of treatment = 0.9</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.66</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0</td>
                      </tr>
                      <tr>
                        <td char="." align="char" colspan="6" valign="top" rowspan="1">
                          <italic toggle="yes">Median absolute prediction error</italic>
                        </td>
                      </tr>
                      <tr>
                        <td align="left" valign="top" rowspan="1" colspan="1">Main simulations</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.12</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.17</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.01</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.01</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.01</td>
                      </tr>
                      <tr>
                        <td align="left" valign="top" rowspan="1" colspan="1">Beta distribution</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.19</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.28</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.02</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.03</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.02</td>
                      </tr>
                      <tr>
                        <td align="left" valign="top" rowspan="1" colspan="1">Chi‐squared distribution</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.87</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">2.10</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.04</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.04</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.04</td>
                      </tr>
                      <tr>
                        <td align="left" valign="top" rowspan="1" colspan="1">Log‐normal distribution</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">2.81</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">18.72</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.07</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.06</td>
                        <td align="char" valign="top" rowspan="1" colspan="1">0.06</td>
                      </tr>
                    </tbody>
                  </table>
                  <table-wrap-foot id="sim9176-ntgp-0001">
                    <fn id="sim9176-note-0001">
                      <p><italic toggle="yes">Note</italic>: The quantile regression models are for log(VIF). The linear predictor must be exponentiated to obtain estimated VIF.</p>
                    </fn>
                  </table-wrap-foot>
                </table-wrap>
                <fig position="float" fig-type="FIGURE" id="sim9176-fig-0003">
                  <label>FIGURE 3</label>
                  <caption>
                    <p>Comparing estimated and true variance inflation factor/design effect: normal distribution
[Colour figure can be viewed at <ext-link xlink:href="http://wileyonlinelibrary.com" ext-link-type="uri">wileyonlinelibrary.com</ext-link>]</p>
                  </caption>
                  <graphic xlink:href="SIM-40-6150-g004" position="anchor" id="jats-graphic-5">
                    <alt-text>SIM-9176-FIG-0003-c</alt-text>
                  </graphic>
                </fig>
              </sec>
              <sec id="sim9176-sec-0008">
                <label>4.2</label>
                <title>Results of secondary simulations</title>
                <p>In each of the three sets of secondary simulations, the empirical prevalence of treatment was within 0.01 of the target prevalence of treatment across the 153 scenarios. Due to these minimal differences, we use the target prevalence of treatment in the following analyses. The relationship between the empirical c‐statistic of the propensity score model and the VIF across different prevalences of treatment is described in Figures <xref rid="sim9176-supitem-0001" ref-type="supplementary-material">S4–S6</xref> in the supplemental online material. In general, for a given prevalence of treatment, the VIF increased as the c‐statistic of the propensity score model increased. There were scenarios in which very large VIFs were observed for the IPTW‐ATE and IPTW‐ATT weights.</p>
                <p>For each set of secondary simulations, we applied the quantile regression model estimated in the previous section (whose coefficients are reported in Table <xref rid="sim9176-tbl-0001" ref-type="table">1</xref>) when the baseline covariate was normally distributed. The median absolute difference between estimated and true VIFs are reported in Table <xref rid="sim9176-tbl-0001" ref-type="table">1</xref>. Modified Bland‐Altman plots comparing estimated and true VIFs across the 153 scenarios for each of the three sets of secondary simulations are described in Figures <xref rid="sim9176-fig-0004" ref-type="fig">4</xref>, <xref rid="sim9176-fig-0005" ref-type="fig">5</xref>, <xref rid="sim9176-fig-0006" ref-type="fig">6</xref>. As in the main set of simulations, prediction error tended to be minimal except when the c‐statistic of the propensity score model was very high.</p>
                <fig position="float" fig-type="FIGURE" id="sim9176-fig-0004">
                  <label>FIGURE 4</label>
                  <caption>
                    <p>Comparing estimated and true VIF/DE: Beta distribution
[Colour figure can be viewed at <ext-link xlink:href="http://wileyonlinelibrary.com" ext-link-type="uri">wileyonlinelibrary.com</ext-link>]</p>
                  </caption>
                  <graphic xlink:href="SIM-40-6150-g002" position="anchor" id="jats-graphic-7">
                    <alt-text>SIM-9176-FIG-0004-c</alt-text>
                  </graphic>
                </fig>
                <fig position="float" fig-type="FIGURE" id="sim9176-fig-0005">
                  <label>FIGURE 5</label>
                  <caption>
                    <p>Comparing estimated and true VIF/DE: Chi‐squared distribution
[Colour figure can be viewed at <ext-link xlink:href="http://wileyonlinelibrary.com" ext-link-type="uri">wileyonlinelibrary.com</ext-link>]</p>
                  </caption>
                  <graphic xlink:href="SIM-40-6150-g003" position="anchor" id="jats-graphic-9">
                    <alt-text>SIM-9176-FIG-0005-c</alt-text>
                  </graphic>
                </fig>
                <fig position="float" fig-type="FIGURE" id="sim9176-fig-0006">
                  <label>FIGURE 6</label>
                  <caption>
                    <p>Comparing estimated and true VIF/DE: log‐normal distribution
[Colour figure can be viewed at <ext-link xlink:href="http://wileyonlinelibrary.com" ext-link-type="uri">wileyonlinelibrary.com</ext-link>]</p>
                  </caption>
                  <graphic xlink:href="SIM-40-6150-g001" position="anchor" id="jats-graphic-11">
                    <alt-text>SIM-9176-FIG-0006-c</alt-text>
                  </graphic>
                </fig>
              </sec>
            </sec>
            <sec id="sim9176-sec-0009">
              <label>5</label>
              <title>CASE STUDY</title>
              <p>Assume that an investigator wanted to design an observational study to compare the effectiveness of coronary artery bypass graft (CABG) surgery with that of percutaneous coronary interventions with drug eluting stents in patients with unprotected left main coronary artery disease. In a previous study on this topic, Zheng and colleagues reported a propensity score model with a c‐statistic of 0.831 and that, in their single‐center study, approximately two thirds of patients were treated with CABG surgery.<xref rid="sim9176-bib-0023" ref-type="bibr"><sup>23</sup></xref>
</p>
              <p>We assumed that the prevalence of CABG surgery in the setting in which the new study is being planned was 0.67 and that the c‐statistic of the propensity score model was 0.83 (ie, we assumed that both the prevalence of treatment and the c‐statistic in the new study would be the same as in the study of Zheng and colleagues). We estimated the VIF for the five different sets of weights using both the regression equations in Table <xref rid="sim9176-tbl-0001" ref-type="table">1</xref> and the R function provided in the Appendix <xref rid="sim9176-app-0001" ref-type="app">A</xref> (to do so, we rounded the prevalence of treatment to 0.70, as this factor is categorical in the regression model). When using the regression equations in Table <xref rid="sim9176-tbl-0001" ref-type="table">1</xref>, the estimated VIFs were 3.75 (IPTW‐ATE), 4.42 (IPTW‐ATT), 1.43 (IPTW‐OW), 1.47 (IPTW‐MW), and 1.45 (IPTW‐EW). When using the R function, the estimated VIFs were 1.71 (IPTW‐ATE), 2.41 (IPTW‐ATT), 1.35 (IPTW‐OW), 1.37 (IPTW‐MW), and 1.35 (IPTW‐EW). The function indicated that the empirical c‐statistic upon which this was based was 0.80. Using an input c‐statistic of 0.88 produced an empirical c‐statistic of 0.83. The VIFs associated with this value of the c‐statistic were 3.11 (IPTW‐ATE), 5.28 (IPTW‐ATT), 1.46 (IPTW‐OW), 1.52 (IPTW‐MW), and 1.42 (IPTW‐EW).</p>
              <p>In an RCT in which the probability of assignment to the experimental intervention was 0.67, we would require 865 subjects under the assumption that the event was observed for 25% of subjects (and the remaining 75% were censored) to have a power of 80% to detect a hazard ratio of at least 1.50 using a significance level of 0.05 (Source: PASS 2020, version 20.0.3, NCSS LLC, Kaysville, UT).</p>
              <p>Given the within‐subject homogeneity in outcomes induced by weighting, we would multiply the above sample size (865) by the estimated VIF. Using the VIFs obtained using the R function (with a c‐statistic of 0.88 producing an empirical c‐statistic of 0.83), we would need a sample size of 3244 (IPTW‐ATE), 3823 (IPTW‐ATT), 1237 (IPTW‐OW), 1272 (IPTW‐MW), or 1254 (IPTW‐EW). Thus, depending on the weights used, the observational study that we are designing would require between 1237 subjects and 3823 subjects. Note that the choice of which set of weights to use should not be decided primarily by which requires the lowest sample size or which results in the greatest statistical power. Instead, the decision should be informed, at least in part, by which target estimand is most appropriate for addressing the investigators' researcher question. The original study by Zheng and colleagues included 4046 subjects, and thus a study of that size would have been adequately powered, regardless of which set of weights the authors elected to use.</p>
            </sec>
            <sec id="sim9176-sec-0010">
              <label>6</label>
              <title>DISCUSSION</title>
              <p>Sample size and power calculations for studies using propensity score weighting require knowledge of the weights to allow the computation of the VIF. However, the weights are only known once the study sample has been assembled. The reporting of post‐hoc power calculations have been criticized by statistical authors.<xref rid="sim9176-bib-0004" ref-type="bibr"><sup>4</sup></xref> The results provided in the current study can facilitate sample size and power calculations before conducting weighted analyses. These results can facilitate good study design by allowing for sample size and power calculations to be conducted prior to the study analyses being conducted.</p>
              <p>Propensity‐score weighting accounts for confounding using weighting. In the weighted sample, the distribution of measured baseline covariates is similar in treated subjects as in control subjects.<xref rid="sim9176-bib-0006" ref-type="bibr"><sup>6</sup></xref> Consequently, the statistical analyses conducted in the weighted sample can reflect the analyses that would be conducted in an RCT with a similar outcome variable. Thus, for continuous outcomes, the mean outcome can be computed in each arm and the difference in means reported. For binary outcomes, the probability of success or failure can be reported in each arm and the difference and ratio of these probabilities can be reported as the absolute risk difference and the relative risk. For time‐to‐event outcomes, survival curves can be reported along with the absolute difference in survival at clinically relevant times. These can be complemented with the reporting of a hazard ratio from a univariate Cox regression model.<xref rid="sim9176-bib-0024" ref-type="bibr"><sup>24</sup></xref> While the estimation of the point estimate of the effect of treatment in a weighted analysis can reflect what would be done in an RCT, variance estimation must account for the within‐subject homogeneity in outcomes induced by weighting. Note that the validity of conclusions drawn from propensity score analyses rest on two assumptions: (i) the assumption of no unmeasured confounders; (ii) the positivity assumption.<xref rid="sim9176-bib-0005" ref-type="bibr"><sup>5</sup></xref> The latter assumption is that all subjects have a non‐zero probability of receiving either treatment.</p>
              <p>We suggest that investigators using weighting in observational studies proceed as follows: first, obtain estimates of the c‐statistic of the propensity score model and of the prevalence of treatment. These can be informed by previously published research, pilot studies, or by the investigators' clinical judgment. Granger and colleagues conducted a review of the use of propensity score diagnostics in papers published in the medical literature and noted which studies reported estimates of the c‐statistic of the propensity score model.<xref rid="sim9176-bib-0025" ref-type="bibr"><sup>25</sup></xref> Similarly, Sturmer and colleagues reviewed the use of propensity score methods in the medical literature.<xref rid="sim9176-bib-0026" ref-type="bibr"><sup>26</sup></xref> They note that the c‐statistic of the propensity score model was presented in 73 studies and provide a table containing the study‐specific c‐statistics. These reviews can serve as resources for obtaining plausible estimates of the c‐statistic across different areas of medical research and for different exposures. Alternatively, investigators can select a range of plausible values of the c‐statistic. Second, compute the VIF using either the regression results in Table <xref rid="sim9176-tbl-0001" ref-type="table">1</xref> or the R function provided in the Appendix <xref rid="sim9176-app-0001" ref-type="app">A</xref>. Third, determine the necessary sample size for a two‐armed RCT with the same prevalence of treatment and with the same type of outcome variable. Fourth, inflate the estimated sample size by the VIF obtained in the second step.</p>
              <p>We examined the VIF for five different sets of weights. The VIFs for the use of IPTW‐OW, IPTW‐MW, and IPTW‐EW tended to be much smaller than those for IPTW‐ATE and IPTW‐ATT. This finding complements those of Zhou and colleagues who found that the latter three sets of weights results in estimates that had lower standard errors and that displayed lower variability compared to estimates obtained using the first two sets of weights.<xref rid="sim9176-bib-0010" ref-type="bibr"><sup>10</sup></xref>
</p>
              <p>The choice of which set of weights to use should not be dictated solely by which induces the lowest VIF, and thus results in the highest statistical power (assuming a fixed sample size). Instead, the primary motivation should be which target estimands best addresses the investigators' research question. The differences between the VIFs for the first two sets of weights and the last three sets of weights were amplified as the c‐statistic increased. As the c‐statistic increased, differences in the distribution of the propensity score between treated and control subjects were amplified. This suggest that in settings with a high c‐statistic, there is likely a sub‐population of subjects who would most often receive the control exposure and a different sub‐population of subjects who would most often receive the active exposure. In these settings, the focus of interest may be on those subjects for whom there is clinical equipoise. Thus, in settings with a very high c‐statistic, the use of IPTW‐OW, IPTW‐MW, or IPTW‐EW may be preferable to the use of IPTW‐ATE or IPTW‐ATT weights. It is these settings that these three sets of weights offer a striking advantage, resulting in much smaller VIFs that the use of the other two sets of weights.</p>
              <p>There are certain limitations to the current study. First, there are other propensity score methods, such as matching on the propensity score. We have focused on methods to estimate sample size requirements and statistical power when using weighting‐based methods. Future research should focus on developing comparable methods for matching‐based methods. Second, there is another set of weights that we have not examined: stabilized weights, which are defined as <mml:math id="jats-math-22" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mtext>stab</mml:mtext></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>Pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>
<sub>.</sub>
<xref rid="sim9176-bib-0008" ref-type="bibr"><sup>8</sup></xref>, <xref rid="sim9176-bib-0027" ref-type="bibr"><sup>27</sup></xref> However, if one computes the VIF associated with the use of stabilized weights, it is equal to the VIF associated with the use of IPTW‐ATE weights. Thus, all our findings for IPTW‐ATE weights would apply to their stabilized counterpart. Third, our simulations were restricted to settings with a single covariate. However, our findings should be generalizable to more complex settings. If there were multiple covariates (either continuous, categorical, or a mixture of the two), we could consider the linear predictor that combined these covariates. As the number of covariates increased, the central limit theorem would suggest that, in many settings, the linear predictor would be approximately normally distributed. Finally, we have assumed a prospective sample size calculation and that the assembled cohort will reflect this calculation. However, the proposed method may adapted to work with dynamic sample size methods or the necessary sample size may be re‐estimated once interim data are available and accurate estimates of the c‐statistic and prevalence of treatment are available.</p>
              <p>In summary, knowledge of the VIF allows for conducting sample and power size calculations for observational studies that use propensity score weighting. We provide methods to estimate the VIF based on two characteristics of the observational study: the prevalence of treatment and the anticipated c‐statistic of the propensity score model. Implementation of these methods allows for improvements in the design and reporting of observational studies that use propensity score weighting.</p>
            </sec>
            <sec sec-type="supplementary-material">
              <title>Supporting information</title>
              <supplementary-material id="sim9176-supitem-0001" position="float" content-type="local-data">
                <caption>
                  <p><bold>Figure S1</bold> Distribution of the propensity score in treated and control subjects (secondary simulations: Beta distribution)</p>
                  <p><bold>Figure S2</bold>. Distribution of the propensity score in treated and control subjects (secondary simulations: Chi‐squared distribution)</p>
                  <p><bold>Figure S3</bold>. Distribution of the propensity score in treated and control subjects (secondary simulations: log‐normal distribution)</p>
                  <p><bold>Figure S4</bold>. Variance inflation factors/design effects (secondary simulations: Beta distribution)</p>
                  <p><bold>Figure S5</bold>. Variance inflation factors/design effects (secondary simulations: Chi‐squared distribution)</p>
                  <p><bold>Figure S6</bold>. Variance inflation factors/design effects (secondary simulations: log‐normal distribution)</p>
                </caption>
                <media xlink:href="SIM-40-6150-s001.pdf">
                  <caption>
                    <p>Click here for additional data file.</p>
                  </caption>
                </media>
              </supplementary-material>
            </sec>
          </body>
          <back>
            <ack id="sim9176-sec-0011">
              <title>ACKNOWLEDGEMENTS</title>
              <p>This study was supported by ICES, which is funded by an annual grant from the Ontario Ministry of Health and Long‐Term Care (MOHLTC). The opinions, results, and conclusions reported in this paper are those of the authors and are independent from the funding sources. No endorsement by ICES or the Ontario MOHLTC is intended or should be inferred. This research was supported by operating grant from the Canadian Institutes of Health Research (CIHR) (PJT 166161). Dr. Austin is supported in part by a Mid‐Career Investigator award from the Heart and Stroke Foundation of Ontario.</p>
            </ack>
            <sec sec-type="data-availability" id="sim9176-sec-0013">
              <title>DATA AVAILABILITY STATEMENT</title>
              <p>Data sharing not applicable to this article as no empirical datasets were analyzed during the current study.</p>
            </sec>
            <ref-list id="sim9176-bibl-0001" content-type="cited-references">
              <title>REFERENCES</title>
              <ref id="sim9176-bib-0001">
                <label>1</label>
                <mixed-citation publication-type="journal" id="sim9176-cit-0001"><string-name><surname>Dorn</surname><given-names>HF</given-names></string-name>. <article-title>Philosophy of inference from retrospective studies</article-title>. <source>Am J Public Health</source>. <year>1953</year>;<volume>43</volume>:<fpage>692</fpage>‐<lpage>699</lpage>.</mixed-citation>
              </ref>
              <ref id="sim9176-bib-0002">
                <label>2</label>
                <mixed-citation publication-type="book" id="sim9176-cit-0002"><string-name><surname>Rubin</surname><given-names>DB</given-names></string-name>. <source>Matched Sampling for Causal Effects</source>. 
<publisher-loc>New York, NY</publisher-loc>: 
<publisher-name>Cambridge University Press</publisher-name>; <year>2006</year>.</mixed-citation>
              </ref>
              <ref id="sim9176-bib-0003">
                <label>3</label>
                <mixed-citation publication-type="journal" id="sim9176-cit-0003"><string-name><surname>Hernan</surname><given-names>MA</given-names></string-name>, <string-name><surname>Robins</surname><given-names>JM</given-names></string-name>. <article-title>Using big data to emulate a target trial when a randomized trial is not available</article-title>. <source>Am J Epidemiol</source>. <year>2016</year>;<volume>183</volume>(<issue>8</issue>):<fpage>758</fpage>‐<lpage>764</lpage>.<pub-id pub-id-type="pmid">26994063</pub-id></mixed-citation>
              </ref>
              <ref id="sim9176-bib-0004">
                <label>4</label>
                <mixed-citation publication-type="journal" id="sim9176-cit-0004"><string-name><surname>Hoenig</surname><given-names>JM</given-names></string-name>, <string-name><surname>Heisey</surname><given-names>DM</given-names></string-name>. <article-title>The abuse of power: the pervasive fallacy of power calculations for data analysis</article-title>. <source>Am Stat</source>. <year>2001</year>;<volume>55</volume>(<issue>1</issue>):<fpage>19</fpage>‐<lpage>24</lpage>.</mixed-citation>
              </ref>
              <ref id="sim9176-bib-0005">
                <label>5</label>
                <mixed-citation publication-type="journal" id="sim9176-cit-0005"><string-name><surname>Rosenbaum</surname><given-names>PR</given-names></string-name>, <string-name><surname>Rubin</surname><given-names>DB</given-names></string-name>. <article-title>The central role of the propensity score in observational studies for causal effects</article-title>. <source>Biometrika</source>. <year>1983</year>;<volume>70</volume>:<fpage>41</fpage>‐<lpage>55</lpage>.</mixed-citation>
              </ref>
              <ref id="sim9176-bib-0006">
                <label>6</label>
                <mixed-citation publication-type="journal" id="sim9176-cit-0006"><string-name><surname>Austin</surname><given-names>PC</given-names></string-name>. <article-title>An introduction to propensity‐score methods for reducing the effects of confounding in observational studies</article-title>. <source>Multivar Behav Res</source>. <year>2011</year>;<volume>46</volume>:<fpage>399</fpage>‐<lpage>424</lpage>.</mixed-citation>
              </ref>
              <ref id="sim9176-bib-0007">
                <label>7</label>
                <mixed-citation publication-type="journal" id="sim9176-cit-0007"><string-name><surname>Rosenbaum</surname><given-names>PR</given-names></string-name>. <article-title>Model‐based direct adjustment</article-title>. <source>J Am Stat Assoc</source>. <year>1987</year>;<volume>82</volume>:<fpage>387</fpage>‐<lpage>394</lpage>.</mixed-citation>
              </ref>
              <ref id="sim9176-bib-0008">
                <label>8</label>
                <mixed-citation publication-type="journal" id="sim9176-cit-0008"><string-name><surname>Hernan</surname><given-names>MA</given-names></string-name>, <string-name><surname>Brumback</surname><given-names>B</given-names></string-name>, <string-name><surname>Robins</surname><given-names>JM</given-names></string-name>. <article-title>Marginal structural models to estimate the causal effect of zidovudine on the survival of HIV‐positive men</article-title>. <source>Epidemiology</source>. <year>2000</year>;<volume>11</volume>(<issue>5</issue>):<fpage>561</fpage>‐<lpage>570</lpage>.<pub-id pub-id-type="pmid">10955409</pub-id></mixed-citation>
              </ref>
              <ref id="sim9176-bib-0009">
                <label>9</label>
                <mixed-citation publication-type="journal" id="sim9176-cit-0009"><string-name><surname>van der Wal</surname><given-names>WM</given-names></string-name>, <string-name><surname>Geskus</surname><given-names>RB</given-names></string-name>. <article-title>Ipw: an R package for inverse probability weighting</article-title>. <source>J Stat Softw</source>. <year>2011</year>;<volume>43</volume>(<issue>13</issue>).</mixed-citation>
              </ref>
              <ref id="sim9176-bib-0010">
                <label>10</label>
                <mixed-citation publication-type="journal" id="sim9176-cit-0010"><string-name><surname>Zhou</surname><given-names>Y</given-names></string-name>, <string-name><surname>Matsouaka</surname><given-names>RA</given-names></string-name>, <string-name><surname>Thomas</surname><given-names>L</given-names></string-name>. <article-title>Propensity score weighting under limited overlap and model misspecification</article-title>. <source>Stat Methods Med Res</source>. <year>2020</year>;<volume>29</volume>(<issue>12</issue>):<fpage>3721</fpage>‐<lpage>3756</lpage>.<pub-id pub-id-type="pmid">32693715</pub-id></mixed-citation>
              </ref>
              <ref id="sim9176-bib-0011">
                <label>11</label>
                <mixed-citation publication-type="journal" id="sim9176-cit-0011"><string-name><surname>Hsieh</surname><given-names>FY</given-names></string-name>, <string-name><surname>Lavori</surname><given-names>PW</given-names></string-name>, <string-name><surname>Cohen</surname><given-names>HJ</given-names></string-name>, <string-name><surname>Feussner</surname><given-names>JR</given-names></string-name>. <article-title>An overview of variance inflation factors for sample‐size calculation</article-title>. <source>Eval Health Prof</source>. <year>2003</year>;<volume>26</volume>(<issue>3</issue>):<fpage>239</fpage>‐<lpage>257</lpage>.<pub-id pub-id-type="pmid">12971199</pub-id></mixed-citation>
              </ref>
              <ref id="sim9176-bib-0012">
                <label>12</label>
                <mixed-citation publication-type="book" id="sim9176-cit-0012"><string-name><surname>Donner</surname><given-names>A</given-names></string-name>, <string-name><surname>Klar</surname><given-names>N</given-names></string-name>. <source>Design and Analysis of Cluster Randomization Trials in Health Research</source>. 
<publisher-loc>London, UK</publisher-loc>: 
<publisher-name>Arnold</publisher-name>; <year>2000</year>.</mixed-citation>
              </ref>
              <ref id="sim9176-bib-0013">
                <label>13</label>
                <mixed-citation publication-type="book" id="sim9176-cit-0013"><string-name><surname>Lohr</surname><given-names>SL</given-names></string-name>. <source>Sampling: Design and Analysis</source>. Vol <volume>2</volume>. 
<publisher-loc>Brooks/Cole</publisher-loc>: 
<publisher-name>Boston, MA</publisher-name>; <year>2010</year>.</mixed-citation>
              </ref>
              <ref id="sim9176-bib-0014">
                <label>14</label>
                <mixed-citation publication-type="journal" id="sim9176-cit-0014"><string-name><surname>Rubin</surname><given-names>DB</given-names></string-name>. <article-title>Estimating causal effects of treatments in randomized and nonrandomized studies</article-title>. <source>J Educ Psychol</source>. <year>1974</year>;<volume>66</volume>:<fpage>688</fpage>‐<lpage>701</lpage>.</mixed-citation>
              </ref>
              <ref id="sim9176-bib-0015">
                <label>15</label>
                <mixed-citation publication-type="book" id="sim9176-cit-0015"><string-name><surname>Morgan</surname><given-names>SL</given-names></string-name>, <string-name><surname>Winship</surname><given-names>C</given-names></string-name>. <source>Counterfactuals and Causal Inference: Methods and Principles for Social Research</source>. 
<publisher-loc>New York, NY</publisher-loc>: 
<publisher-name>Cambridge University Press</publisher-name>; <year>2007</year>.</mixed-citation>
              </ref>
              <ref id="sim9176-bib-0016">
                <label>16</label>
                <mixed-citation publication-type="journal" id="sim9176-cit-0016"><string-name><surname>Li</surname><given-names>L</given-names></string-name>, <string-name><surname>Greene</surname><given-names>T</given-names></string-name>. <article-title>A weighting analogue to pair matching in propensity score analysis</article-title>. <source>Int J Biostat</source>. <year>2013</year>;<volume>9</volume>(<issue>2</issue>):<fpage>215</fpage>‐<lpage>234</lpage>.<pub-id pub-id-type="pmid">23902694</pub-id></mixed-citation>
              </ref>
              <ref id="sim9176-bib-0017">
                <label>17</label>
                <mixed-citation publication-type="journal" id="sim9176-cit-0017"><string-name><surname>Thomas</surname><given-names>LE</given-names></string-name>, <string-name><surname>Li</surname><given-names>F</given-names></string-name>, <string-name><surname>Pencina</surname><given-names>MJ</given-names></string-name>. <article-title>Overlap weighting: a propensity score method that mimics attributes of a randomized clinical trial</article-title>. <source>JAMA</source>. <year>2020</year>;<volume>323</volume>(<issue>23</issue>):<fpage>2417</fpage>‐<lpage>2418</lpage>.<pub-id pub-id-type="pmid">32369102</pub-id></mixed-citation>
              </ref>
              <ref id="sim9176-bib-0018">
                <label>18</label>
                <mixed-citation publication-type="journal" id="sim9176-cit-0018"><string-name><surname>Golinelli</surname><given-names>D</given-names></string-name>, <string-name><surname>Ridgeway</surname><given-names>G</given-names></string-name>, <string-name><surname>Rhoades</surname><given-names>H</given-names></string-name>, <string-name><surname>Tucker</surname><given-names>J</given-names></string-name>, <string-name><surname>Wenzel</surname><given-names>S</given-names></string-name>. <article-title>Bias and variance trade‐offs when combining propensity score weighting and regression: with an application to HIV status and homeless men</article-title>. <source>Health Serv Outcomes Res Methodol</source>. <year>2012</year>;<volume>12</volume>(<issue>2–3</issue>):<fpage>104</fpage>‐<lpage>118</lpage>.<pub-id pub-id-type="pmid">22956891</pub-id></mixed-citation>
              </ref>
              <ref id="sim9176-bib-0019">
                <label>19</label>
                <mixed-citation publication-type="journal" id="sim9176-cit-0019"><string-name><surname>Austin</surname><given-names>PC</given-names></string-name>, <string-name><surname>Steyerberg</surname><given-names>EW</given-names></string-name>. <article-title>Interpreting the concordance statistic of a logistic regression model: relation to the variance and odds ratio of a continuous explanatory variable</article-title>. <source>BMC Med Res Methodol</source>. <year>2012</year>;<volume>12</volume>:<fpage>82</fpage>.<pub-id pub-id-type="pmid">22716998</pub-id></mixed-citation>
              </ref>
              <ref id="sim9176-bib-0020">
                <label>20</label>
                <mixed-citation publication-type="journal" id="sim9176-cit-0020"><string-name><surname>Austin</surname><given-names>PC</given-names></string-name>, <string-name><surname>Schull</surname><given-names>MJ</given-names></string-name>. <article-title>Quantile regression: a statistical tool for out‐of‐hospital research</article-title>. <source>Acad Emerg Med</source>. <year>2003</year>;<volume>10</volume>(<issue>7</issue>):<fpage>789</fpage>‐<lpage>797</lpage>.<pub-id pub-id-type="pmid">12837655</pub-id></mixed-citation>
              </ref>
              <ref id="sim9176-bib-0021">
                <label>21</label>
                <mixed-citation publication-type="journal" id="sim9176-cit-0021"><string-name><surname>Austin</surname><given-names>PC</given-names></string-name>, <string-name><surname>Tu</surname><given-names>JV</given-names></string-name>, <string-name><surname>Daly</surname><given-names>PA</given-names></string-name>, <string-name><surname>Alter</surname><given-names>DA</given-names></string-name>. <article-title>The use of quantile regression in health care research: a case study examining gender differences in the timeliness of thrombolytic therapy</article-title>. <source>Stat Med</source>. <year>2005</year>;<volume>24</volume>(<issue>5</issue>):<fpage>791</fpage>‐<lpage>816</lpage>.<pub-id pub-id-type="pmid">15532082</pub-id></mixed-citation>
              </ref>
              <ref id="sim9176-bib-0022">
                <label>22</label>
                <mixed-citation publication-type="journal" id="sim9176-cit-0022"><string-name><surname>Krouwer</surname><given-names>JS</given-names></string-name>. <article-title>Why bland‐Altman plots should use X, not (Y+X)/2 when X is a reference method</article-title>. <source>Stat Med</source>. <year>2008</year>;<volume>27</volume>(<issue>5</issue>):<fpage>778</fpage>‐<lpage>780</lpage>.<pub-id pub-id-type="pmid">17907247</pub-id></mixed-citation>
              </ref>
              <ref id="sim9176-bib-0023">
                <label>23</label>
                <mixed-citation publication-type="journal" id="sim9176-cit-0023"><string-name><surname>Zheng</surname><given-names>Z</given-names></string-name>, <string-name><surname>Xu</surname><given-names>B</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>H</given-names></string-name>, et al. <article-title>Coronary artery bypass graft surgery and percutaneous coronary interventions in patients with unprotected left Main coronary artery disease</article-title>. <source>JACC Cardiovasc Interv</source>. <year>2016</year>;<volume>9</volume>(<issue>11</issue>):<fpage>1102</fpage>‐<lpage>1111</lpage>.<pub-id pub-id-type="pmid">27282597</pub-id></mixed-citation>
              </ref>
              <ref id="sim9176-bib-0024">
                <label>24</label>
                <mixed-citation publication-type="journal" id="sim9176-cit-0024"><string-name><surname>Austin</surname><given-names>PC</given-names></string-name>, <string-name><surname>Laupacis</surname><given-names>A</given-names></string-name>. <article-title>A tutorial on methods to estimating clinically and policy‐meaningful measures of treatment effects in prospective observational studies: a review</article-title>. <source>Int J Biostat</source>. <year>2011</year>;<volume>7</volume>(<issue>1</issue>):<elocation-id>6</elocation-id>.<pub-id pub-id-type="pmid">22848188</pub-id></mixed-citation>
              </ref>
              <ref id="sim9176-bib-0025">
                <label>25</label>
                <mixed-citation publication-type="journal" id="sim9176-cit-0025"><string-name><surname>Granger</surname><given-names>E</given-names></string-name>, <string-name><surname>Watkins</surname><given-names>T</given-names></string-name>, <string-name><surname>Sergeant</surname><given-names>JC</given-names></string-name>, <string-name><surname>Lunt</surname><given-names>M</given-names></string-name>. <article-title>A review of the use of propensity score diagnostics in papers published in high‐ranking medical journals</article-title>. <source>BMC Med Res Methodol</source>. <year>2020</year>;<volume>20</volume>(<issue>1</issue>):<fpage>132</fpage>.<pub-id pub-id-type="pmid">32460872</pub-id></mixed-citation>
              </ref>
              <ref id="sim9176-bib-0026">
                <label>26</label>
                <mixed-citation publication-type="journal" id="sim9176-cit-0026"><string-name><surname>Sturmer</surname><given-names>T</given-names></string-name>, <string-name><surname>Joshi</surname><given-names>M</given-names></string-name>, <string-name><surname>Glynn</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Avorn</surname><given-names>J</given-names></string-name>, <string-name><surname>Rothman</surname><given-names>KJ</given-names></string-name>, <string-name><surname>Schneeweiss</surname><given-names>S</given-names></string-name>. <article-title>A review of the application of propensity score methods yielded increasing use, advantages in specific settings, but not substantially different estimates compared with conventional multivariable methods</article-title>. <source>J Clin Epidemiol</source>. <year>2006</year>;<volume>59</volume>(<issue>5</issue>):<fpage>437</fpage>‐<lpage>447</lpage>.<pub-id pub-id-type="pmid">16632131</pub-id></mixed-citation>
              </ref>
              <ref id="sim9176-bib-0027">
                <label>27</label>
                <mixed-citation publication-type="journal" id="sim9176-cit-0027"><string-name><surname>Cole</surname><given-names>SR</given-names></string-name>, <string-name><surname>Hernan</surname><given-names>MA</given-names></string-name>. <article-title>Adjusted survival curves with inverse probability weights</article-title>. <source>Comput Methods Programs Biomed</source>. <year>2004</year>;<volume>75</volume>:<fpage>45</fpage>‐<lpage>49</lpage>.<pub-id pub-id-type="pmid">15158046</pub-id></mixed-citation>
              </ref>
            </ref-list>
            <app-group>
              <app id="sim9176-app-0001" content-type="APPENDIX">
                <label>APPENDIX A</label>
                <sec id="sim9176-sec-0015">
                  <title>R code for computing VIF</title>
                  <p># Function for estimating VIF as a function of c‐statistic and</p>
                  <p># prevalnce of treatment.</p>
                  <p># THIS SOFTWARE IS PROVIDED FOR ILLUSTRATIVE PURPOSES AND COMES WITH ABSOLUTELY</p>
                  <p># NO WARRANTY.</p>
                  <p>library(rms)</p>
                  <p>vif &lt;‐ function(auc,prev.treat){</p>
                  <p># auc: c‐statistic of PS model.</p>
                  <p># prev.treat: Prevalance of treatment.</p>
                  <p>set.seed(1)</p>
                  <p>N &lt;‐ 1000000</p>
                  <p># Population size.</p>
                  <p>################################################################################</p>
                  <p># Generate covariate.</p>
                  <p>################################################################################</p>
                  <p>x &lt;‐ rnorm(N)</p>
                  <p># Assume standardized so that it is standard normal.</p>
                  <p>################################################################################</p>
                  <p># Generate beta for PS model.</p>
                  <p>################################################################################</p>
                  <p># auc = phi(sigma*beta/sqrt(2))</p>
                  <p>beta.ps &lt;‐ sqrt(2) * qnorm(auc)</p>
                  <p>################################################################################</p>
                  <p># Determine intercept for PS model for desired prevalance of treatment.</p>
                  <p>################################################################################</p>
                  <p>bias &lt;‐ 1</p>
                  <p>lower.int &lt;‐ ‐20</p>
                  <p>upper.int &lt;‐ 20</p>
                  <p>while (bias &gt; 0.001){</p>
                  <p> beta0.treat &lt;‐ (lower.int + upper.int)/2</p>
                  <p> # Generate treatment status for each subject.</p>
                  <p> logit.treat &lt;‐ beta0.treat + beta.ps*x</p>
                  <p> p.treat &lt;‐ exp(logit.treat)/(1 + exp(logit.treat))</p>
                  <p> treat &lt;‐ rbinom(N,1,p.treat)</p>
                  <p> emp.prev.treat &lt;‐ mean(treat)</p>
                  <p> bias &lt;‐ abs(prev.treat ‐ emp.prev.treat)</p>
                  <p> if (emp.prev.treat &gt; prev.treat) {</p>
                  <p>  upper.int &lt;‐ beta0.treat</p>
                  <p> } else {</p>
                  <p>  lower.int &lt;‐ beta0.treat</p>
                  <p> }</p>
                  <p> remove(logit.treat,p.treat,emp.prev.treat)</p>
                  <p>}</p>
                  <p>remove(bias,lower.int,upper.int)</p>
                  <p>################################################################################</p>
                  <p># Compute weights</p>
                  <p>################################################################################</p>
                  <p>psm &lt;‐ lrm(treat ∼ x)</p>
                  <p>auc.emp &lt;‐ psm$stats[“C”]</p>
                  <p>ps &lt;‐ exp(psm$linear.predictor)/(1 + exp(psm$linear.predictor))</p>
                  <p>iptw &lt;‐ (treat/ps) + (1‐treat)/(1‐ps)</p>
                  <p>att &lt;‐ treat + (1‐treat)*(ps/(1‐ps))</p>
                  <p>ow &lt;‐ treat*(1‐ps) + (1‐treat)*ps</p>
                  <p>mw &lt;‐ treat*pmin(ps,1‐ps)/ps + (1‐treat)*pmin(ps,1‐ps)/(1‐ps)</p>
                  <p>entropy &lt;‐ treat*(‐ps*log(ps) ‐ (1‐ps)*log(1‐ps))/ps +</p>
                  <p> (1‐treat)*(‐ps*log(ps) ‐ (1‐ps)*log(1‐ps))/(1‐ps)</p>
                  <p>remove(x,beta.ps,psm,ps)</p>
                  <p>################################################################################</p>
                  <p># Compute VIFs</p>
                  <p>################################################################################</p>
                  <p>N1 &lt;‐ sum(treat)</p>
                  <p>N0 &lt;‐ N ‐ N1</p>
                  <p>VIF.iptw &lt;‐ (N1*N0/N) * (sum(treat*iptw*iptw)/((sum(treat*iptw))<sup>∧</sup>2) +</p>
                  <p> sum((1‐treat)*iptw*iptw)/((sum((1‐treat)*iptw))<sup>∧</sup>2) )</p>
                  <p>VIF.att &lt;‐ (N1*N0/N) * (sum(treat*att*att)/((sum(treat*att))<sup>∧</sup>2) +</p>
                  <p> sum((1‐treat)*att*att)/((sum((1‐treat)*att))<sup>∧</sup>2) )</p>
                  <p>VIF.ow &lt;‐ (N1*N0/N) * (sum(treat*ow*ow)/((sum(treat*ow))<sup>∧</sup>2) +</p>
                  <p> sum((1‐treat)*ow*ow)/((sum((1‐treat)*ow))<sup>∧</sup>2) )</p>
                  <p>VIF.mw &lt;‐ (N1*N0/N) * (sum(treat*mw*mw)/((sum(treat*mw))<sup>∧</sup>2) +</p>
                  <p> sum((1‐treat)*ow*ow)/((sum((1‐treat)*ow))<sup>∧</sup>2) )</p>
                  <p>VIF.entropy &lt;‐ (N1*N0/N) * (sum(treat*entropy*entropy)/((sum(treat*entropy))<sup>∧</sup>2) +</p>
                  <p> sum((1‐treat)*ow*ow)/((sum((1‐treat)*ow))<sup>∧</sup>2) )</p>
                  <p>remove(N1,N0,iptw,att,ow,mw,entropy)</p>
                  <p>return(c(auc,auc.emp,prev.treat,VIF.iptw,VIF.att,VIF.ow,VIF.mw,VIF.entropy))</p>
                  <p>}</p>
                </sec>
              </app>
            </app-group>
          </back>
        </article>
      </metadata>
    </record>
  </GetRecord>
</OAI-PMH>
